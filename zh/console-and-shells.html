
<!DOCTYPE html>



<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="Console and Shells" lang="zh_CN" name="title" />
<meta content="shell scripts,system shell,application classes,background tasks,line script,cron job,request response,system path,acl,new projects,shells,specifics,parameters,i18n,cakephp,directory,maintenance,ideal,applications,mvc" lang="zh_CN" name="keywords" />

    <title>命令行与Shells &mdash; CakePHP Cookbook 2.x 文档</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.x',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <script type="text/javascript" src="_static/app.js"></script>
    <script type="text/javascript" src="_static/modernizr.foundation.js"></script>
    <script type="text/javascript" src="_static/foundation.js"></script>
    <link rel="top" title="CakePHP Cookbook 2.x 文档" href="index.html" />
    <link rel="next" title="定期运行Shells" href="console-and-shells/cron-jobs.html" />
    <link rel="prev" title="How To Create Plugins" href="plugins/how-to-create-plugins.html" />
<link href="_static/favicon.ico" type="image/x-icon" rel="icon" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<link rel="alternate" hreflang="en" href="../en/console-and-shells.html" /><link rel="alternate" hreflang="pt" href="../pt/console-and-shells.html" /><link rel="alternate" hreflang="es" href="../es/console-and-shells.html" /><link rel="alternate" hreflang="ja" href="../ja/console-and-shells.html" /><link rel="alternate" hreflang="fr" href="../fr/console-and-shells.html" />

<link rel="search" type="application/opensearchdescription+xml" title="CakePHP Book 2.x Search" href="_static/opensearchdescription-book-2-x.xml">
<script type="text/javascript">
window.lang = "zh_CN";
</script>

  </head>
  <body>

<div id="container">

<div id="cakephp-global-navigation">
	<ul>
		<li class="main"><a href="http://cakephp.org">CakePHP</a></li>
		<li class="primary"><a href="#" class="empty">Downloads</a>
			<ul class="second-level">
				<li><a href="https://github.com/cakephp/cakephp/tags">Releases</a></li>
				<li><a href="http://pear.cakephp.org">Pear channel</a></li>
			</ul>
		</li>
		<li class="primary"><a href="#" class="empty">Documentation</a>
			<ul class="second-level">
				<li><a href="http://api.cakephp.org">API</a></li>
				<li><a href="http://book.cakephp.org">Book</a></li>
			</ul>
		</li>
		<li class="primary"><a href="http://community.cakephp.org">Community</a>
			<ul class="second-level">
				<li><a href="http://webchat.freenode.net/?channels=cakephp&uio=MT1mYWxzZSY5PXRydWUmMTE9MjQ2b8">Help &amp; Support</a></li>
				<li><a href="https://github.com/cakephp/cakephp/issues">Issues</a></li>
				<li><a href="http://bakery.cakephp.org">The Bakery</a></li>
				<li><a href="http://stackoverflow.com/tags/cakephp">Stack Overflow</a></li>
				<li><a href="http://www.facebook.com/groups/cake.community">Facebook Group</a></li>
				<li><a href="http://goo.gl/mSC0s">Google+ Community</a></li>
				<li><a href="http://www.youtube.com/user/CakePHP">YouTube Channel</a></li>
				<li><a href="http://podcast.cakephp.org">CakePHP Podcast</a></li>
				<li><a href="http://twitter.com/CakePHP">Follow us on Twitter</a></li>
				<li><a href="http://groups.google.com/group/cake-php">Google Group</a></li>
				<li><a href="http://github.com/cakephp/cakephp/contributors">Contributors</a></li>
				<li><a href="http://plugins.cakephp.org">Plugins &amp; Packages</a></li>
				<li><a href="http://community.cakephp.org/get-involved">Get Involved</a></li>
				<li><a href="http://community.cakephp.org/guidelines">Guidelines</a></li>
				<li><a href="http://cakefest.org">CakeFest</a></li>
				<li><a href="http://cakephp.org/logos">Logo</a></li>
			</ul>
		</li>
		<li class="primary"><a href="http://cakephp.org/services">Services</a>
			<ul class="second-level">
				<li><a href="http://cakephp.org/services/certification">Certification</a></li>
				<li><a href="http://cakephp.org/services/consultation">Consultation</a></li>
				<li><a href="http://cakephp.org/services/support">Support</a></li>
				<li><a href="http://training.cakephp.org">Training</a></li>
			</ul>
		</li>
	</ul>
</div>

<div class="masthead">
	<div class="header-backing"></div>
	<div class="searchbar row">
		<div class="columns three phone-one">
			<a class="logo" href="contents.html">
			<img src="_static/cake-logo.png" alt="CakePHP" width="70" />
			</a>
		</div>
		
<div id="searchbox" class="columns nine phone-three">

	<form id="searchform" class="search" action="search.html" method="get">
		<input class="search-input" autocomplete="off" type="search" name="q" size="18" />
		<input class="search-submit search-big button red" type="submit" value="搜索" />
		<input type="hidden" name="check_keywords" value="yes" />
		<input type="hidden" name="area" value="default" />

		<a href="#" id="tablet-nav" class="show-on-phones pale button small">Nav</a>
	</form>

</div>
	</div>
</div>
<div class="breadcrumb-header">
	<div class="related row">
		<div class="columns three root-link">
			<a href="contents.html">Cookbook 2.x</a>
		</div>
		<div class="columns nine">
			<ul class="inline breadcrumb">
			</ul>
			<div class="versions dropdown">
				<a href="#">2.x Book</a>
				<ul>
					<li><a href="http://book.cakephp.org/3.0/en">3.0 Book</a></li>
					<li><a href="http://book.cakephp.org/1.3/zh_CN/">1.3 Book</a></li>
					<li><a href="http://book.cakephp.org/1.2/zh_CN/">1.2 Book</a></li>
					<li><a href="http://book.cakephp.org/1.1/en">1.1 Book</a></li>
				</ul>
			</div>

			<div class="languages dropdown">
				<a href="#">zh_CN</a>

				<ul>
				
					<li><a href="../en/console-and-shells.html">en</a></li>
				
					<li><a href="../pt/console-and-shells.html">pt</a></li>
				
					<li><a href="../es/console-and-shells.html">es</a></li>
				
					<li><a href="../ja/console-and-shells.html">ja</a></li>
				
					<li><a href="../fr/console-and-shells.html">fr</a></li>
				
					<li></li>
				
				</ul>
			</div>
		</div>
	</div>
</div>

<div class="content row">
	<div class="document columns nine push-three">
		<div class="body"><a class="button pale improve" href="https://github.com/cakephp/docs/edit/master/zh/console-and-shells.rst" target="_blank">Improve this Doc</a>
  <div class="section" id="shells">
<h1>命令行与Shells<a class="headerlink" href="#shells" title="永久链接至标题">¶</a></h1>
<p>CakePHP不单单是个Web框架,而且是一个通过控制台创建应用程序的框架。
控制台应用程序非常适合处理各种后台任务，如维护等务,并完成请求-响应周期以外的工作。
CakePHP控制台应用程序允许您从命令行重用应用程序的类。</p>
<p>CakePHP features not only a web framework but also a console framework
for creating console applications.  Console applications are ideal for handling
a variety of background tasks such as maintenance, and completing work outside
of the request-response cycle.  CakePHP console applications allow you
to reuse your application classes from the command line.</p>
<p>CakePHP comes with a number of console applications out of the box.
Some of these applications are used in concert with other CakePHP
features (like ACL or i18n), and others are for general use in
getting you working faster.</p>
<div class="section" id="the-cakephp-console">
<h2>The CakePHP console<a class="headerlink" href="#the-cakephp-console" title="永久链接至标题">¶</a></h2>
<p>This section provides an introduction into CakePHP at the
command-line. If you’ve ever needed access to your CakePHP MVC
classes in a cron job or other command-line script, this section is
for you.</p>
<p>PHP provides a CLI client that makes interfacing with your
file system and applications much smoother. The CakePHP console
provides a framework for creating shell scripts. The Console uses a
dispatcher-type setup to load a shell or task, and hand it its
parameters.</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">A command-line (CLI) build of PHP must be available on the system
if you plan to use the Console.</p>
</div>
<p>Before we get into specifics, let’s make sure we can run the
CakePHP Console. First, you’ll need to bring up a system shell. The
examples shown in this section will be in bash, but the CakePHP
Console is Windows-compatible as well. Let’s execute the Console
program from bash. This example assumes that the user is currently
logged into a bash prompt and is currently at the root of a CakePHP
application.</p>
<p>CakePHP applications contain a <tt class="docutils literal"><span class="pre">Console</span></tt> directory that contains
all the shells and tasks for an application.  It also comes with an
executable:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="err">$</span> <span class="nx">cd</span> <span class="o">/</span><span class="nx">path</span><span class="o">/</span><span class="nx">to</span><span class="o">/</span><span class="nx">cakephp</span><span class="o">/</span><span class="nx">app</span>
<span class="err">$</span> <span class="nx">Console</span><span class="o">/</span><span class="nx">cake</span>
</pre></div>
</div>
<p>It&#8217;s often wise to add the core cake executable to your system path
so you can use the cake command anywhere.  This comes in handy when you are
creating new projects. See <a class="reference internal" href="#adding-cake-to-your-path"><em>Adding cake to your system path</em></a> for how to make <tt class="docutils literal"><span class="pre">cake</span></tt>
available systemwide.</p>
<p>Running the Console with no arguments produces this help message:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nx">Welcome</span> <span class="nx">to</span> <span class="nx">CakePHP</span> <span class="nx">v2</span><span class="o">.</span><span class="mf">0.0</span> <span class="nx">Console</span>
<span class="o">---------------------------------------------------------------</span>
<span class="nx">App</span> <span class="o">:</span> <span class="nx">app</span>
<span class="nx">Path</span><span class="o">:</span> <span class="o">/</span><span class="nx">path</span><span class="o">/</span><span class="nx">to</span><span class="o">/</span><span class="nx">cakephp</span><span class="o">/</span><span class="nx">app</span><span class="o">/</span>
<span class="o">---------------------------------------------------------------</span>
<span class="nx">Current</span> <span class="nx">Paths</span><span class="o">:</span>

 <span class="o">-</span><span class="nx">app</span><span class="o">:</span> <span class="nx">app</span>
 <span class="o">-</span><span class="nx">working</span><span class="o">:</span> <span class="o">/</span><span class="nx">path</span><span class="o">/</span><span class="nx">to</span><span class="o">/</span><span class="nx">cakephp</span><span class="o">/</span><span class="nx">app</span>
 <span class="o">-</span><span class="nx">root</span><span class="o">:</span> <span class="o">/</span><span class="nx">path</span><span class="o">/</span><span class="nx">to</span><span class="o">/</span><span class="nx">cakephp</span><span class="o">/</span>
 <span class="o">-</span><span class="nx">core</span><span class="o">:</span> <span class="o">/</span><span class="nx">path</span><span class="o">/</span><span class="nx">to</span><span class="o">/</span><span class="nx">cakephp</span><span class="o">/</span><span class="nx">core</span>

<span class="nx">Changing</span> <span class="nx">Paths</span><span class="o">:</span>

<span class="nx">your</span> <span class="nx">working</span> <span class="nx">path</span> <span class="nx">should</span> <span class="nx">be</span> <span class="nx">the</span> <span class="nx">same</span> <span class="k">as</span> <span class="nx">your</span> <span class="nx">application</span> <span class="nx">path</span>
<span class="nx">to</span> <span class="nx">change</span> <span class="nx">your</span> <span class="nx">path</span> <span class="k">use</span> <span class="nx">the</span> <span class="s1">&#39;-app&#39;</span> <span class="nx">param</span><span class="o">.</span>
<span class="nx">Example</span><span class="o">:</span> <span class="o">-</span><span class="nx">app</span> <span class="nx">relative</span><span class="o">/</span><span class="nx">path</span><span class="o">/</span><span class="nx">to</span><span class="o">/</span><span class="nx">cakephp</span><span class="o">/</span><span class="nx">app</span> <span class="k">or</span> <span class="o">-</span><span class="nx">app</span> <span class="o">/</span><span class="nx">absolute</span><span class="o">/</span><span class="nx">path</span><span class="o">/</span><span class="nx">to</span><span class="o">/</span><span class="nx">cakephp</span><span class="o">/</span><span class="nx">app</span>

<span class="nx">Available</span> <span class="nx">Shells</span><span class="o">:</span>

 <span class="nx">acl</span> <span class="p">[</span><span class="nx">CORE</span><span class="p">]</span>                              <span class="nx">i18n</span> <span class="p">[</span><span class="nx">CORE</span><span class="p">]</span>
 <span class="nx">api</span> <span class="p">[</span><span class="nx">CORE</span><span class="p">]</span>                              <span class="nx">import</span> <span class="p">[</span><span class="nx">app</span><span class="p">]</span>
 <span class="nx">bake</span> <span class="p">[</span><span class="nx">CORE</span><span class="p">]</span>                             <span class="nx">schema</span> <span class="p">[</span><span class="nx">CORE</span><span class="p">]</span>
 <span class="nx">command_list</span> <span class="p">[</span><span class="nx">CORE</span><span class="p">]</span>                     <span class="nx">testsuite</span> <span class="p">[</span><span class="nx">CORE</span><span class="p">]</span>
 <span class="nx">console</span> <span class="p">[</span><span class="nx">CORE</span><span class="p">]</span>                          <span class="nx">upgrade</span> <span class="p">[</span><span class="nx">CORE</span><span class="p">]</span>

<span class="nx">To</span> <span class="nx">run</span> <span class="nx">a</span> <span class="nx">command</span><span class="p">,</span> <span class="nx">type</span> <span class="s1">&#39;cake shell_name [args]&#39;</span>
<span class="nx">To</span> <span class="nx">get</span> <span class="nx">help</span> <span class="nx">on</span> <span class="nx">a</span> <span class="nx">specific</span> <span class="nx">command</span><span class="p">,</span> <span class="nx">type</span> <span class="s1">&#39;cake shell_name help&#39;</span>
</pre></div>
</div>
<p>The first information printed relates to paths. This is especially
helpful if you&#8217;re running the console from different parts of the
filesystem.</p>
<p>Since many users add the CakePHP console to their system&#8217;s path so it can
be accessed easily. Printing out the working, root, app, and core
paths allows you to see where the console will be making changes.
To change the app folder you wish to work with, you can supply its
path as the first argument to the cake command. This next example
shows how to specify an app folder, assuming you’ve already added
the console folder to your <tt class="docutils literal"><span class="pre">PATH</span></tt>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="err">$</span> <span class="nx">cake</span> <span class="o">-</span><span class="nx">app</span> <span class="o">/</span><span class="nx">path</span><span class="o">/</span><span class="nx">to</span><span class="o">/</span><span class="nx">cakephp</span><span class="o">/</span><span class="nx">app</span>
</pre></div>
</div>
<p>The path supplied can be relative to the current working directory
or supplied as an absolute path.</p>
<div class="section" id="adding-cake-to-your-system-path">
<span id="adding-cake-to-your-path"></span><h3>Adding cake to your system path<a class="headerlink" href="#adding-cake-to-your-system-path" title="永久链接至标题">¶</a></h3>
<p>If you are on a *nix system (linux, MacOSX) the following steps will let you add the
cake executable to your system path.</p>
<ol class="arabic">
<li><p class="first">Locate where your CakePHP install, and cake executable are.  For example
<tt class="docutils literal"><span class="pre">/Users/mark/cakephp/lib/Cake/Console/cake</span></tt></p>
</li>
<li><p class="first">Edit your <tt class="docutils literal"><span class="pre">.bashrc</span></tt> or <tt class="docutils literal"><span class="pre">.bash_profile</span></tt> file in your home directory, and add the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nx">export</span> <span class="nx">PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">$PATH</span><span class="s2">:/Users/mark/cakephp/lib/Cake/Console&quot;</span>
</pre></div>
</div>
</li>
<li><p class="first">Reload the bash configuration or open a new terminal, and <tt class="docutils literal"><span class="pre">cake</span></tt> should work anywhere.</p>
</li>
</ol>
<p>If you are on Windows Vista or 7, you should follow the steps below.</p>
<ol class="arabic">
<li><p class="first">Locate where your CakePHP install and cake executable are.  For example
<tt class="docutils literal"><span class="pre">C:\xampp\htdocs\cakephp\lib\Cake\Console</span></tt></p>
</li>
<li><p class="first">Open System Properties window from My Computer. You want to try the shortcut Windows Key + Pause or Windows Key + Break. Or, from the Desktop, right-click My Computer, click Properties then click Advanced System Settings link in the left column</p>
</li>
<li><p class="first">Go under Advanced tab and click on Environment Variables button</p>
</li>
<li><p class="first">In the System Variables portion, reach Path variable and double-click on it to Edit</p>
</li>
<li><p class="first">Add the <tt class="docutils literal"><span class="pre">cake</span></tt> install path string followed by a semi colon. Result example:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="o">%</span><span class="nx">SystemRoot</span><span class="o">%</span><span class="nx">\system32</span><span class="p">;</span><span class="o">%</span><span class="nx">SystemRoot</span><span class="o">%</span><span class="p">;</span><span class="nx">C</span><span class="o">:</span><span class="nx">\xampp\htdocs\cakephp\lib\Cake\Console</span><span class="p">;</span>
</pre></div>
</div>
</li>
<li><p class="first">Click Ok and <tt class="docutils literal"><span class="pre">cake</span></tt> should work anywhere.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="shell-creating-a-shell">
<h2>创建一个shell Creating a shell<a class="headerlink" href="#shell-creating-a-shell" title="永久链接至标题">¶</a></h2>
<p>让我们创建一个shell在命令行中使用。在这个例子中，我们创建一个简单的Hello world的shell。</p>
<p>Let&#8217;s create a shell for use in the Console. For this example,
we&#8217;ll create a simple Hello world shell.  In your applications
<tt class="docutils literal"><span class="pre">Console/Command</span></tt> directory create <tt class="docutils literal"><span class="pre">HelloShell.php</span></tt>.  Put the following
code inside it:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">class</span> <span class="nc">HelloShell</span> <span class="k">extends</span> <span class="nx">AppShell</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="s1">&#39;Hello world.&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The conventions for shell classes are that the class name should match
the file name, with the suffix of Shell. In our shell we created a <tt class="docutils literal"><span class="pre">main()</span></tt> method.
This method is called when a shell is called with no additional commands.  We&#8217;ll add
some more commands in a bit, but for now lets just run our shell.  From your application
directory, run:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nx">Console</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">hello</span>
</pre></div>
</div>
<p>You should see the following output:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nx">Welcome</span> <span class="nx">to</span> <span class="nx">CakePHP</span> <span class="nx">v2</span><span class="o">.</span><span class="mf">0.0</span> <span class="nx">Console</span>
<span class="o">---------------------------------------------------------------</span>
<span class="nx">App</span> <span class="o">:</span> <span class="nx">app</span>
<span class="nx">Path</span><span class="o">:</span> <span class="o">/</span><span class="nx">Users</span><span class="o">/</span><span class="nx">markstory</span><span class="o">/</span><span class="nx">Sites</span><span class="o">/</span><span class="nx">cake_dev</span><span class="o">/</span><span class="nx">app</span><span class="o">/</span>
<span class="o">---------------------------------------------------------------</span>
<span class="nx">Hello</span> <span class="nx">world</span><span class="o">.</span>
</pre></div>
</div>
<p>As mentioned before, the <tt class="docutils literal"><span class="pre">main()</span></tt> method in shells is a special method called
whenever there are no other commands or arguments given to a shell.  You may have also
noticed that HelloShell is extending <tt class="docutils literal"><span class="pre">AppShell</span></tt>.  Much like <a class="reference internal" href="controllers.html#app-controller"><em>App 控制器</em></a>, AppShell
gives you a base class to contain all your common functions or logic.  You can define an AppShell,
by creating <tt class="docutils literal"><span class="pre">app/Console/Command/AppShell.php</span></tt>.  If you don&#8217;t have one, CakePHP will use the
built-in one. Since our main method wasn&#8217;t very interesting lets add another command
that does something:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">class</span> <span class="nc">HelloShell</span> <span class="k">extends</span> <span class="nx">AppShell</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="s1">&#39;Hello world.&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">hey_there</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="s1">&#39;Hey there &#39;</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>After saving this file you should be able to run <tt class="docutils literal"><span class="pre">Console/cake</span> <span class="pre">hello</span> <span class="pre">hey_there</span> <span class="pre">your-name</span></tt>
and see your name printed out.  Any public method not prefixed by an <tt class="docutils literal"><span class="pre">_</span></tt> is allowed to be
called from the command line.  In our <tt class="docutils literal"><span class="pre">hey_there</span></tt> method we also used <tt class="docutils literal"><span class="pre">$this-&gt;args</span></tt>, this
property contains an array of all the positional arguments provided to a command.  You can
also use switches or options on shell applications, these are available at <tt class="docutils literal"><span class="pre">$this-&gt;params</span></tt>,
but we&#8217;ll cover that in a bit.</p>
<p>When using a <tt class="docutils literal"><span class="pre">main()</span></tt> method you won&#8217;t be able to use the positional arguments
or parameters.  This is because the first positional argument or option is
interpreted as the command name.  If you want to use arguments and options, you
should use method names other than <tt class="docutils literal"><span class="pre">main</span></tt>.</p>
<div class="section" id="using-models-in-your-shells">
<h3>Using Models in your shells<a class="headerlink" href="#using-models-in-your-shells" title="永久链接至标题">¶</a></h3>
<p>You&#8217;ll often need access to your application&#8217;s business logic in shell utilities;
CakePHP makes that super easy.  By setting a <tt class="docutils literal"><span class="pre">$uses</span></tt> property, you can define an
array of models you want to have access to in your shell.  The defined models
are loaded in as properties attached to your shell, just like a controller gets
models attached to it:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">class</span> <span class="nc">UserShell</span> <span class="k">extends</span> <span class="nx">AppShell</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$uses</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">);</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">show</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$user</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">User</span><span class="o">-&gt;</span><span class="na">findByUsername</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="nb">print_r</span><span class="p">(</span><span class="nv">$user</span><span class="p">,</span> <span class="k">true</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above shell, will fetch a user by username and display the information
stored in the database.</p>
</div>
</div>
<div class="section" id="shell-tasks">
<h2>Shell tasks<a class="headerlink" href="#shell-tasks" title="永久链接至标题">¶</a></h2>
<p>There will be times when building more advanced console applications, you&#8217;ll want
to compose functionality into re-usable classes that can be shared across many shells.
Tasks allow you to extract commands into classes.  For example the <tt class="docutils literal"><span class="pre">bake</span></tt> is made
almost entirely of tasks.  You define a shell&#8217;s tasks by using the <tt class="docutils literal"><span class="pre">$tasks</span></tt> property:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">class</span> <span class="nc">UserShell</span> <span class="k">extends</span> <span class="nx">AppShell</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$tasks</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Template&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can use tasks from plugins using the standard <a class="reference internal" href="appendices/glossary.html#term-plugin-syntax"><em class="xref std std-term">plugin syntax</em></a>.
Tasks are stored in <tt class="docutils literal"><span class="pre">Console/Command/Task/</span></tt> in files named after
their classes. So if we were to create a new &#8216;FileGenerator&#8217; task, you would create
<tt class="docutils literal"><span class="pre">Console/Command/Task/FileGeneratorTask.php</span></tt>.</p>
<p>Each task must at least implement an <tt class="docutils literal"><span class="pre">execute()</span></tt> method.  The ShellDispatcher,
will call this method when the task is invoked.  A task class looks like:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">class</span> <span class="nc">FileGeneratorTask</span> <span class="k">extends</span> <span class="nx">Shell</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$uses</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">);</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">execute</span><span class="p">()</span> <span class="p">{</span>

    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A shell can also access it&#8217;s tasks as properties, which makes tasks great for
making re-usable chunks of functionality similar to <a class="reference internal" href="controllers/components.html"><em>组件</em></a>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="c1">// found in Console/Command/SeaShell.php</span>
<span class="k">class</span> <span class="nc">SeaShell</span> <span class="k">extends</span> <span class="nx">AppShell</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$tasks</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Sound&#39;</span><span class="p">);</span> <span class="c1">// found in Console/Command/Task/SoundTask.php</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Sound</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can also access tasks directly from the command line:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="err">$</span> <span class="nx">cake</span> <span class="nx">sea</span> <span class="nx">sound</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">In order to access tasks directly from the command line, the task
<strong>must</strong> be included in the shell class&#8217; $tasks property.
Therefore, be warned that a method called “sound” in the SeaShell
class would override the ability to access the functionality in the
Sound task specified in the $tasks array.</p>
</div>
<div class="section" id="loading-tasks-on-the-fly-with-taskcollection">
<h3>Loading tasks on the fly with TaskCollection<a class="headerlink" href="#loading-tasks-on-the-fly-with-taskcollection" title="永久链接至标题">¶</a></h3>
<p>You can load tasks on the fly using the Task collection object. You can load tasks that
were not declared in $tasks this way:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$Project</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Tasks</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">(</span><span class="s1">&#39;Project&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Would load and return a ProjectTask instance. You can load tasks from plugins using:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$ProgressBar</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Tasks</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">(</span><span class="s1">&#39;ProgressBar.ProgressBar&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="invoking-other-shells-from-your-shell">
<span id="id1"></span><h2>Invoking other shells from your shell<a class="headerlink" href="#invoking-other-shells-from-your-shell" title="永久链接至标题">¶</a></h2>
<p>Shells no longer have direct access to the ShellDispatcher any more through <cite>$this-&gt;Dispatch</cite>.
There are still many cases where you will want to invoke one shell from another though.
<cite>Shell::dispatchShell()</cite> gives you the ability to call other shells by providing the
<cite>argv</cite> for the sub shell.  You can provide arguments and options either
as var args or as a string:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="c1">// As a string</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">dispatchShell</span><span class="p">(</span><span class="s1">&#39;schema create Blog --plugin Blog&#39;</span><span class="p">);</span>

<span class="c1">// As an array</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">dispatchShell</span><span class="p">(</span><span class="s1">&#39;schema&#39;</span><span class="p">,</span> <span class="s1">&#39;create&#39;</span><span class="p">,</span> <span class="s1">&#39;Blog&#39;</span><span class="p">,</span> <span class="s1">&#39;--plugin&#39;</span><span class="p">,</span> <span class="s1">&#39;Blog&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>The above shows how you can call the schema shell to create the schema for a plugin
from inside your plugin&#8217;s shell.</p>
</div>
<div class="section" id="console-output-levels">
<span id="shell-output-level"></span><h2>Console output levels<a class="headerlink" href="#console-output-levels" title="永久链接至标题">¶</a></h2>
<p>Shells often need different levels of verbosity.  When running as cron jobs,
most output is un-necessary.  And there are times when you are not interested in
everything that a shell has to say.  You can use output levels to flag output
appropriately.  The user of the shell, can then decide what level of detail
they are interested in by setting the correct flag when calling the shell.
<a class="reference internal" href="#Shell::out" title="Shell::out"><tt class="xref php php-meth docutils literal"><span class="pre">Shell::out()</span></tt></a> supports 3 types of output by default.</p>
<ul class="simple">
<li>QUIET - Only absolutely important information should be marked for quiet output.</li>
<li>NORMAL - The default level, and normal usage</li>
<li>VERBOSE - Mark messages that may be too noisy for everyday use, but helpful
for debugging as VERBOSE</li>
</ul>
<p>You can mark output as follows:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="c1">// would appear at all levels.</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="s1">&#39;Quiet message&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">Shell</span><span class="o">::</span><span class="na">QUIET</span><span class="p">);</span>

<span class="c1">// would not appear when quiet output is toggled</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="s1">&#39;normal message&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">Shell</span><span class="o">::</span><span class="na">NORMAL</span><span class="p">);</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="s1">&#39;loud message&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">Shell</span><span class="o">::</span><span class="na">VERBOSE</span><span class="p">);</span>

<span class="c1">// would only appear when verbose output is enabled.</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="s1">&#39;extra message&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">Shell</span><span class="o">::</span><span class="na">VERBOSE</span><span class="p">);</span>
</pre></div>
</div>
<p>You can control the output level of shells, by using the <tt class="docutils literal"><span class="pre">--quiet</span></tt> and <tt class="docutils literal"><span class="pre">--verbose</span></tt>
options. These options are added by default, and allow you to consistently control
output levels inside your CakePHP shells.</p>
</div>
<div class="section" id="styling-output">
<h2>Styling output<a class="headerlink" href="#styling-output" title="永久链接至标题">¶</a></h2>
<p>Styling output is done by including tags - just like html - in your output.
ConsoleOutput will replace these tags with the correct ansi code sequence, or
remove the tags if you are on a console that doesn&#8217;t support ansi codes. There
are several built in styles, and you can create more.  The built in ones are</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">error</span></tt> Error messages. Red underlined text.</li>
<li><tt class="docutils literal"><span class="pre">warning</span></tt> Warning messages. Yellow text.</li>
<li><tt class="docutils literal"><span class="pre">info</span></tt> Informational messages. Cyan text.</li>
<li><tt class="docutils literal"><span class="pre">comment</span></tt> Additional text. Blue text.</li>
<li><tt class="docutils literal"><span class="pre">question</span></tt> Text that is a question, added automatically by shell.</li>
</ul>
<p>You can create additional styles using <cite>$this-&gt;stdout-&gt;styles()</cite>.  To declare a
new output style you could do:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">stdout</span><span class="o">-&gt;</span><span class="na">styles</span><span class="p">(</span><span class="s1">&#39;flashy&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;text&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="s1">&#39;blink&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">));</span>
</pre></div>
</div>
<p>This would then allow you to use a <tt class="docutils literal"><span class="pre">&lt;flashy&gt;</span></tt> tag in your shell output, and if ansi
colours are enabled, the following would be rendered as blinking magenta text
<tt class="docutils literal"><span class="pre">$this-&gt;out('&lt;flashy&gt;Whoooa&lt;/flashy&gt;</span> <span class="pre">Something</span> <span class="pre">went</span> <span class="pre">wrong');</span></tt>.  When defining
styles you can use the following colours for the <cite>text</cite> and <cite>background</cite> attributes:</p>
<ul class="simple">
<li>black</li>
<li>red</li>
<li>green</li>
<li>yellow</li>
<li>blue</li>
<li>magenta</li>
<li>cyan</li>
<li>white</li>
</ul>
<p>You can also use the following options as boolean switches, setting them to a
truthy value enables them.</p>
<ul class="simple">
<li>bold</li>
<li>underline</li>
<li>blink</li>
<li>reverse</li>
</ul>
<p>Adding a style makes it available on all instances of ConsoleOutput as well,
so you don&#8217;t have to redeclare styles for both stdout and stderr objects.</p>
<div class="section" id="turning-off-colouring">
<h3>Turning off colouring<a class="headerlink" href="#turning-off-colouring" title="永久链接至标题">¶</a></h3>
<p>Although colouring is pretty awesome, there may be times when you want to turn it off,
or force it on:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">output</span><span class="o">-&gt;</span><span class="na">outputAs</span><span class="p">(</span><span class="nx">ConsoleOutput</span><span class="o">::</span><span class="na">RAW</span><span class="p">);</span>
</pre></div>
</div>
<p>The above will put the output object into raw output mode.  In raw output mode,
no styling is done at all.  There are three modes you can use.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">ConsoleOutput::RAW</span></tt> - Raw output, no styling or formatting will be done.
This is a good mode to use if you are outputting XML or, want to debug why
your styling isn&#8217;t working.</li>
<li><tt class="docutils literal"><span class="pre">ConsoleOutput::PLAIN</span></tt> - Plain text output, known style tags will be stripped
from the output.</li>
<li><tt class="docutils literal"><span class="pre">ConsoleOutput::COLOR</span></tt> - Output with color escape codes in place.</li>
</ul>
<p>By default on *nix systems ConsoleOutput objects default to colour output.
On windows systems, plain output is the default unless the <tt class="docutils literal"><span class="pre">ANSICON</span></tt> environment
variable is present.</p>
</div>
</div>
<div class="section" id="configuring-options-and-generating-help">
<h2>Configuring options and generating help<a class="headerlink" href="#configuring-options-and-generating-help" title="永久链接至标题">¶</a></h2>
<dl class="class">
<dt id="ConsoleOptionParser">
<em class="property">class </em><tt class="descname">ConsoleOptionParser</tt><a class="headerlink" href="#ConsoleOptionParser" title="永久链接至目标">¶</a></dt>
<dd></dd></dl>

<p>Console option parsing in CakePHP has always been a little bit different
from everything else on the command line.  In 2.0 <tt class="docutils literal"><span class="pre">ConsoleOptionParser</span></tt>
helps provide a more familiar command line option and argument parser.</p>
<p>OptionParsers allow you to accomplish two goals at the same time.
First they allow you to define the options and arguments, separating
basic input validation and your code.  Secondly, it allows you to provide
documentation, that is used to generate well formatted help file.</p>
<p>The console framework gets your shell&#8217;s option parser by calling
<tt class="docutils literal"><span class="pre">$this-&gt;getOptionParser()</span></tt>.  Overriding this method allows you to
configure the OptionParser to match the expected inputs of your shell.
You can also configure subcommand option parsers, which allow you to
have different option parsers for subcommands and tasks.
The ConsoleOptionParser implements a fluent interface and includes
methods for easily setting multiple options/arguments at once.:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">getOptionParser</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$parser</span> <span class="o">=</span> <span class="k">parent</span><span class="o">::</span><span class="na">getOptionParser</span><span class="p">();</span>
    <span class="c1">//configure parser</span>
    <span class="k">return</span> <span class="nv">$parser</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="configuring-an-option-parser-with-the-fluent-interface">
<h3>Configuring an option parser with the fluent interface<a class="headerlink" href="#configuring-an-option-parser-with-the-fluent-interface" title="永久链接至标题">¶</a></h3>
<p>All of the methods that configure an option parser can be chained,
allowing you to define an entire option parser in one series of method calls:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">getOptionParser</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$parser</span> <span class="o">=</span> <span class="k">parent</span><span class="o">::</span><span class="na">getOptionParser</span><span class="p">();</span>
    <span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addArgument</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Either a full path or type of class.&#39;</span>
    <span class="p">))</span><span class="o">-&gt;</span><span class="na">addArgument</span><span class="p">(</span><span class="s1">&#39;className&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;A CakePHP core class name (e.g: Component, HtmlHelper).&#39;</span>
    <span class="p">))</span><span class="o">-&gt;</span><span class="na">addOption</span><span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;short&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;The specific method you want help on.&#39;</span><span class="p">)</span>
    <span class="p">))</span><span class="o">-&gt;</span><span class="na">description</span><span class="p">(</span><span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Lookup doc block comments for classes in CakePHP.&#39;</span><span class="p">));</span>
    <span class="k">return</span> <span class="nv">$parser</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The methods that allow chaining are:</p>
<ul class="simple">
<li>description()</li>
<li>epilog()</li>
<li>command()</li>
<li>addArgument()</li>
<li>addArguments()</li>
<li>addOption()</li>
<li>addOptions()</li>
<li>addSubcommand()</li>
<li>addSubcommands()</li>
</ul>
<dl class="method">
<dt id="ConsoleOptionParser::description">
<tt class="descclassname">ConsoleOptionParser::</tt><tt class="descname">description</tt><big>(</big><em>$text = null</em><big>)</big><a class="headerlink" href="#ConsoleOptionParser::description" title="永久链接至目标">¶</a></dt>
<dd></dd></dl>

<p>Gets or sets the description for the option parser.  The description
displays above the argument and option information. By passing in
either an array or a string, you can set the value of the description.
Calling with no arguments will return the current value:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="c1">// Set multiple lines at once</span>
<span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">description</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;line one&#39;</span><span class="p">,</span> <span class="s1">&#39;line two&#39;</span><span class="p">));</span>

<span class="c1">// read the current value</span>
<span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">description</span><span class="p">();</span>
</pre></div>
</div>
<dl class="method">
<dt id="ConsoleOptionParser::epilog">
<tt class="descclassname">ConsoleOptionParser::</tt><tt class="descname">epilog</tt><big>(</big><em>$text = null</em><big>)</big><a class="headerlink" href="#ConsoleOptionParser::epilog" title="永久链接至目标">¶</a></dt>
<dd></dd></dl>

<p>Gets or sets the epilog for the option parser.  The epilog
is displayed after the argument and option information. By passing in
either an array or a string, you can set the value of the epilog.
Calling with no arguments will return the current value:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="c1">// Set multiple lines at once</span>
<span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">epilog</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;line one&#39;</span><span class="p">,</span> <span class="s1">&#39;line two&#39;</span><span class="p">));</span>

<span class="c1">// read the current value</span>
<span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">epilog</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-arguments">
<h3>Adding arguments<a class="headerlink" href="#adding-arguments" title="永久链接至标题">¶</a></h3>
<dl class="method">
<dt id="ConsoleOptionParser::addArgument">
<tt class="descclassname">ConsoleOptionParser::</tt><tt class="descname">addArgument</tt><big>(</big><em>$name</em>, <em>$params = array()</em><big>)</big><a class="headerlink" href="#ConsoleOptionParser::addArgument" title="永久链接至目标">¶</a></dt>
<dd></dd></dl>

<p>Positional arguments are frequently used in command line tools,
and <tt class="docutils literal"><span class="pre">ConsoleOptionParser</span></tt> allows you to define positional
arguments as well as make them required.  You can add arguments
one at a time with <tt class="docutils literal"><span class="pre">$parser-&gt;addArgument();</span></tt> or multiple at once
with <tt class="docutils literal"><span class="pre">$parser-&gt;addArguments();</span></tt>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addArgument</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;The model to bake&#39;</span><span class="p">));</span>
</pre></div>
</div>
<p>You can use the following options when creating an argument:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">help</span></tt> The help text to display for this argument.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">required</span></tt> Whether this parameter is required.</p>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">index</span></tt> The index for the arg, if left undefined the argument will be put</dt>
<dd><p class="first last">onto the end of the arguments. If you define the same index twice the
first option will be overwritten.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">choices</span></tt> An array of valid choices for this argument.  If left empty all</dt>
<dd><p class="first last">values are valid. An exception will be raised when parse() encounters an
invalid value.</p>
</dd>
</dl>
</li>
</ul>
<p>Arguments that have been marked as required will throw an exception when
parsing the command if they have been omitted. So you don&#8217;t have to
handle that in your shell.</p>
<dl class="method">
<dt id="ConsoleOptionParser::addArguments">
<tt class="descclassname">ConsoleOptionParser::</tt><tt class="descname">addArguments</tt><big>(</big><em>array $args</em><big>)</big><a class="headerlink" href="#ConsoleOptionParser::addArguments" title="永久链接至目标">¶</a></dt>
<dd></dd></dl>

<p>If you have an array with multiple arguments you can use <tt class="docutils literal"><span class="pre">$parser-&gt;addArguments()</span></tt>
to add multiple arguments at once.:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addArguments</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;node&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;The node to create&#39;</span><span class="p">,</span> <span class="s1">&#39;required&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">),</span>
    <span class="s1">&#39;parent&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;The parent node&#39;</span><span class="p">,</span> <span class="s1">&#39;required&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">)</span>
<span class="p">));</span>
</pre></div>
</div>
<p>As with all the builder methods on ConsoleOptionParser, addArguments
can be used as part of a fluent method chain.</p>
</div>
<div class="section" id="validating-arguments">
<h3>Validating arguments<a class="headerlink" href="#validating-arguments" title="永久链接至标题">¶</a></h3>
<p>When creating positional arguments, you can use the <tt class="docutils literal"><span class="pre">required</span></tt> flag, to
indicate that an argument must be present when a shell is called.
Additionally you can use <tt class="docutils literal"><span class="pre">choices</span></tt> to force an argument to
be from a list of valid choices:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addArgument</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;The type of node to interact with.&#39;</span><span class="p">,</span>
    <span class="s1">&#39;required&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">&#39;choices&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;aro&#39;</span><span class="p">,</span> <span class="s1">&#39;aco&#39;</span><span class="p">)</span>
<span class="p">));</span>
</pre></div>
</div>
<p>The above will create an argument that is required and has validation
on the input.  If the argument is either missing, or has an incorrect
value an exception will be raised and the shell will be stopped.</p>
</div>
<div class="section" id="adding-options">
<h3>Adding Options<a class="headerlink" href="#adding-options" title="永久链接至标题">¶</a></h3>
<dl class="method">
<dt id="ConsoleOptionParser::addOption">
<tt class="descclassname">ConsoleOptionParser::</tt><tt class="descname">addOption</tt><big>(</big><em>$name</em>, <em>$options = array()</em><big>)</big><a class="headerlink" href="#ConsoleOptionParser::addOption" title="永久链接至目标">¶</a></dt>
<dd></dd></dl>

<p>Options or flags are also frequently used in command line tools.
<tt class="docutils literal"><span class="pre">ConsoleOptionParser</span></tt> supports creating options
with both verbose and short aliases, supplying defaults
and creating boolean switches. Options are created with either
<tt class="docutils literal"><span class="pre">$parser-&gt;addOption()</span></tt> or <tt class="docutils literal"><span class="pre">$parser-&gt;addOptions()</span></tt>.:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addOption</span><span class="p">(</span><span class="s1">&#39;connection&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;short&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span>
    <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;connection&#39;</span><span class="p">,</span>
    <span class="s1">&#39;default&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span>
<span class="p">));</span>
</pre></div>
</div>
<p>The above would allow you to use either <tt class="docutils literal"><span class="pre">cake</span> <span class="pre">myshell</span> <span class="pre">--connection=other</span></tt>,
<tt class="docutils literal"><span class="pre">cake</span> <span class="pre">myshell</span> <span class="pre">--connection</span> <span class="pre">other</span></tt>, or <tt class="docutils literal"><span class="pre">cake</span> <span class="pre">myshell</span> <span class="pre">-c</span> <span class="pre">other</span></tt>
when invoking the shell. You can also create boolean switches, these switches do not
consume values, and their presence just enables them in the
parsed parameters.:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addOption</span><span class="p">(</span><span class="s1">&#39;no-commit&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;boolean&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">));</span>
</pre></div>
</div>
<p>With this option, when calling a shell like <tt class="docutils literal"><span class="pre">cake</span> <span class="pre">myshell</span> <span class="pre">--no-commit</span> <span class="pre">something</span></tt>
the no-commit param would have a value of true, and &#8216;something&#8217;
would be a treated as a positional argument.
The built-in <tt class="docutils literal"><span class="pre">--help</span></tt>, <tt class="docutils literal"><span class="pre">--verbose</span></tt>, and <tt class="docutils literal"><span class="pre">--quiet</span></tt> options
use this feature.</p>
<p>When creating options you can use the following options to
define the behavior of the option:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">short</span></tt> - The single letter variant for this option, leave undefined for none.</li>
<li><tt class="docutils literal"><span class="pre">help</span></tt> - Help text for this option.  Used when generating help for the option.</li>
<li><tt class="docutils literal"><span class="pre">default</span></tt> - The default value for this option.  If not defined the default will be true.</li>
<li><tt class="docutils literal"><span class="pre">boolean</span></tt> - The option uses no value, it&#8217;s just a boolean switch.
Defaults to false.</li>
<li><tt class="docutils literal"><span class="pre">choices</span></tt> An array of valid choices for this option.  If left empty all
values are valid. An exception will be raised when parse() encounters an invalid value.</li>
</ul>
<dl class="method">
<dt id="ConsoleOptionParser::addOptions">
<tt class="descclassname">ConsoleOptionParser::</tt><tt class="descname">addOptions</tt><big>(</big><em>array $options</em><big>)</big><a class="headerlink" href="#ConsoleOptionParser::addOptions" title="永久链接至目标">¶</a></dt>
<dd></dd></dl>

<p>If you have an array with multiple options you can use <tt class="docutils literal"><span class="pre">$parser-&gt;addOptions()</span></tt>
to add multiple options at once.:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addOptions</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;node&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;short&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;The node to create&#39;</span><span class="p">),</span>
    <span class="s1">&#39;parent&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;short&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;The parent node&#39;</span><span class="p">)</span>
<span class="p">));</span>
</pre></div>
</div>
<p>As with all the builder methods on ConsoleOptionParser, addOptions is can be used
as part of a fluent method chain.</p>
</div>
<div class="section" id="validating-options">
<h3>Validating options<a class="headerlink" href="#validating-options" title="永久链接至标题">¶</a></h3>
<p>Options can be provided with a set of choices much like positional arguments
can be.  When an option has defined choices, those are the only valid choices
for an option.  All other values will raise an <tt class="docutils literal"><span class="pre">InvalidArgumentException</span></tt>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addOption</span><span class="p">(</span><span class="s1">&#39;accept&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;What version to accept.&#39;</span><span class="p">,</span>
    <span class="s1">&#39;choices&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;working&#39;</span><span class="p">,</span> <span class="s1">&#39;theirs&#39;</span><span class="p">,</span> <span class="s1">&#39;mine&#39;</span><span class="p">)</span>
<span class="p">));</span>
</pre></div>
</div>
</div>
<div class="section" id="using-boolean-options">
<h3>Using boolean options<a class="headerlink" href="#using-boolean-options" title="永久链接至标题">¶</a></h3>
<p>Options can be defined as boolean options, which are useful when you need to create
some flag options.  Like options with defaults, boolean options always include
themselves into the parsed parameters.  When the flags are present they are set
to true, when they are absent false:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addOption</span><span class="p">(</span><span class="s1">&#39;verbose&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Enable verbose output.&#39;</span><span class="p">,</span>
    <span class="s1">&#39;boolean&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span>
<span class="p">));</span>
</pre></div>
</div>
<p>The following option would result in <tt class="docutils literal"><span class="pre">$this-&gt;params['verbose']</span></tt> always
being available.  This lets you omit <tt class="docutils literal"><span class="pre">empty()</span></tt> or <tt class="docutils literal"><span class="pre">isset()</span></tt>
checks for boolean flags:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">params</span><span class="p">[</span><span class="s1">&#39;verbose&#39;</span><span class="p">])</span> <span class="p">{</span>
    <span class="c1">// do something</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Since the boolean options are always defined as <tt class="docutils literal"><span class="pre">true</span></tt> or
<tt class="docutils literal"><span class="pre">false</span></tt> you can omit additional check methods.</p>
</div>
<div class="section" id="adding-subcommands">
<h3>Adding subcommands<a class="headerlink" href="#adding-subcommands" title="永久链接至标题">¶</a></h3>
<dl class="method">
<dt id="ConsoleOptionParser::addSubcommand">
<tt class="descclassname">ConsoleOptionParser::</tt><tt class="descname">addSubcommand</tt><big>(</big><em>$name</em>, <em>$options = array()</em><big>)</big><a class="headerlink" href="#ConsoleOptionParser::addSubcommand" title="永久链接至目标">¶</a></dt>
<dd></dd></dl>

<p>Console applications are often made of subcommands, and these subcommands
may require special option parsing and have their own help.  A perfect
example of this is <tt class="docutils literal"><span class="pre">bake</span></tt>.  Bake is made of many separate tasks that all
have their own help and options. <tt class="docutils literal"><span class="pre">ConsoleOptionParser</span></tt> allows you to
define subcommands and provide command specific option parsers so the
shell knows how to parse commands for its tasks:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addSubcommand</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Bake a model&#39;</span><span class="p">,</span>
    <span class="s1">&#39;parser&#39;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Model</span><span class="o">-&gt;</span><span class="na">getOptionParser</span><span class="p">()</span>
<span class="p">));</span>
</pre></div>
</div>
<p>The above is an example of how you could provide help and a specialized
option parser for a shell&#8217;s task. By calling the Task&#8217;s <tt class="docutils literal"><span class="pre">getOptionParser()</span></tt>
we don&#8217;t have to duplicate the option parser generation, or mix concerns
in our shell.  Adding subcommands in this way has two advantages.
First it lets your shell easily document its subcommands in the
generated help, and it also allows easy access to the subcommand
help.  With the above subcommand created you could call
<tt class="docutils literal"><span class="pre">cake</span> <span class="pre">myshell</span> <span class="pre">--help</span></tt> and see the list of subcommands, and
also run <tt class="docutils literal"><span class="pre">cake</span> <span class="pre">myshell</span> <span class="pre">model</span> <span class="pre">--help</span></tt> to view the help for
just the model task.</p>
<p>When defining a subcommand you can use the following options:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">help</span></tt> - Help text for the subcommand.</li>
<li><tt class="docutils literal"><span class="pre">parser</span></tt> - A ConsoleOptionParser for the subcommand.  This allows you
to create method specific option parsers.  When help is generated for a
subcommand, if a parser is present it will be used. You can also
supply the parser as an array that is compatible with
<a class="reference internal" href="#ConsoleOptionParser::buildFromArray" title="ConsoleOptionParser::buildFromArray"><tt class="xref php php-meth docutils literal"><span class="pre">ConsoleOptionParser::buildFromArray()</span></tt></a></li>
</ul>
<p>Adding subcommands can be done as part of a fluent method chain.</p>
</div>
<div class="section" id="building-a-consoleoptionparser-from-an-array">
<h3>Building a ConsoleOptionParser from an array<a class="headerlink" href="#building-a-consoleoptionparser-from-an-array" title="永久链接至标题">¶</a></h3>
<dl class="method">
<dt id="ConsoleOptionParser::buildFromArray">
<tt class="descclassname">ConsoleOptionParser::</tt><tt class="descname">buildFromArray</tt><big>(</big><em>$spec</em><big>)</big><a class="headerlink" href="#ConsoleOptionParser::buildFromArray" title="永久链接至目标">¶</a></dt>
<dd></dd></dl>

<p>As previously mentioned, when creating subcommand option parsers,
you can define the parser spec as an array for that method. This can help
make building subcommand parsers easier, as everything is an array:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$parser</span><span class="o">-&gt;</span><span class="na">addSubcommand</span><span class="p">(</span><span class="s1">&#39;check&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Check the permissions between an ACO and ARO.&#39;</span><span class="p">),</span>
    <span class="s1">&#39;parser&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;description&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="nx">__</span><span class="p">(</span><span class="s2">&quot;Use this command to grant ACL permissions. Once executed, the ARO &quot;</span><span class="p">),</span>
            <span class="nx">__</span><span class="p">(</span><span class="s2">&quot;specified (and its children, if any) will have ALLOW access to the&quot;</span><span class="p">),</span>
            <span class="nx">__</span><span class="p">(</span><span class="s2">&quot;specified ACO action (and the ACO&#39;s children, if any).&quot;</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="s1">&#39;arguments&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;aro&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;ARO to check.&#39;</span><span class="p">),</span> <span class="s1">&#39;required&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">),</span>
            <span class="s1">&#39;aco&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;ACO to check.&#39;</span><span class="p">),</span> <span class="s1">&#39;required&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">),</span>
            <span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Action to check&#39;</span><span class="p">))</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">));</span>
</pre></div>
</div>
<p>Inside the parser spec, you can define keys for <tt class="docutils literal"><span class="pre">definition</span></tt>,
<tt class="docutils literal"><span class="pre">arguments</span></tt>, <tt class="docutils literal"><span class="pre">options</span></tt>, and <tt class="docutils literal"><span class="pre">epilog</span></tt>.  You cannot define
subcommands inside an array style builder.  The values for
arguments, and options, should follow the format that
<a class="reference internal" href="#ConsoleOptionParser::addArguments" title="ConsoleOptionParser::addArguments"><tt class="xref php php-func docutils literal"><span class="pre">ConsoleOptionParser::addArguments()</span></tt></a> and <a class="reference internal" href="#ConsoleOptionParser::addOptions" title="ConsoleOptionParser::addOptions"><tt class="xref php php-func docutils literal"><span class="pre">ConsoleOptionParser::addOptions()</span></tt></a>
use.  You can also use buildFromArray on its own, to build an option parser:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">getOptionParser</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">ConsoleOptionParser</span><span class="o">::</span><span class="na">buildFromArray</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;description&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="nx">__</span><span class="p">(</span><span class="s2">&quot;Use this command to grant ACL permissions. Once executed, the ARO &quot;</span><span class="p">),</span>
            <span class="nx">__</span><span class="p">(</span><span class="s2">&quot;specified (and its children, if any) will have ALLOW access to the&quot;</span><span class="p">),</span>
            <span class="nx">__</span><span class="p">(</span><span class="s2">&quot;specified ACO action (and the ACO&#39;s children, if any).&quot;</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="s1">&#39;arguments&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;aro&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;ARO to check.&#39;</span><span class="p">),</span> <span class="s1">&#39;required&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">),</span>
            <span class="s1">&#39;aco&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;ACO to check.&#39;</span><span class="p">),</span> <span class="s1">&#39;required&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">),</span>
            <span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;help&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Action to check&#39;</span><span class="p">))</span>
        <span class="p">)</span>
    <span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="getting-help-from-shells">
<h3>Getting help from shells<a class="headerlink" href="#getting-help-from-shells" title="永久链接至标题">¶</a></h3>
<p>With the addition of ConsoleOptionParser getting help from shells is done
in a consistent and uniform way. By using the <tt class="docutils literal"><span class="pre">--help</span></tt> or -<tt class="docutils literal"><span class="pre">h</span></tt> option you
can view the help for any core shell, and any shell that implements a ConsoleOptionParser:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nx">cake</span> <span class="nx">bake</span> <span class="o">--</span><span class="nx">help</span>
<span class="nx">cake</span> <span class="nx">bake</span> <span class="o">-</span><span class="nx">h</span>
</pre></div>
</div>
<p>Would both generate the help for bake.  If the shell supports subcommands
you can get help for those in a similar fashion:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nx">cake</span> <span class="nx">bake</span> <span class="nx">model</span> <span class="o">--</span><span class="nx">help</span>
<span class="nx">cake</span> <span class="nx">bake</span> <span class="nx">model</span> <span class="o">-</span><span class="nx">h</span>
</pre></div>
</div>
<p>This would get you the help specific to bake&#8217;s model task.</p>
</div>
<div class="section" id="getting-help-as-xml">
<h3>Getting help as XML<a class="headerlink" href="#getting-help-as-xml" title="永久链接至标题">¶</a></h3>
<p>When building automated tools or development tools that need to interact
with CakePHP shells, its nice to have help available in a machine parse-able
format.  The ConsoleOptionParser can provide help in xml by setting an
additional argument:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nx">cake</span> <span class="nx">bake</span> <span class="o">--</span><span class="nx">help</span> <span class="nx">xml</span>
<span class="nx">cake</span> <span class="nx">bake</span> <span class="o">-</span><span class="nx">h</span> <span class="nx">xml</span>
</pre></div>
</div>
<p>The above would return an XML document with the generated help, options,
arguments and subcommands for the selected shell.  A sample XML document
would look like:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;shell&gt;</span>
    <span class="nt">&lt;command&gt;</span>bake fixture<span class="nt">&lt;/command&gt;</span>
    <span class="nt">&lt;description&gt;</span>Generate fixtures for use with the test suite. You can use
        `bake fixture all` to bake all fixtures.<span class="nt">&lt;/description&gt;</span>
    <span class="nt">&lt;epilog&gt;</span>Omitting all arguments and options will enter into an interactive mode.<span class="nt">&lt;/epilog&gt;</span>
    <span class="nt">&lt;subcommands/&gt;</span>
    <span class="nt">&lt;options&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">name=</span><span class="s">&quot;--help&quot;</span> <span class="na">short=</span><span class="s">&quot;-h&quot;</span> <span class="na">boolean=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;default/&gt;</span>
            <span class="nt">&lt;choices/&gt;</span>
        <span class="nt">&lt;/option&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">name=</span><span class="s">&quot;--verbose&quot;</span> <span class="na">short=</span><span class="s">&quot;-v&quot;</span> <span class="na">boolean=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;default/&gt;</span>
            <span class="nt">&lt;choices/&gt;</span>
        <span class="nt">&lt;/option&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">name=</span><span class="s">&quot;--quiet&quot;</span> <span class="na">short=</span><span class="s">&quot;-q&quot;</span> <span class="na">boolean=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;default/&gt;</span>
            <span class="nt">&lt;choices/&gt;</span>
        <span class="nt">&lt;/option&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">name=</span><span class="s">&quot;--count&quot;</span> <span class="na">short=</span><span class="s">&quot;-n&quot;</span> <span class="na">boolean=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;default&gt;</span>10<span class="nt">&lt;/default&gt;</span>
            <span class="nt">&lt;choices/&gt;</span>
        <span class="nt">&lt;/option&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">name=</span><span class="s">&quot;--connection&quot;</span> <span class="na">short=</span><span class="s">&quot;-c&quot;</span> <span class="na">boolean=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;default&gt;</span>default<span class="nt">&lt;/default&gt;</span>
            <span class="nt">&lt;choices/&gt;</span>
        <span class="nt">&lt;/option&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">name=</span><span class="s">&quot;--plugin&quot;</span> <span class="na">short=</span><span class="s">&quot;-p&quot;</span> <span class="na">boolean=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;default/&gt;</span>
            <span class="nt">&lt;choices/&gt;</span>
        <span class="nt">&lt;/option&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">name=</span><span class="s">&quot;--records&quot;</span> <span class="na">short=</span><span class="s">&quot;-r&quot;</span> <span class="na">boolean=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;default/&gt;</span>
            <span class="nt">&lt;choices/&gt;</span>
        <span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;/options&gt;</span>
    <span class="nt">&lt;arguments&gt;</span>
        <span class="nt">&lt;argument</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span> <span class="na">help=</span><span class="s">&quot;Name of the fixture to bake.</span>
<span class="s">            Can use Plugin.name to bake plugin fixtures.&quot;</span> <span class="na">required=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;choices/&gt;</span>
        <span class="nt">&lt;/argument&gt;</span>
    <span class="nt">&lt;/arguments&gt;</span>
<span class="nt">&lt;/shell&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="shell-api">
<h2>Shell API<a class="headerlink" href="#shell-api" title="永久链接至标题">¶</a></h2>
<dl class="class">
<dt id="AppShell">
<em class="property">class </em><tt class="descname">AppShell</tt><a class="headerlink" href="#AppShell" title="永久链接至目标">¶</a></dt>
<dd><p>AppShell can be used as a base class for all your shells. It should extend
<a class="reference internal" href="#Shell" title="Shell"><tt class="xref php php-class docutils literal"><span class="pre">Shell</span></tt></a>, and be located in <tt class="docutils literal"><span class="pre">Console/Command/AppShell.php</span></tt></p>
</dd></dl>

<dl class="class">
<dt id="Shell">
<em class="property">class </em><tt class="descname">Shell</tt><big>(</big><em>$stdout = null</em>, <em>$stderr = null</em>, <em>$stdin = null</em><big>)</big><a class="headerlink" href="#Shell" title="永久链接至目标">¶</a></dt>
<dd><p>Shell is the base class for all shells, and provides a number of functions for
interacting with user input, outputting text a generating errors.</p>
</dd></dl>

<dl class="attr">
<dt id="Shell::$tasks">
<em class="property">property </em><tt class="descclassname">Shell::$</tt><tt class="descname">tasks</tt><a class="headerlink" href="#Shell::$tasks" title="永久链接至目标">¶</a></dt>
<dd><p>An array of tasks you want loaded for this shell/task.</p>
</dd></dl>

<dl class="attr">
<dt id="Shell::$uses">
<em class="property">property </em><tt class="descclassname">Shell::$</tt><tt class="descname">uses</tt><a class="headerlink" href="#Shell::$uses" title="永久链接至目标">¶</a></dt>
<dd><p>An array of models that should be loaded for this shell/task.</p>
</dd></dl>

<dl class="method">
<dt id="Shell::clear">
<tt class="descclassname">Shell::</tt><tt class="descname">clear</tt><big>(</big><big>)</big><a class="headerlink" href="#Shell::clear" title="永久链接至目标">¶</a></dt>
<dd><p>Clears the current output being displayed.</p>
</dd></dl>

<dl class="method">
<dt id="Shell::createFile">
<tt class="descclassname">Shell::</tt><tt class="descname">createFile</tt><big>(</big><em>$path</em>, <em>$contents</em><big>)</big><a class="headerlink" href="#Shell::createFile" title="永久链接至目标">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">参数:</th><td class="field-body"><ul class="first last simple">
<li><strong>$path</strong> (<em>string</em>) &#8211; Absolute path to the file you want to create.</li>
<li><strong>$contents</strong> (<em>string</em>) &#8211; Contents to put in the file.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Creates a file at a given path.  If the Shell is interactive, a warning will be
generated, and the user asked if they want to overwrite the file if it already exists.
If the shell&#8217;s interactive property is false, no question will be asked and the file
will simply be overwritten.</p>
</dd></dl>

<dl class="method">
<dt id="Shell::dispatchShell">
<tt class="descclassname">Shell::</tt><tt class="descname">dispatchShell</tt><big>(</big><big>)</big><a class="headerlink" href="#Shell::dispatchShell" title="永久链接至目标">¶</a></dt>
<dd><p>Dispatch a command to another Shell. Similar to
<a class="reference internal" href="controllers.html#Controller::requestAction" title="Controller::requestAction"><tt class="xref php php-meth docutils literal"><span class="pre">Controller::requestAction()</span></tt></a> but intended for running shells
from other shells.</p>
<p>See <a class="reference internal" href="#invoking-other-shells-from-your-shell"><em>Invoking other shells from your shell</em></a>.</p>
</dd></dl>

<dl class="method">
<dt id="Shell::err">
<tt class="descclassname">Shell::</tt><tt class="descname">err</tt><big>(</big><em>$message = null</em>, <em>$newlines = 1</em><big>)</big><a class="headerlink" href="#Shell::err" title="永久链接至目标">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">参数:</th><td class="field-body"><ul class="first last simple">
<li><strong>$method</strong> (<em>string</em>) &#8211; The message to print.</li>
<li><strong>$newlines</strong> (<em>integer</em>) &#8211; The number of newlines to follow the message.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Outputs a method to <tt class="docutils literal"><span class="pre">stderr</span></tt>, works similar to <a class="reference internal" href="#Shell::out" title="Shell::out"><tt class="xref php php-meth docutils literal"><span class="pre">Shell::out()</span></tt></a></p>
</dd></dl>

<dl class="method">
<dt id="Shell::error">
<tt class="descclassname">Shell::</tt><tt class="descname">error</tt><big>(</big><em>$title</em>, <em>$message = null</em><big>)</big><a class="headerlink" href="#Shell::error" title="永久链接至目标">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">参数:</th><td class="field-body"><ul class="first last simple">
<li><strong>$title</strong> (<em>string</em>) &#8211; Title of the error</li>
<li><strong>$message</strong> (<em>string</em>) &#8211; An optional error message</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Displays a formatted error message and exits the application with status
code 1</p>
</dd></dl>

<dl class="method">
<dt id="Shell::getOptionParser">
<tt class="descclassname">Shell::</tt><tt class="descname">getOptionParser</tt><big>(</big><big>)</big><a class="headerlink" href="#Shell::getOptionParser" title="永久链接至目标">¶</a></dt>
<dd><p>Should return a <a class="reference internal" href="#ConsoleOptionParser" title="ConsoleOptionParser"><tt class="xref php php-class docutils literal"><span class="pre">ConsoleOptionParser</span></tt></a> object, with any
sub-parsers for the shell.</p>
</dd></dl>

<dl class="method">
<dt id="Shell::hasMethod">
<tt class="descclassname">Shell::</tt><tt class="descname">hasMethod</tt><big>(</big><em>$name</em><big>)</big><a class="headerlink" href="#Shell::hasMethod" title="永久链接至目标">¶</a></dt>
<dd><p>Check to see if this shell has a callable method by the given name.</p>
</dd></dl>

<dl class="method">
<dt id="Shell::hasTask">
<tt class="descclassname">Shell::</tt><tt class="descname">hasTask</tt><big>(</big><em>$task</em><big>)</big><a class="headerlink" href="#Shell::hasTask" title="永久链接至目标">¶</a></dt>
<dd><p>Check to see if this shell has a task with the provided name.</p>
</dd></dl>

<dl class="method">
<dt id="Shell::hr">
<tt class="descclassname">Shell::</tt><tt class="descname">hr</tt><big>(</big><em>$newlines = 0</em>, <em>$width = 63</em><big>)</big><a class="headerlink" href="#Shell::hr" title="永久链接至目标">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">参数:</th><td class="field-body"><ul class="first last simple">
<li><strong>$newlines</strong> (<em>int</em>) &#8211; The number of newlines to precede and follow the line.</li>
<li><strong>$width</strong> (<em>int</em>) &#8211; The width of the line to draw.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Create a horizontal line preceded and followed by a number of newlines.</p>
</dd></dl>

<dl class="method">
<dt id="Shell::in">
<tt class="descclassname">Shell::</tt><tt class="descname">in</tt><big>(</big><em>$prompt</em>, <em>$options = null</em>, <em>$default = null</em><big>)</big><a class="headerlink" href="#Shell::in" title="永久链接至目标">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">参数:</th><td class="field-body"><ul class="first last simple">
<li><strong>$prompt</strong> (<em>string</em>) &#8211; The prompt to display to the user.</li>
<li><strong>$options</strong> (<em>array</em>) &#8211; An array of valid choices the user can pick from.
Picking an invalid option will force the user to choose again.</li>
<li><strong>$default</strong> (<em>string</em>) &#8211; The default option if there is one.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>This method helps you interact with the user, and create interactive shells.
It will return the users answer to the prompt, and allows you to provide a
list of valid options the user can choose from:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$selection</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">in</span><span class="p">(</span><span class="s1">&#39;Red or Green?&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span> <span class="s1">&#39;R&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>The selection validation is case-insensitive.</p>
</dd></dl>

<dl class="method">
<dt id="Shell::initialize">
<tt class="descclassname">Shell::</tt><tt class="descname">initialize</tt><big>(</big><big>)</big><a class="headerlink" href="#Shell::initialize" title="永久链接至目标">¶</a></dt>
<dd><p>Initializes the Shell acts as constructor for subclasses allows
configuration of tasks prior to shell execution.</p>
</dd></dl>

<dl class="method">
<dt id="Shell::loadTasks">
<tt class="descclassname">Shell::</tt><tt class="descname">loadTasks</tt><big>(</big><big>)</big><a class="headerlink" href="#Shell::loadTasks" title="永久链接至目标">¶</a></dt>
<dd><p>Loads tasks defined in public <a class="reference internal" href="#Shell::$tasks" title="Shell::$tasks"><tt class="xref php php-attr docutils literal"><span class="pre">Shell::$tasks</span></tt></a></p>
</dd></dl>

<dl class="method">
<dt id="Shell::nl">
<tt class="descclassname">Shell::</tt><tt class="descname">nl</tt><big>(</big><em>$multiplier = 1</em><big>)</big><a class="headerlink" href="#Shell::nl" title="永久链接至目标">¶</a></dt>
<dd><p>:param int $multiplier Number of times the linefeed sequence should be repeated</p>
<p>Returns a number of linefeed sequences.</p>
</dd></dl>

<dl class="method">
<dt id="Shell::out">
<tt class="descclassname">Shell::</tt><tt class="descname">out</tt><big>(</big><em>$message = null</em>, <em>$newlines = 1</em>, <em>$level = Shell::NORMAL</em><big>)</big><a class="headerlink" href="#Shell::out" title="永久链接至目标">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">参数:</th><td class="field-body"><ul class="first last simple">
<li><strong>$method</strong> (<em>string</em>) &#8211; The message to print.</li>
<li><strong>$newlines</strong> (<em>integer</em>) &#8211; The number of newlines to follow the message.</li>
<li><strong>$level</strong> (<em>integer</em>) &#8211; The highest <a class="reference internal" href="#shell-output-level"><em>Console output levels</em></a> this message
should display at.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The primary method for generating output to the user. By using levels, you
can limit how verbose a shell is.  out() also allows you to use colour formatting
tags, which will enable coloured output on systems that support it.  There are
several built in styles for colouring text, and you can define your own.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">error</span></tt> Error messages.</li>
<li><tt class="docutils literal"><span class="pre">warning</span></tt> Warning messages.</li>
<li><tt class="docutils literal"><span class="pre">info</span></tt> Informational messages.</li>
<li><tt class="docutils literal"><span class="pre">comment</span></tt> Additional text.</li>
<li><tt class="docutils literal"><span class="pre">question</span></tt> Magenta text used for user prompts</li>
</ul>
<p>By formatting messages with style tags you can display styled output:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">out</span><span class="p">(</span><span class="s1">&#39;&lt;warning&gt;This will remove data from the filesystems.&lt;/warning&gt;&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>By default on *nix systems ConsoleOutput objects default to colour output.
On windows systems, plain output is the default unless the <tt class="docutils literal"><span class="pre">ANSICON</span></tt> environment
variable is present.</p>
</dd></dl>

<dl class="method">
<dt id="Shell::runCommand">
<tt class="descclassname">Shell::</tt><tt class="descname">runCommand</tt><big>(</big><em>$command</em>, <em>$argv</em><big>)</big><a class="headerlink" href="#Shell::runCommand" title="永久链接至目标">¶</a></dt>
<dd><p>Runs the Shell with the provided argv.</p>
<p>Delegates calls to Tasks and resolves methods inside the class. Commands
are looked up with the following order:</p>
<ul class="simple">
<li>Method on the shell.</li>
<li>Matching task name.</li>
<li>main() method.</li>
</ul>
<p>If a shell implements a main() method, all missing method calls will be
sent to main() with the original method name in the argv.</p>
</dd></dl>

<dl class="method">
<dt id="Shell::shortPath">
<tt class="descclassname">Shell::</tt><tt class="descname">shortPath</tt><big>(</big><em>$file</em><big>)</big><a class="headerlink" href="#Shell::shortPath" title="永久链接至目标">¶</a></dt>
<dd><p>Makes absolute file path easier to read.</p>
</dd></dl>

<dl class="method">
<dt id="Shell::startup">
<tt class="descclassname">Shell::</tt><tt class="descname">startup</tt><big>(</big><big>)</big><a class="headerlink" href="#Shell::startup" title="永久链接至目标">¶</a></dt>
<dd><p>Starts up the Shell and displays the welcome message. Allows for checking
and configuring prior to command or main execution.</p>
<p>Override this method if you want to remove the welcome information, or
otherwise modify the pre-command flow.</p>
</dd></dl>

<dl class="method">
<dt id="Shell::wrapText">
<tt class="descclassname">Shell::</tt><tt class="descname">wrapText</tt><big>(</big><em>$text</em>, <em>$options = array()</em><big>)</big><a class="headerlink" href="#Shell::wrapText" title="永久链接至目标">¶</a></dt>
<dd><p>Wrap a block of text. Allows you to set the width, and indenting on a
block of text.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">参数:</th><td class="field-body"><ul class="first last simple">
<li><strong>$text</strong> (<em>string</em>) &#8211; The text to format</li>
<li><strong>$options</strong> (<em>array</em>) &#8211; <ul>
<li><tt class="docutils literal"><span class="pre">width</span></tt> The width to wrap to. Defaults to 72</li>
<li><tt class="docutils literal"><span class="pre">wordWrap</span></tt> Only wrap on words breaks (spaces) Defaults to true.</li>
<li><tt class="docutils literal"><span class="pre">indent</span></tt> Indent the text with the string provided. Defaults to null.</li>
</ul>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="more-topics">
<h2>More topics<a class="headerlink" href="#more-topics" title="永久链接至标题">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="console-and-shells/cron-jobs.html">定期运行Shells</a></li>
<li class="toctree-l1"><a class="reference internal" href="console-and-shells/code-generation-with-bake.html">使用 Bake 来生成代码</a></li>
<li class="toctree-l1"><a class="reference internal" href="console-and-shells/schema-management-and-migrations.html">Schema管理和迁移</a></li>
<li class="toctree-l1"><a class="reference internal" href="console-and-shells/i18n-shell.html">shell支持国际化I18N</a></li>
<li class="toctree-l1"><a class="reference internal" href="console-and-shells/acl-shell.html">ACL Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="console-and-shells/testsuite-shell.html">Test shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="console-and-shells/upgrade-shell.html">升级 shell</a></li>
</ul>
</div>
</div>
</div>


		</div>
	</div>

	<div class="sidebar columns three pull-nine">
<div id="sidebar-navigation" class="hide-on-phones">
	<h2 class="hide-on-desktops">Table of Contents</h2>
	<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">欢迎</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">安装</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">入门指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="cakephp-overview.html">CakePHP 概述</a></li>
<li class="toctree-l1"><a class="reference internal" href="controllers.html">控制器</a></li>
<li class="toctree-l1"><a class="reference internal" href="views.html">视图</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">模型</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries.html">核心库</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">插件</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">命令行与Shells</a><ul>
<li class="toctree-l2"><a class="reference internal" href="console-and-shells/cron-jobs.html">定期运行Shells</a></li>
<li class="toctree-l2"><a class="reference internal" href="console-and-shells/code-generation-with-bake.html">使用 Bake 来生成代码</a></li>
<li class="toctree-l2"><a class="reference internal" href="console-and-shells/schema-management-and-migrations.html">Schema管理和迁移</a></li>
<li class="toctree-l2"><a class="reference internal" href="console-and-shells/i18n-shell.html">shell支持国际化I18N</a></li>
<li class="toctree-l2"><a class="reference internal" href="console-and-shells/acl-shell.html">ACL Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="console-and-shells/testsuite-shell.html">Test shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="console-and-shells/upgrade-shell.html">升级 shell</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="development.html">开发</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment.html">部署</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials-and-examples.html">教程 &amp; 实例</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">贡献</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendices.html">Appendices</a></li>
</ul>

</div>

<div class="page-contents">
	<h3>Page contents</h3>
	<ul>
<li><a class="reference internal" href="#">命令行与Shells</a><ul>
<li><a class="reference internal" href="#the-cakephp-console">The CakePHP console</a><ul>
<li><a class="reference internal" href="#adding-cake-to-your-system-path">Adding cake to your system path</a></li>
</ul>
</li>
<li><a class="reference internal" href="#shell-creating-a-shell">创建一个shell Creating a shell</a><ul>
<li><a class="reference internal" href="#using-models-in-your-shells">Using Models in your shells</a></li>
</ul>
</li>
<li><a class="reference internal" href="#shell-tasks">Shell tasks</a><ul>
<li><a class="reference internal" href="#loading-tasks-on-the-fly-with-taskcollection">Loading tasks on the fly with TaskCollection</a></li>
</ul>
</li>
<li><a class="reference internal" href="#invoking-other-shells-from-your-shell">Invoking other shells from your shell</a></li>
<li><a class="reference internal" href="#console-output-levels">Console output levels</a></li>
<li><a class="reference internal" href="#styling-output">Styling output</a><ul>
<li><a class="reference internal" href="#turning-off-colouring">Turning off colouring</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuring-options-and-generating-help">Configuring options and generating help</a><ul>
<li><a class="reference internal" href="#configuring-an-option-parser-with-the-fluent-interface">Configuring an option parser with the fluent interface</a></li>
<li><a class="reference internal" href="#adding-arguments">Adding arguments</a></li>
<li><a class="reference internal" href="#validating-arguments">Validating arguments</a></li>
<li><a class="reference internal" href="#adding-options">Adding Options</a></li>
<li><a class="reference internal" href="#validating-options">Validating options</a></li>
<li><a class="reference internal" href="#using-boolean-options">Using boolean options</a></li>
<li><a class="reference internal" href="#adding-subcommands">Adding subcommands</a></li>
<li><a class="reference internal" href="#building-a-consoleoptionparser-from-an-array">Building a ConsoleOptionParser from an array</a></li>
<li><a class="reference internal" href="#getting-help-from-shells">Getting help from shells</a></li>
<li><a class="reference internal" href="#getting-help-as-xml">Getting help as XML</a></li>
</ul>
</li>
<li><a class="reference internal" href="#shell-api">Shell API</a></li>
<li><a class="reference internal" href="#more-topics">More topics</a></li>
</ul>
</li>
</ul>

</div>
	</div>

</div>

<div class="content row">
	<ul class="related-pages inline">
	<li>
		<a href="genindex.html" title="总目录" accesskey="I">索引</a>
	</li>
	<li>
		<a href="console-and-shells/cron-jobs.html" title="定期运行Shells" accesskey="N">下一页</a>
	</li>
	<li>
		<a href="plugins/how-to-create-plugins.html" title="How To Create Plugins" accesskey="P">上一页</a>
	</li>
	</ul>
</div>

	<div class="footer-push"> </div>
</div>






<div class="footer">
	<div class="row">
		<div class="columns six offset-by-three contribute">
			<strong>Found an issue?</strong>
			Submit a correction on <a href="https://github.com/cakephp/docs">GitHub</a><br />
			<a href="http://book.cakephp.org/2.0/en/contributing/documentation.html">[ documentation on how to contribute ]</a>
		</div>
	</div>
	
	<div class="row">
		<div class="columns nine offset-by-three copyright">
					&copy; 版权所有 2014, Cake Software Foundation, Inc.
				最后更新于 Aug 30, 2015.
				Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.3.
		</div>
	</div>
</div>

<div id="nav-modal" class="reveal-modal"> </div>
<div id="inline-search-results"></div>
<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-743287-3']);
	_gaq.push(['_trackPageview']);
	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>
  </body>
</html>