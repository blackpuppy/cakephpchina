
<!DOCTYPE html>



<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="CakeEmail" lang="zh_CN" name="title" />
<meta content="sending mail,email sender,envelope sender,php class,database configuration,sending emails,meth,shells,smtp,transports,attributes,array,config,flexibility,php email,new email,sending email,models" lang="zh_CN" name="keywords" />

    <title>CakeEmail &mdash; CakePHP Cookbook 2.x 文档</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.x',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="../_static/app.js"></script>
    <script type="text/javascript" src="../_static/modernizr.foundation.js"></script>
    <script type="text/javascript" src="../_static/foundation.js"></script>
    <link rel="top" title="CakePHP Cookbook 2.x 文档" href="../index.html" />
    <link rel="up" title="工具" href="../core-libraries/toc-utilities.html" />
    <link rel="next" title="目录和文件 Folder &amp; File" href="file-folder.html" />
    <link rel="prev" title="缓存" href="../core-libraries/caching.html" />
<link href="../_static/favicon.ico" type="image/x-icon" rel="icon" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<link rel="alternate" hreflang="en" href="../../en/core-utility-libraries/email.html" /><link rel="alternate" hreflang="pt" href="../../pt/core-utility-libraries/email.html" /><link rel="alternate" hreflang="es" href="../../es/core-utility-libraries/email.html" /><link rel="alternate" hreflang="ja" href="../../ja/core-utility-libraries/email.html" /><link rel="alternate" hreflang="fr" href="../../fr/core-utility-libraries/email.html" />

<link rel="search" type="application/opensearchdescription+xml" title="CakePHP Book 2.x Search" href="../_static/opensearchdescription-book-2-x.xml">
<script type="text/javascript">
window.lang = "zh_CN";
</script>

  </head>
  <body>

<div id="container">

<div id="cakephp-global-navigation">
	<ul>
		<li class="main"><a href="http://cakephp.org">CakePHP</a></li>
		<li class="primary"><a href="#" class="empty">Downloads</a>
			<ul class="second-level">
				<li><a href="https://github.com/cakephp/cakephp/tags">Releases</a></li>
				<li><a href="http://pear.cakephp.org">Pear channel</a></li>
			</ul>
		</li>
		<li class="primary"><a href="#" class="empty">Documentation</a>
			<ul class="second-level">
				<li><a href="http://api.cakephp.org">API</a></li>
				<li><a href="http://book.cakephp.org">Book</a></li>
			</ul>
		</li>
		<li class="primary"><a href="http://community.cakephp.org">Community</a>
			<ul class="second-level">
				<li><a href="http://webchat.freenode.net/?channels=cakephp&uio=MT1mYWxzZSY5PXRydWUmMTE9MjQ2b8">Help &amp; Support</a></li>
				<li><a href="https://github.com/cakephp/cakephp/issues">Issues</a></li>
				<li><a href="http://bakery.cakephp.org">The Bakery</a></li>
				<li><a href="http://stackoverflow.com/tags/cakephp">Stack Overflow</a></li>
				<li><a href="http://www.facebook.com/groups/cake.community">Facebook Group</a></li>
				<li><a href="http://goo.gl/mSC0s">Google+ Community</a></li>
				<li><a href="http://www.youtube.com/user/CakePHP">YouTube Channel</a></li>
				<li><a href="http://podcast.cakephp.org">CakePHP Podcast</a></li>
				<li><a href="http://twitter.com/CakePHP">Follow us on Twitter</a></li>
				<li><a href="http://groups.google.com/group/cake-php">Google Group</a></li>
				<li><a href="http://github.com/cakephp/cakephp/contributors">Contributors</a></li>
				<li><a href="http://plugins.cakephp.org">Plugins &amp; Packages</a></li>
				<li><a href="http://community.cakephp.org/get-involved">Get Involved</a></li>
				<li><a href="http://community.cakephp.org/guidelines">Guidelines</a></li>
				<li><a href="http://cakefest.org">CakeFest</a></li>
				<li><a href="http://cakephp.org/logos">Logo</a></li>
			</ul>
		</li>
		<li class="primary"><a href="http://cakephp.org/services">Services</a>
			<ul class="second-level">
				<li><a href="http://certification.cakephp.org">Certification</a></li>
				<li><a href="http://cakephp.org/services/consultation">Consultation</a></li>
				<li><a href="http://cakephp.org/services/support">Support</a></li>
				<li><a href="http://training.cakephp.org">Training</a></li>
			</ul>
		</li>
	</ul>
</div>

<div class="masthead">
	<div class="header-backing"></div>
	<div class="searchbar row">
		<div class="columns three phone-one">
			<a class="logo" href="../contents.html">
			<img src="../_static/cake-logo.png" alt="CakePHP" width="70" />
			</a>
		</div>
		
<div id="searchbox" class="columns nine phone-three">

	<form id="searchform" class="search" action="../search.html" method="get">
		<input class="search-input" autocomplete="off" type="search" name="q" size="18" />
		<input class="search-submit search-big button red" type="submit" value="搜索" />
		<input type="hidden" name="check_keywords" value="yes" />
		<input type="hidden" name="area" value="default" />

		<a href="#" id="tablet-nav" class="show-on-phones pale button small">Nav</a>
	</form>

</div>
	</div>
</div>
<div class="breadcrumb-header">
	<div class="related row">
		<div class="columns three root-link">
			<a href="../contents.html">Cookbook 2.x</a>
		</div>
		<div class="columns nine">
			<ul class="inline breadcrumb">
			<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
				<a href="../core-libraries.html"  itemprop="url"><span itemprop="title">核心库</span></a>
			</li>
			<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
				<a href="../core-libraries/toc-utilities.html" accesskey="U" itemprop="url"><span itemprop="title">工具</span></a>
			</li>
			</ul>
			<div class="versions dropdown">
				<a href="#">2.x Book</a>
				<ul>
					<li><a href="http://book.cakephp.org/3.0/en">3.0 Book</a></li>
					<li><a href="http://book.cakephp.org/1.3/zh_CN/">1.3 Book</a></li>
					<li><a href="http://book.cakephp.org/1.2/zh_CN/">1.2 Book</a></li>
					<li><a href="http://book.cakephp.org/1.1/en">1.1 Book</a></li>
				</ul>
			</div>

			<div class="languages dropdown">
				<a href="#">zh_CN</a>

				<ul>
				
					<li><a href="../../en/core-utility-libraries/email.html">en</a></li>
				
					<li><a href="../../pt/core-utility-libraries/email.html">pt</a></li>
				
					<li><a href="../../es/core-utility-libraries/email.html">es</a></li>
				
					<li><a href="../../ja/core-utility-libraries/email.html">ja</a></li>
				
					<li><a href="../../fr/core-utility-libraries/email.html">fr</a></li>
				
					<li></li>
				
				</ul>
			</div>
		</div>
	</div>
</div>

<div class="content row">
	<div class="document columns nine push-three">
		<div class="body"><a class="button pale improve" href="https://github.com/cakephp/docs/edit/master/zh/core-utility-libraries/email.rst" target="_blank">Improve this Doc</a>
  <div class="section" id="cakeemail">
<h1>CakeEmail<a class="headerlink" href="#cakeemail" title="永久链接至标题">¶</a></h1>
<dl class="class">
<dt id="CakeEmail">
<em class="property">class </em><tt class="descname">CakeEmail</tt><big>(</big><em>mixed $config = null</em><big>)</big><a class="headerlink" href="#CakeEmail" title="永久链接至目标">¶</a></dt>
<dd></dd></dl>

<p><tt class="docutils literal"><span class="pre">CakeEmail</span></tt> 是用于发送邮件的新的类库，使用此类你可以在应用程序中的任何地方发送邮件。
除了可以在控制器中使用EmailComponent，也可以在Shell和模型中发送邮件。</p>
<p><tt class="docutils literal"><span class="pre">CakeEmail</span></tt> is a new class to send email. With this
class you can send email from any place of your application. In addition to
using the EmailComponent from your controller, you can also send mail from
Shells, and Models.</p>
<p>此类代替了:php:class:<cite>EmailComponent</cite> ，在发送邮件中提供了更加灵活的手段。
举例来说，你可以创建自己传输协议(transports)来发送邮件，而不必使用
smtp和mail协议。</p>
<p>This class replaces the <tt class="xref php php-class docutils literal"><span class="pre">EmailComponent</span></tt> and gives more flexibility
in sending emails. For example, you can create your own transports to send
email instead of using the provided smtp and mail.</p>
<div class="section" id="basic-usage">
<h2>基本用法 Basic usage<a class="headerlink" href="#basic-usage" title="永久链接至标题">¶</a></h2>
<p>首先,确保用 <a class="reference internal" href="app.html#App::uses" title="App::uses"><tt class="xref php php-meth docutils literal"><span class="pre">App::uses()</span></tt></a> 方法将类加载进来。</p>
<p>First of all, you should ensure the class is loaded using <a class="reference internal" href="app.html#App::uses" title="App::uses"><tt class="xref php php-meth docutils literal"><span class="pre">App::uses()</span></tt></a>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;CakeEmail&#39;</span><span class="p">,</span> <span class="s1">&#39;Network/Email&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>使用CakeEmail类和使用:php:class:<cite>EmailComponent</cite> 类似，不过此时必须要用方法而不是属性。
举例。</p>
<p>Using CakeEmail is similar to using <tt class="xref php php-class docutils literal"><span class="pre">EmailComponent</span></tt>. But instead of
using attributes you must use methods. Example:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$Email</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CakeEmail</span><span class="p">();</span>
<span class="nv">$Email</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;me@example.com&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;My Site&#39;</span><span class="p">));</span>
<span class="nv">$Email</span><span class="o">-&gt;</span><span class="na">to</span><span class="p">(</span><span class="s1">&#39;you@example.com&#39;</span><span class="p">);</span>
<span class="nv">$Email</span><span class="o">-&gt;</span><span class="na">subject</span><span class="p">(</span><span class="s1">&#39;About&#39;</span><span class="p">);</span>
<span class="nv">$Email</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">(</span><span class="s1">&#39;My message&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>为了简化操作，所有的这些设置(setter)方法返回的是类的实例，所以我们可以重写上面的代码，
改为连贯操作。</p>
<p>To simplify things, all of the setter methods return the instance of class.
You can re-write the above code as:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$Email</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CakeEmail</span><span class="p">();</span>
<span class="nv">$Email</span><span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;me@example.com&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;My Site&#39;</span><span class="p">))</span>
    <span class="o">-&gt;</span><span class="na">to</span><span class="p">(</span><span class="s1">&#39;you@example.com&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">subject</span><span class="p">(</span><span class="s1">&#39;About&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">send</span><span class="p">(</span><span class="s1">&#39;My message&#39;</span><span class="p">);</span>
</pre></div>
</div>
<div class="section" id="choosing-the-sender">
<h3>选择发件人 Choosing the sender<a class="headerlink" href="#choosing-the-sender" title="永久链接至标题">¶</a></h3>
<p>当代表其他人发送邮件最好使用Sender header去定义一个原始的发件人。也可以使用 <tt class="docutils literal"><span class="pre">sender()</span></tt>:</p>
<p>When sending email on behalf of other people it&#8217;s often a good idea to define the
original sender using the Sender header.  You can do so using <tt class="docutils literal"><span class="pre">sender()</span></tt>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$Email</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CakeEmail</span><span class="p">();</span>
<span class="nv">$Email</span><span class="o">-&gt;</span><span class="na">sender</span><span class="p">(</span><span class="s1">&#39;app@example.com&#39;</span><span class="p">,</span> <span class="s1">&#39;MyApp emailer&#39;</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p>当代表其他人发送邮件时设置邮件的发送者是个好办法。可以有效的防止邮件被退回的发生。</p>
<p class="last">It&#8217;s also a good idea to set the envelope sender when sending mail on another
person&#8217;s behalf.  This prevents them from getting any messages about
deliverability.</p>
</div>
</div>
</div>
<div class="section" id="configuration">
<h2>配置 Configuration<a class="headerlink" href="#configuration" title="永久链接至标题">¶</a></h2>
<p>与数据库配置相似，也有一个集中包含邮件配置信息的类。</p>
<p>Similar of database configuration, emails can have a class to centralize all the
configuration.</p>
<p>创建文件 <tt class="docutils literal"><span class="pre">app/Config/email.php</span></tt> 其中类名是 <tt class="docutils literal"><span class="pre">EmailConfig</span></tt>。
<tt class="docutils literal"><span class="pre">app/Config/email.php.default</span></tt> 是一个示例文件。</p>
<p>Create the file <tt class="docutils literal"><span class="pre">app/Config/email.php</span></tt> with the class <tt class="docutils literal"><span class="pre">EmailConfig</span></tt>.
The <tt class="docutils literal"><span class="pre">app/Config/email.php.default</span></tt> has an example of this file.</p>
<p><tt class="docutils literal"><span class="pre">CakeEmail</span></tt> 会创建一个 <tt class="docutils literal"><span class="pre">EmailConfig</span></tt> 类的实例来访问配置信息。
如果你有动态数据要在配置文件中使用，可以使用构造函数。</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="sb">``</span><span class="nx">CakeEmail</span><span class="sb">``</span> <span class="nx">will</span> <span class="nx">create</span> <span class="nx">an</span> <span class="nx">instance</span> <span class="nx">of</span> <span class="nx">the</span> <span class="sb">``</span><span class="nx">EmailConfig</span><span class="sb">``</span> <span class="k">class</span> <span class="nc">to</span> <span class="nx">access</span> <span class="nx">the</span>
</pre></div>
</div>
<p>config. If you have dynamic data to put in the configs, you can use the
constructor to do that:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">class</span> <span class="nc">EmailConfig</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// Do conditional assignments here.</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>创建 <tt class="docutils literal"><span class="pre">app/Config/email.php</span></tt> 不是必须的，<tt class="docutils literal"><span class="pre">CakeEmail</span></tt> 可以不使用配置文件而是通过
各自的方法来分别设置配置信息或者加载一个包含配置信息的数组。</p>
<p>It is not required to create <tt class="docutils literal"><span class="pre">app/Config/email.php</span></tt>, <tt class="docutils literal"><span class="pre">CakeEmail</span></tt> can be used
without it and use respective methods to set all configurations separately or
load an array of configs.</p>
<p>使用 <tt class="docutils literal"><span class="pre">config()</span></tt> 方法从 <tt class="docutils literal"><span class="pre">EmailConfig</span></tt> 加载配置信息，或把他传递给 <tt class="docutils literal"><span class="pre">CakeEmail</span></tt>
的构造函数。</p>
<p>To load a config from <tt class="docutils literal"><span class="pre">EmailConfig</span></tt> you can use the <tt class="docutils literal"><span class="pre">config()</span></tt> method or pass it
to the constructor of <tt class="docutils literal"><span class="pre">CakeEmail</span></tt>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$Email</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CakeEmail</span><span class="p">();</span>
<span class="nv">$Email</span><span class="o">-&gt;</span><span class="na">config</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">);</span>

<span class="c1">//or in constructor::</span>
<span class="nv">$Email</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CakeEmail</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>如果不传递匹配 <tt class="docutils literal"><span class="pre">EmailConfig</span></tt> 文件中配置名的字符串。同样可以传入一个配置信息的数组。:</p>
<p>Instead of passing a string which matches the configuration name in <tt class="docutils literal"><span class="pre">EmailConfig</span></tt>
you can also just load an array of configs:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$Email</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CakeEmail</span><span class="p">();</span>
<span class="nv">$Email</span><span class="o">-&gt;</span><span class="na">config</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;from&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;me@example.org&#39;</span><span class="p">,</span> <span class="s1">&#39;transport&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;MyCustom&#39;</span><span class="p">));</span>

<span class="c1">//或者写在构造函数中 ::</span>
<span class="nv">$Email</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CakeEmail</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;from&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;me@example.org&#39;</span><span class="p">,</span> <span class="s1">&#39;transport&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;MyCustom&#39;</span><span class="p">));</span>
</pre></div>
</div>
<p>如果用的Gmail，需要配置SSL SMTP服务器。在host主机前加上 <tt class="docutils literal"><span class="pre">'ssl://'</span></tt> 和相应的端口。举例。:</p>
<p>You can configure SSL SMTP servers, like Gmail. To do so, put the <tt class="docutils literal"><span class="pre">'ssl://'</span></tt>
at prefix in the host and configure the port value accordingly.  Example:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">class</span> <span class="nc">EmailConfig</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$gmail</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;host&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ssl://smtp.gmail.com&#39;</span><span class="p">,</span>
        <span class="s1">&#39;port&#39;</span> <span class="o">=&gt;</span> <span class="mi">465</span><span class="p">,</span>
        <span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;my@gmail.com&#39;</span><span class="p">,</span>
        <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;secret&#39;</span><span class="p">,</span>
        <span class="s1">&#39;transport&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Smtp&#39;</span>
    <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p>使用此特性，需要在安装的PHP上有SSL配置。</p>
<p class="last">To use this feature, you will need to have the SSL configured in your PHP
install.</p>
</div>
<p>在2.3.0版本也可以使用 <tt class="docutils literal"><span class="pre">tls</span></tt> 选项来启用TLS SMTP。:</p>
<p>As of 2.3.0 you can also enable TLS SMTP using the <tt class="docutils literal"><span class="pre">tls</span></tt> option:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">class</span> <span class="nc">EmailConfig</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$gmail</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;host&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;smtp.gmail.com&#39;</span><span class="p">,</span>
        <span class="s1">&#39;port&#39;</span> <span class="o">=&gt;</span> <span class="mi">465</span><span class="p">,</span>
        <span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;my@gmail.com&#39;</span><span class="p">,</span>
        <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;secret&#39;</span><span class="p">,</span>
        <span class="s1">&#39;transport&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Smtp&#39;</span><span class="p">,</span>
        <span class="s1">&#39;tls&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span>
    <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>上面的配置会为邮件信息启用TLS通信</p>
<p>The above configuration would enable TLS communication for email messages.</p>
<div class="section" id="configurations">
<span id="email-configurations"></span><h3>配置 Configurations<a class="headerlink" href="#configurations" title="永久链接至标题">¶</a></h3>
<p>下面是配置数组的键名。
The following configuration keys are used:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">'from'</span></tt>: 发件人的邮件地址或包含多个的数组。 参见 <tt class="docutils literal"><span class="pre">CakeEmail::from()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'sender'</span></tt>: 真实发件人或包含多个的数组。 参见 <tt class="docutils literal"><span class="pre">CakeEmail::sender()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'to'</span></tt>: 收件人或包含多个的数组。参见 <tt class="docutils literal"><span class="pre">CakeEmail::to()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'cc'</span></tt>: 抄送人或包含多个的数组。参见 <tt class="docutils literal"><span class="pre">CakeEmail::cc()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'bcc'</span></tt>: 密件抄送人或包含多个的数组。参见 <tt class="docutils literal"><span class="pre">CakeEmail::bcc()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'replyTo'</span></tt>: 回复地址或包含多个的数组。参见 <tt class="docutils literal"><span class="pre">CakeEmail::replyTo()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'readReceipt'</span></tt>: 阅读收条或包含多个的数组。参见 <tt class="docutils literal"><span class="pre">CakeEmail::readReceipt()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'returnPath'</span></tt>: 遇到错误的邮件地址或包含多个的数组。参见 <tt class="docutils literal"><span class="pre">CakeEmail::returnPath()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'messageId'</span></tt>: 邮件的消息ID。参见 <tt class="docutils literal"><span class="pre">CakeEmail::messageId()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'subject'</span></tt>: 邮件的主题。参见 <tt class="docutils literal"><span class="pre">CakeEmail::subject()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'message'</span></tt>: 邮件的内容。如果使用渲染模版内容，不要设置此选项。</li>
<li><tt class="docutils literal"><span class="pre">'headers'</span></tt>: 邮件发送的消息头。参见 <tt class="docutils literal"><span class="pre">CakeEmail::setHeaders()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'viewRender'</span></tt>: 如果使用渲染内容，设置视图的类名。参见 <tt class="docutils literal"><span class="pre">CakeEmail::viewRender()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'template'</span></tt>: 如果使用渲染内容，设置模版名。参见 <tt class="docutils literal"><span class="pre">CakeEmail::template()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'theme'</span></tt>: 当渲染模版时使用的主题。参见 <tt class="docutils literal"><span class="pre">CakeEmail::theme()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'layout'</span></tt>: 如果使用渲染内容，设置布局，如果渲染一个不带布局的模版，设置为null。参见 <tt class="docutils literal"><span class="pre">CakeEmail::template()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'viewVars'</span></tt>: 如果使用渲染内容，可以传递变量数组运用在模版中。参见 <tt class="docutils literal"><span class="pre">CakeEmail::viewVars()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'attachments'</span></tt>: 附件列表。参见 <tt class="docutils literal"><span class="pre">CakeEmail::attachments()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'emailFormat'</span></tt>: 邮件格式(html, text 或都有). 参见 <tt class="docutils literal"><span class="pre">CakeEmail::emailFormat()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'transport'</span></tt>: 传输协议名称。参见 <tt class="docutils literal"><span class="pre">CakeEmail::transport()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'log'</span></tt>: 记录邮件头和消息的日志等级。<tt class="docutils literal"><span class="pre">true</span></tt> 会使用LOG_DEBUG。参见 <tt class="docutils literal"><span class="pre">CakeLog::write()</span></tt></li>
<li><tt class="docutils literal"><span class="pre">'from'</span></tt>: Email or array of sender. See <tt class="docutils literal"><span class="pre">CakeEmail::from()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'sender'</span></tt>: Email or array of real sender. See <tt class="docutils literal"><span class="pre">CakeEmail::sender()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'to'</span></tt>: Email or array of destination. See <tt class="docutils literal"><span class="pre">CakeEmail::to()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'cc'</span></tt>: Email or array of carbon copy. See <tt class="docutils literal"><span class="pre">CakeEmail::cc()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'bcc'</span></tt>: Email or array of blind carbon copy. See <tt class="docutils literal"><span class="pre">CakeEmail::bcc()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'replyTo'</span></tt>: Email or array to reply the e-mail. See <tt class="docutils literal"><span class="pre">CakeEmail::replyTo()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'readReceipt'</span></tt>: Email address or an array of addresses to receive the
receipt of read. See <tt class="docutils literal"><span class="pre">CakeEmail::readReceipt()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'returnPath'</span></tt>: Email address or and array of addresses to return if have
some error. See <tt class="docutils literal"><span class="pre">CakeEmail::returnPath()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'messageId'</span></tt>: Message ID of e-mail. See <tt class="docutils literal"><span class="pre">CakeEmail::messageId()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'subject'</span></tt>: Subject of the message. See <tt class="docutils literal"><span class="pre">CakeEmail::subject()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'message'</span></tt>: Content of message. Do not set this field if you are using rendered content.</li>
<li><tt class="docutils literal"><span class="pre">'headers'</span></tt>: Headers to be included. See <tt class="docutils literal"><span class="pre">CakeEmail::setHeaders()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'viewRender'</span></tt>: If you are using rendered content, set the view classname.
See <tt class="docutils literal"><span class="pre">CakeEmail::viewRender()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'template'</span></tt>: If you are using rendered content, set the template name. See
<tt class="docutils literal"><span class="pre">CakeEmail::template()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'theme'</span></tt>: Theme used when rendering template. See <tt class="docutils literal"><span class="pre">CakeEmail::theme()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'layout'</span></tt>: If you are using rendered content, set the layout to render. If
you want to render a template without layout, set this field to null. See
<tt class="docutils literal"><span class="pre">CakeEmail::template()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'viewVars'</span></tt>: If you are using rendered content, set the array with
variables to be used in the view. See <tt class="docutils literal"><span class="pre">CakeEmail::viewVars()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'attachments'</span></tt>: List of files to attach. See <tt class="docutils literal"><span class="pre">CakeEmail::attachments()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'emailFormat'</span></tt>: Format of email (html, text or both). See <tt class="docutils literal"><span class="pre">CakeEmail::emailFormat()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'transport'</span></tt>: Transport name. See <tt class="docutils literal"><span class="pre">CakeEmail::transport()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">'log'</span></tt>: Log level to log the email headers and message. <tt class="docutils literal"><span class="pre">true</span></tt> will use
LOG_DEBUG. See also <tt class="docutils literal"><span class="pre">CakeLog::write()</span></tt></li>
</ul>
<p>所有的配置都是可选的，除了 <tt class="docutils literal"><span class="pre">'from'</span></tt> 发件人。可以在这个数组中传入更多配置，该配置信息用在
<tt class="xref php php-meth docutils literal"><span class="pre">CakeEmail::config()方法`并传递给传输类``config()`</span></tt>。
举例，如果你正在使用smtp传输协议，应该传递主机名，端口和其他配置信息。</p>
<p>All these configurations are optional, except <tt class="docutils literal"><span class="pre">'from'</span></tt>. If you put more
configuration in this array, the configurations will be used in the
<tt class="xref php php-meth docutils literal"><span class="pre">CakeEmail::config()</span></tt> method and passed to the transport class <tt class="docutils literal"><span class="pre">config()</span></tt>.
For example, if you are using smtp transport, you should pass the host, port and
other configurations.</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<blockquote>
<div>上述键名中的键值将用在邮件或数组，比如from, to, cc等会被传递给相应方法的首个参数。
等价于``CakeEmail::from(<a class="reference external" href="mailto:'my&#37;&#52;&#48;example&#46;com">'my<span>&#64;</span>example<span>&#46;</span>com</a>&#8216;, &#8216;My Site&#8217;)``，在配置中这样的写法会被定义成
<tt class="docutils literal"><span class="pre">'from'</span> <span class="pre">=&gt;</span> <span class="pre">array('my&#64;example.com'</span> <span class="pre">=&gt;</span> <span class="pre">'My</span> <span class="pre">Site')</span></tt></div></blockquote>
<p class="last">The values of above keys using Email or array, like from, to, cc, etc will be passed
as first parameter of corresponding methods. The equivalent for:
<tt class="docutils literal"><span class="pre">CakeEmail::from('my&#64;example.com',</span> <span class="pre">'My</span> <span class="pre">Site')</span></tt>
would be defined as  <tt class="docutils literal"><span class="pre">'from'</span> <span class="pre">=&gt;</span> <span class="pre">array('my&#64;example.com'</span> <span class="pre">=&gt;</span> <span class="pre">'My</span> <span class="pre">Site')</span></tt> in your config</p>
</div>
<p>Setting headers
设置邮件头
&#8212;&#8212;&#8212;&#8212;&#8212;</p>
<p>在``CakeEmail``中可以随心所欲设置邮件头。当使用CakeEmail，不要忘了为头添加``X-<a href="#id1"><span class="problematic" id="id2">``</span></a>前缀。</p>
<p>In <tt class="docutils literal"><span class="pre">CakeEmail</span></tt> you are free to set whatever headers you want. When migrating
to use CakeEmail, do not forget to put the <tt class="docutils literal"><span class="pre">X-</span></tt> prefix in your headers.</p>
<p>See <tt class="docutils literal"><span class="pre">CakeEmail::setHeaders()</span></tt> and <tt class="docutils literal"><span class="pre">CakeEmail::addHeaders()</span></tt></p>
<p>Sending templated emails
发送模版邮件
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;</p>
<p>电子邮件通常不仅仅是一个简单的文本消息。CakePHP提供了一种发送邮件时使用CakePHP的视图层。
<a class="reference internal" href="../views.html"><em>view layer</em></a>。</p>
<p>Emails are often much more than just a simple text message.  In order
to facilitate that, CakePHP provides a way to send emails using CakePHP&#8217;s
<a class="reference internal" href="../views.html"><em>view layer</em></a>.</p>
<p>邮件模板位于应用程序``View``目录中一个特殊的目录中。邮件视图还可以使用布局、元素就像
普通视图:</p>
<p>The templates for emails reside in a special folder in your applications
<tt class="docutils literal"><span class="pre">View</span></tt> directory.  Email views can also use layouts, and elements just like
normal views:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$Email</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CakeEmail</span><span class="p">();</span>
<span class="nv">$Email</span><span class="o">-&gt;</span><span class="na">template</span><span class="p">(</span><span class="s1">&#39;welcome&#39;</span><span class="p">,</span> <span class="s1">&#39;fancy&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">emailFormat</span><span class="p">(</span><span class="s1">&#39;html&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">to</span><span class="p">(</span><span class="s1">&#39;bob@example.com&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;app@domain.com&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">send</span><span class="p">();</span>
</pre></div>
</div>
<p>上面的代码将``app/View/Emails/html/welcome.ctp``用于视图，将``app/View/Layouts/Emails/html/fancy.ctp``
用于布局。并且也能发送多个模版邮件内容。</p>
<p>The above would use <tt class="docutils literal"><span class="pre">app/View/Emails/html/welcome.ctp</span></tt> for the view,
and <tt class="docutils literal"><span class="pre">app/View/Layouts/Emails/html/fancy.ctp</span></tt> for the layout. You can
send multipart templated email messages as well:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$Email</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CakeEmail</span><span class="p">();</span>
<span class="nv">$Email</span><span class="o">-&gt;</span><span class="na">template</span><span class="p">(</span><span class="s1">&#39;welcome&#39;</span><span class="p">,</span> <span class="s1">&#39;fancy&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">emailFormat</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">to</span><span class="p">(</span><span class="s1">&#39;bob@example.com&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;app@domain.com&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">send</span><span class="p">();</span>
</pre></div>
</div>
<p>将使用下面的视图文件：
This would use the following view files:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">app/View/Emails/text/welcome.ctp</span></tt></li>
<li><tt class="docutils literal"><span class="pre">app/View/Layouts/Emails/text/fancy.ctp</span></tt></li>
<li><tt class="docutils literal"><span class="pre">app/View/Emails/html/welcome.ctp</span></tt></li>
<li><tt class="docutils literal"><span class="pre">app/View/Layouts/Emails/html/fancy.ctp</span></tt></li>
</ul>
<p>当发送模版邮件，邮件格式可选为``text``, <tt class="docutils literal"><span class="pre">html</span></tt> 或 <tt class="docutils literal"><span class="pre">both</span></tt>。
When sending templated emails you have the option of sending either
<tt class="docutils literal"><span class="pre">text</span></tt>, <tt class="docutils literal"><span class="pre">html</span></tt> or <tt class="docutils literal"><span class="pre">both</span></tt>.</p>
<blockquote>
<div><blockquote>
<div>还可通过``CakeEmail::viewVars()``设置视图中的变量:</div></blockquote>
<p>You can set view variables with <tt class="docutils literal"><span class="pre">CakeEmail::viewVars()</span></tt>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$Email</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CakeEmail</span><span class="p">(</span><span class="s1">&#39;templated&#39;</span><span class="p">);</span>
<span class="nv">$Email</span><span class="o">-&gt;</span><span class="na">viewVars</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;value&#39;</span> <span class="o">=&gt;</span> <span class="mi">12345</span><span class="p">));</span>
</pre></div>
</div>
</div></blockquote>
<p>传入变量后，在邮件模版中使用他们::
In your email templates you can use these with:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Here</span> <span class="nx">is</span> <span class="nx">your</span> <span class="nx">value</span><span class="o">:</span> <span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;&lt;?</span><span class="nx">php</span> <span class="k">echo</span> <span class="nv">$value</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&lt;/b&gt;&lt;/p&gt;</span>
</pre></div>
</div>
<p>也可以在邮件中使用助手，和普通视图文件一样。模型情况下只加载了 <a class="reference internal" href="../core-libraries/helpers/html.html#HtmlHelper" title="HtmlHelper"><tt class="xref php php-class docutils literal"><span class="pre">HtmlHelper</span></tt></a>。
可以使用``helpers()``方法加载额外的助手。</p>
<p>You can use helpers in emails as well, much like you can in normal view files.
By default only the <a class="reference internal" href="../core-libraries/helpers/html.html#HtmlHelper" title="HtmlHelper"><tt class="xref php php-class docutils literal"><span class="pre">HtmlHelper</span></tt></a> is loaded.  You can load additional
helpers using the <tt class="docutils literal"><span class="pre">helpers()</span></tt> method:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$Email</span><span class="o">-&gt;</span><span class="na">helpers</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;Html&#39;</span><span class="p">,</span> <span class="s1">&#39;Custom&#39;</span><span class="p">,</span> <span class="s1">&#39;Text&#39;</span><span class="p">));</span>
</pre></div>
</div>
<p>当设置助手一定要包括&#8217;Html&#8217;或将它从你的邮件模板助手中删除。
When setting helpers be sure to include &#8216;Html&#8217; or it will be removed from the
helpers loaded in your email template.</p>
<p>如果在插件内使用模版发送邮件，可以使用类似的:term:<cite>plugin syntax`插件语法。
If you want to send email using templates in a plugin you can use the familiar
:term:`plugin syntax</cite> to do so:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$Email</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CakeEmail</span><span class="p">();</span>
<span class="nv">$Email</span><span class="o">-&gt;</span><span class="na">template</span><span class="p">(</span><span class="s1">&#39;Blog.new_comment&#39;</span><span class="p">,</span> <span class="s1">&#39;Blog.auto_message&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>上面的例子会从博客插件使用模板。</p>
<p>The above would use templates from the Blog plugin as an example.</p>
<p>有些情况下，需要重写插件中提供的默认模版。可以通过告知CakeEmail使用``CakeEmail::theme()``
方法来使用合适的主题。</p>
<p>In some cases, you might need to override the default template provided by plugins.
You can do this using themes by telling CakeEmail to use appropriate theme using
<tt class="docutils literal"><span class="pre">CakeEmail::theme()</span></tt> method:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$Email</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CakeEmail</span><span class="p">();</span>
<span class="nv">$Email</span><span class="o">-&gt;</span><span class="na">template</span><span class="p">(</span><span class="s1">&#39;Blog.new_comment&#39;</span><span class="p">,</span> <span class="s1">&#39;Blog.auto_message&#39;</span><span class="p">);</span>
<span class="nv">$Email</span><span class="o">-&gt;</span><span class="na">theme</span><span class="p">(</span><span class="s1">&#39;TestTheme&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>无需修改这个博客插件。允许在主题中覆盖`new_comment`的模板,模板文件需要被创建在以下路径:
<tt class="docutils literal"><span class="pre">APP/View/Themed/TestTheme/Blog/Emails/text/new_comment.ctp</span></tt>。</p>
<p>This allows you to override the <cite>new_comment</cite> template in your theme without modifying
the Blog plugin.  The template file needs to be created in the following path:
<tt class="docutils literal"><span class="pre">APP/View/Themed/TestTheme/Blog/Emails/text/new_comment.ctp</span></tt>.</p>
</div>
<div class="section" id="sending-attachments">
<h3>发送附件 Sending attachments<a class="headerlink" href="#sending-attachments" title="永久链接至标题">¶</a></h3>
<dl class="method">
<dt id="CakeEmail::attachments">
<tt class="descclassname">CakeEmail::</tt><tt class="descname">attachments</tt><big>(</big><em>$attachments = null</em><big>)</big><a class="headerlink" href="#CakeEmail::attachments" title="永久链接至目标">¶</a></dt>
<dd></dd></dl>

<p>可以同时将文件附加到电子邮件消息。有一些不同的格式取决于你有什么样的文件,以及何种
文件名出现在收件人的邮件客户端:</p>
<p>You can attach files to email messages as well.  There are a few
different formats depending on what kind of files you have, and how
you want the filenames to appear in the recipient&#8217;s mail client:</p>
<ol class="arabic simple">
<li>字符串： <tt class="docutils literal"><span class="pre">$Email-&gt;attachments('/full/file/path/file.png')</span></tt> 将file.png作为附件名。</li>
<li>数组：<tt class="docutils literal"><span class="pre">$Email-&gt;attachments(array('/full/file/path/file.png')</span></tt> 和使用字符串效果一样。</li>
<li>带键名的数组：<tt class="docutils literal"><span class="pre">$Email-&gt;attachments(array('photo.png'</span> <span class="pre">=&gt;</span> <span class="pre">'/full/some_hash.png'))</span></tt> 将</li>
</ol>
<blockquote>
<div>some_hash.png作为附件，收件人看到的文件名为photo.png而不是some_hash.png。</div></blockquote>
<ol class="arabic" start="4">
<li><p class="first">嵌套数组：</p>
<blockquote>
<div><dl class="docutils">
<dt>$Email-&gt;attachments(array(</dt>
<dd><dl class="first docutils">
<dt>&#8216;photo.png&#8217; =&gt; array(</dt>
<dd><p class="first last">&#8216;file&#8217; =&gt; &#8216;/full/some_hash.png&#8217;,
&#8216;mimetype&#8217; =&gt; &#8216;image/png&#8217;,
&#8216;contentId&#8217; =&gt; &#8216;my-unique-id&#8217;</p>
</dd>
</dl>
<p class="last">)</p>
</dd>
</dl>
<p>));</p>
</div></blockquote>
</li>
</ol>
<p>指定附件文件的mimetype和contentId(当设置content ID附件会被转换成内联)，
mimetype和contentId是可选的。</p>
<ol class="arabic">
<li><p class="first">String: <tt class="docutils literal"><span class="pre">$Email-&gt;attachments('/full/file/path/file.png')</span></tt> will attach this
file with the name file.png.</p>
</li>
<li><p class="first">Array: <tt class="docutils literal"><span class="pre">$Email-&gt;attachments(array('/full/file/path/file.png')</span></tt> will have
the same behavior as using a string.</p>
</li>
<li><p class="first">Array with key:
<tt class="docutils literal"><span class="pre">$Email-&gt;attachments(array('photo.png'</span> <span class="pre">=&gt;</span> <span class="pre">'/full/some_hash.png'))</span></tt> will
attach some_hash.png with the name photo.png. The recipient will see
photo.png, not some_hash.png.</p>
</li>
<li><p class="first">Nested arrays:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$Email</span><span class="o">-&gt;</span><span class="na">attachments</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;photo.png&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;file&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;/full/some_hash.png&#39;</span><span class="p">,</span>
        <span class="s1">&#39;mimetype&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;image/png&#39;</span><span class="p">,</span>
        <span class="s1">&#39;contentId&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;my-unique-id&#39;</span>
    <span class="p">)</span>
<span class="p">));</span>
</pre></div>
</div>
<p>The above will attach the file with different mimetype and with custom
Content ID (when set the content ID the attachment is transformed to inline).
The mimetype and contentId are optional in this form.</p>
<p>4.1. 当使用``contentId``, 可以在html的内容体内使用文件，如
<tt class="docutils literal"><span class="pre">&lt;img</span> <span class="pre">src=&quot;cid:my-content-id&quot;&gt;</span></tt>。</p>
<p>4.2. 可以使用``contentDisposition``选项为附件禁用
<a href="#id3"><span class="problematic" id="id4">``</span></a>Content-Disposition``头。This is useful when
sending ical invites to clients using outlook.</p>
<p>4.1. When you are using the <tt class="docutils literal"><span class="pre">contentId</span></tt>, you can use the file in the html
body like <tt class="docutils literal"><span class="pre">&lt;img</span> <span class="pre">src=&quot;cid:my-content-id&quot;&gt;</span></tt>.</p>
<p>4.2. You can use the <tt class="docutils literal"><span class="pre">contentDisposition</span></tt> option to disable the
<tt class="docutils literal"><span class="pre">Content-Disposition</span></tt> header for an attachment.  This is useful when
sending ical invites to clients using outlook.</p>
</li>
</ol>
<div class="versionchanged">
<p><span class="versionmodified">在 2.3 版更改: </span>The <tt class="docutils literal"><span class="pre">contentDisposition</span></tt> option was added in 2.3</p>
</div>
<p>Using transports
使用传输协议
&#8212;&#8212;&#8212;&#8212;&#8212;-</p>
<p>Transports是通过某种协议或方法发送电子邮件的类。CakePHP支持Mail(默认)，Debug和Smtp传输协议。
Transports are classes designed to send the e-mail over some protocol or method.
CakePHP support the Mail (default), Debug and Smtp transports.</p>
<p>必须使用:php:meth:<cite>CakeEmail::transport()`方法配置传输协议。
To configure your method, you must use the :php:meth:`CakeEmail::transport()</cite>
method or have the transport in your configuration</p>
<p>Creating custom Transports
创建自定义传输协议
~~~~~~~~~~~~~~~~~~~~~~~~~~</p>
<p>你能够创建自定义transports来与其他电子邮件
系统进行交互(如SwiftMailer)。 创建您的transport,首先创建该文件
<a href="#id5"><span class="problematic" id="id6">``</span></a>app/Lib/Network/Email/ExampleTransport.php``(Example是你的创建您的transport名称)。
开始时你的文件应该像:</p>
<p>You are able to create your custom transports to integrate with others email
systems (like SwiftMailer). To create your transport, first create the file
<tt class="docutils literal"><span class="pre">app/Lib/Network/Email/ExampleTransport.php</span></tt> (where Example is the name of your
transport). To start off your file should look like:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;AbstractTransport&#39;</span><span class="p">,</span> <span class="s1">&#39;Network/Email&#39;</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">ExampleTransport</span> <span class="k">extends</span> <span class="nx">AbstractTransport</span> <span class="p">{</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">send</span><span class="p">(</span><span class="nx">CakeEmail</span> <span class="nv">$Email</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// magic inside!</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>你还要必须使用自定义逻辑实现方法``send(CakeEmail $Email)``。
可选地,可以实现``config($config)``方法。<a href="#id7"><span class="problematic" id="id8">``</span></a>config()``是
执行send()前调用,并允许您接受用户配置。默认情况下,
该方法将配置在protected属性``$_config``下。</p>
<p>You must implement the method <tt class="docutils literal"><span class="pre">send(CakeEmail</span> <span class="pre">$Email)</span></tt> with your custom logic.
Optionally, you can implement the <tt class="docutils literal"><span class="pre">config($config)</span></tt> method.  <tt class="docutils literal"><span class="pre">config()</span></tt> is
called before send() and allows you to accept user configurations. By default,
this method puts the configuration in protected attribute <tt class="docutils literal"><span class="pre">$_config</span></tt>.</p>
<p>如果你需要在transport中发送之前调用其他方法,可以使用
<tt class="xref php php-meth docutils literal"><span class="pre">CakeEmail::transportClass()</span></tt> 获得一个transport的实例。
例如:</p>
<p>If you need to call additional methods on the transport before send, you can use
<tt class="xref php php-meth docutils literal"><span class="pre">CakeEmail::transportClass()</span></tt> to get an instance of the transport.
Example:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$yourInstance</span> <span class="o">=</span> <span class="nv">$Email</span><span class="o">-&gt;</span><span class="na">transport</span><span class="p">(</span><span class="s1">&#39;your&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">transportClass</span><span class="p">();</span>
<span class="nv">$yourInstance</span><span class="o">-&gt;</span><span class="na">myCustomMethod</span><span class="p">();</span>
<span class="nv">$Email</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="sending-messages-quickly">
<h2>快速发送邮件 Sending messages quickly<a class="headerlink" href="#sending-messages-quickly" title="永久链接至标题">¶</a></h2>
<p>有时我们需要快速的发出去一封邮件，不需要先进行一系列的配置。
<tt class="xref php php-meth docutils literal"><span class="pre">CakeEmail::deliver()</span></tt> 可以满足这个目的。</p>
<p>Sometimes you need a quick way to fire off an email, and you don&#8217;t necessarily
want do setup a bunch of configuration ahead of time.
<tt class="xref php php-meth docutils literal"><span class="pre">CakeEmail::deliver()</span></tt> is intended for that purpose.</p>
<p>在 <tt class="docutils literal"><span class="pre">EmailConfig</span></tt> 中创建好配置文件，或者一个包含选项的数组，然后调用静态方法
<tt class="docutils literal"><span class="pre">CakeEmail::deliver()</span></tt> 。
举例:</p>
<p>You can create your configuration in <tt class="docutils literal"><span class="pre">EmailConfig</span></tt>, or use an array with all
options that you need and use the static method <tt class="docutils literal"><span class="pre">CakeEmail::deliver()</span></tt>.
Example:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nx">CakeEmail</span><span class="o">::</span><span class="na">deliver</span><span class="p">(</span><span class="s1">&#39;you@example.com&#39;</span><span class="p">,</span> <span class="s1">&#39;Subject&#39;</span><span class="p">,</span> <span class="s1">&#39;Message&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;from&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;me@example.com&#39;</span><span class="p">));</span>
</pre></div>
</div>
<p>此方法将发送一封邮件给you&#64;example.com，发件人是me&#64;example.com。主题内容分别是Subject和Message。</p>
<p>This method will send an email to <a class="reference external" href="mailto:you&#37;&#52;&#48;example&#46;com">you<span>&#64;</span>example<span>&#46;</span>com</a>, from <a class="reference external" href="mailto:me&#37;&#52;&#48;example&#46;com">me<span>&#64;</span>example<span>&#46;</span>com</a> with
subject Subject and content Message.</p>
<p><tt class="docutils literal"><span class="pre">deliver()</span></tt> 返回的是一个包含所有配置集合的 <a class="reference internal" href="#CakeEmail" title="CakeEmail"><tt class="xref php php-class docutils literal"><span class="pre">CakeEmail</span></tt></a> 实例。
如果不想立即发送邮件，想在发送前配置一些东西，在第5个参数中传入false。</p>
<p>The return of <tt class="docutils literal"><span class="pre">deliver()</span></tt> is a <a class="reference internal" href="#CakeEmail" title="CakeEmail"><tt class="xref php php-class docutils literal"><span class="pre">CakeEmail</span></tt></a> instance with all
configurations set.  If you do not want to send the email right away, and wish
to configure a few things before sending, you can pass the 5th parameter as
false.</p>
<p>第3个参数是消息内容或包含变量的数组(当使用了模版渲染内容)
The 3rd parameter is the content of message or an array with variables (when
using rendered content).</p>
<p>第4个参数是包含配置信息的数组或 <tt class="docutils literal"><span class="pre">EmailConfig</span></tt> 中一个配置名的字符串。</p>
<p>The 4th parameter can be an array with the configurations or a string with the
name of configuration in <tt class="docutils literal"><span class="pre">EmailConfig</span></tt>.</p>
<p>如果你想，可以传给主题和内容为null，在第4个参数中进行所有的配置(数组或使用 <tt class="docutils literal"><span class="pre">EmailConfig</span></tt>)。
到 <a class="reference internal" href="#email-configurations"><em>configurations</em></a> 查看可用的配置列表。</p>
<p>If you want, you can pass the to, subject and message as null and do all
configurations in the 4th parameter (as array or using <tt class="docutils literal"><span class="pre">EmailConfig</span></tt>).
Check the list of <a class="reference internal" href="#email-configurations"><em>configurations</em></a> to see all accepted configs.</p>
</div>
<div class="section" id="cli-sending-emails-from-cli">
<h2>从CLI发送邮件 Sending emails from CLI<a class="headerlink" href="#cli-sending-emails-from-cli" title="永久链接至标题">¶</a></h2>
<div class="versionchanged">
<p><span class="versionmodified">在 2.2 版更改: </span>The <tt class="docutils literal"><span class="pre">domain()</span></tt> method was added in 2.2</p>
</div>
<p>当通过一个CLI脚本(Shell,任务等)发送邮件，应该手动设置主机名让CakeEmail调用。
会为消息ID提供主机名(由于在CLI环境中没有主机名)</p>
<p>When sending emails within a CLI script (Shells, Tasks, ...) you should manually
set the domain name for CakeEmail to use. It will serve as the host name for the
message id (since there is no host name in a CLI environment):</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$Email</span><span class="o">-&gt;</span><span class="na">domain</span><span class="p">(</span><span class="s1">&#39;www.example.org&#39;</span><span class="p">);</span>
<span class="c1">// Results in message ids like ``&lt;UUID@www.example.org&gt;`` (valid)</span>
<span class="c1">// instead of `&lt;UUID@&gt;`` (invalid)</span>
</pre></div>
</div>
<p>一个有效的内容ID可以预防邮件最终被放到垃圾箱里。</p>
<p>A valid message id can help to prevent emails ending up in spam folders.</p>
</div>
</div>


		</div>
	</div>

	<div class="sidebar columns three pull-nine">
<div id="sidebar-navigation" class="hide-on-phones">
	<h2 class="hide-on-desktops">Table of Contents</h2>
	<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">欢迎</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">安装</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">入门指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cakephp-overview.html">CakePHP 概述</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers.html">控制器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../views.html">视图</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models.html">模型</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../core-libraries.html">核心库</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../core-libraries/toc-general-purpose.html">通用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core-libraries/toc-behaviors.html">行为</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core-libraries/toc-components.html">组件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core-libraries/toc-helpers.html">助件</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../core-libraries/toc-utilities.html">工具</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../core-libraries/caching.html">缓存</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="">CakeEmail</a></li>
<li class="toctree-l3"><a class="reference internal" href="file-folder.html">目录和文件 Folder &amp; File</a></li>
<li class="toctree-l3"><a class="reference internal" href="hash.html">Hash</a></li>
<li class="toctree-l3"><a class="reference internal" href="httpsocket.html">HttpSocket</a></li>
<li class="toctree-l3"><a class="reference internal" href="inflector.html">Inflector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core-libraries/internationalization-and-localization.html">Internationalization &amp; Localization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core-libraries/logging.html">日志记录</a></li>
<li class="toctree-l3"><a class="reference internal" href="number.html">CakeNumber</a></li>
<li class="toctree-l3"><a class="reference internal" href="router.html">Router</a></li>
<li class="toctree-l3"><a class="reference internal" href="sanitize.html">数据清理 Data Sanitization</a></li>
<li class="toctree-l3"><a class="reference internal" href="security.html">安全</a></li>
<li class="toctree-l3"><a class="reference internal" href="set.html">Set</a></li>
<li class="toctree-l3"><a class="reference internal" href="string.html">字符串 String</a></li>
<li class="toctree-l3"><a class="reference internal" href="time.html">CakeTime</a></li>
<li class="toctree-l3"><a class="reference internal" href="xml.html">Xml</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plugins.html">插件</a></li>
<li class="toctree-l1"><a class="reference internal" href="../console-and-shells.html">命令行与Shells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">开发</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment.html">部署</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials-and-examples.html">教程 &amp; 实例</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">贡献</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices.html">Appendices</a></li>
</ul>

</div>

<div class="page-contents">
	<h3>Page contents</h3>
	<ul>
<li><a class="reference internal" href="#">CakeEmail</a><ul>
<li><a class="reference internal" href="#basic-usage">基本用法 Basic usage</a><ul>
<li><a class="reference internal" href="#choosing-the-sender">选择发件人 Choosing the sender</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuration">配置 Configuration</a><ul>
<li><a class="reference internal" href="#configurations">配置 Configurations</a></li>
<li><a class="reference internal" href="#sending-attachments">发送附件 Sending attachments</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sending-messages-quickly">快速发送邮件 Sending messages quickly</a></li>
<li><a class="reference internal" href="#cli-sending-emails-from-cli">从CLI发送邮件 Sending emails from CLI</a></li>
</ul>
</li>
</ul>

</div>
	</div>

</div>

<div class="content row">
	<ul class="related-pages inline">
	<li>
		<a href="../genindex.html" title="总目录" accesskey="I">索引</a>
	</li>
	<li>
		<a href="file-folder.html" title="目录和文件 Folder &amp; File" accesskey="N">下一页</a>
	</li>
	<li>
		<a href="../core-libraries/caching.html" title="缓存" accesskey="P">上一页</a>
	</li>
	</ul>
</div>

	<div class="footer-push"> </div>
</div>






<div class="footer">
	<div class="row">
		<div class="columns six offset-by-three contribute">
			<strong>发现翻译错误?</strong>
			请在下面留言<br />
			<a href="https://github.com/blackpuppy/docs/wiki" target="_blank">[ 我要加入翻译 ]</a>
		</div>
	</div>
	
	<div class="row">
		<div class="columns nine offset-by-three copyright">
					&copy; 版权所有 2014, Cake Software Foundation, Inc.
				最后更新于 Sep 06, 2015.
				Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.3.
		</div>
	</div>
</div>

<div id="nav-modal" class="reveal-modal"> </div>
<div id="inline-search-results"></div>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F201cbc61deaf9f7ffb521fb23e83db40' type='text/javascript'%3E%3C/script%3E"));
</script>

<!-- Duoshuo Comment BEGIN -->
	<div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"cakephpchina"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0]
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- Duoshuo Comment END -->

<!-- Grunt Live Reload -->
<script src="http://192.168.56.113:35729/livereload.js"></script>
<script src="http://192.168.56.113:35730/livereload.js"></script>
  </body>
</html>