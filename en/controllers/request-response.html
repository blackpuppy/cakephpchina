
<!DOCTYPE html>



<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="Request and Response objects" lang="en" name="title" />
<meta content="request controller,request parameters,array indexes,purpose index,response objects,domain information,request object,request data,interrogating,params,previous versions,introspection,dispatcher,rout,data structures,arrays,ip address,migration,indexes,cakephp" lang="en" name="keywords" />

    <title>Request and Response objects &mdash; CakePHP Cookbook 2.x documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.x',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/app.js"></script>
    <script type="text/javascript" src="../_static/modernizr.foundation.js"></script>
    <script type="text/javascript" src="../_static/foundation.js"></script>
    <link rel="top" title="CakePHP Cookbook 2.x documentation" href="../index.html" />
    <link rel="up" title="Controllers" href="../controllers.html" />
    <link rel="next" title="Scaffolding" href="scaffolding.html" />
    <link rel="prev" title="Controllers" href="../controllers.html" />
<link href="../_static/favicon.ico" type="image/x-icon" rel="icon" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<link rel="alternate" hreflang="pt" href="../../pt/controllers/request-response.html" /><link rel="alternate" hreflang="es" href="../../es/controllers/request-response.html" /><link rel="alternate" hreflang="ja" href="../../ja/controllers/request-response.html" /><link rel="alternate" hreflang="fr" href="../../fr/controllers/request-response.html" /><link rel="alternate" hreflang="zh_CN" href="../../zh/controllers/request-response.html" />

<link rel="search" type="application/opensearchdescription+xml" title="CakePHP Book 2.x Search" href="../_static/opensearchdescription-book-2-x.xml">
<script type="text/javascript">
window.lang = "en";
</script>

  </head>
  <body>

<div id="container">

<div id="cakephp-global-navigation">
	<ul>
		<li class="main"><a href="http://cakephp.org">CakePHP</a></li>
		<li class="primary"><a href="#" class="empty">Downloads</a>
			<ul class="second-level">
				<li><a href="https://github.com/cakephp/cakephp/tags">Releases</a></li>
				<li><a href="http://pear.cakephp.org">Pear channel</a></li>
			</ul>
		</li>
		<li class="primary"><a href="#" class="empty">Documentation</a>
			<ul class="second-level">
				<li><a href="http://api.cakephp.org">API</a></li>
				<li><a href="http://book.cakephp.org">Book</a></li>
			</ul>
		</li>
		<li class="primary"><a href="http://community.cakephp.org">Community</a>
			<ul class="second-level">
				<li><a href="http://webchat.freenode.net/?channels=cakephp&uio=MT1mYWxzZSY5PXRydWUmMTE9MjQ2b8">Help &amp; Support</a></li>
				<li><a href="https://github.com/cakephp/cakephp/issues">Issues</a></li>
				<li><a href="http://bakery.cakephp.org">The Bakery</a></li>
				<li><a href="http://stackoverflow.com/tags/cakephp">Stack Overflow</a></li>
				<li><a href="http://www.facebook.com/groups/cake.community">Facebook Group</a></li>
				<li><a href="http://goo.gl/mSC0s">Google+ Community</a></li>
				<li><a href="http://www.youtube.com/user/CakePHP">YouTube Channel</a></li>
				<li><a href="http://podcast.cakephp.org">CakePHP Podcast</a></li>
				<li><a href="http://twitter.com/CakePHP">Follow us on Twitter</a></li>
				<li><a href="http://groups.google.com/group/cake-php">Google Group</a></li>
				<li><a href="http://github.com/cakephp/cakephp/contributors">Contributors</a></li>
				<li><a href="http://plugins.cakephp.org">Plugins &amp; Packages</a></li>
				<li><a href="http://community.cakephp.org/get-involved">Get Involved</a></li>
				<li><a href="http://community.cakephp.org/guidelines">Guidelines</a></li>
				<li><a href="http://cakefest.org">CakeFest</a></li>
				<li><a href="http://cakephp.org/logos">Logo</a></li>
			</ul>
		</li>
		<li class="primary"><a href="http://cakephp.org/services">Services</a>
			<ul class="second-level">
				<li><a href="http://cakephp.org/services/certification">Certification</a></li>
				<li><a href="http://cakephp.org/services/consultation">Consultation</a></li>
				<li><a href="http://cakephp.org/services/support">Support</a></li>
				<li><a href="http://training.cakephp.org">Training</a></li>
			</ul>
		</li>
	</ul>
</div>

<div class="masthead">
	<div class="header-backing"></div>
	<div class="searchbar row">
		<div class="columns three phone-one">
			<a class="logo" href="../contents.html">
			<img src="../_static/cake-logo.png" alt="CakePHP" width="70" />
			</a>
		</div>
		
<div id="searchbox" class="columns nine phone-three">

	<form id="searchform" class="search" action="../search.html" method="get">
		<input class="search-input" autocomplete="off" type="search" name="q" size="18" />
		<input class="search-submit search-big button red" type="submit" value="Search" />
		<input type="hidden" name="check_keywords" value="yes" />
		<input type="hidden" name="area" value="default" />

		<a href="#" id="tablet-nav" class="show-on-phones pale button small">Nav</a>
	</form>

</div>
	</div>
</div>
<div class="breadcrumb-header">
	<div class="related row">
		<div class="columns three root-link">
			<a href="../contents.html">Cookbook 2.x</a>
		</div>
		<div class="columns nine">
			<ul class="inline breadcrumb">
			<li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
				<a href="../controllers.html" accesskey="U" itemprop="url"><span itemprop="title">Controllers</span></a>
			</li>
			</ul>
			<div class="versions dropdown">
				<a href="#">2.x Book</a>
				<ul>
					<li><a href="http://book.cakephp.org/3.0/en">3.0 Book</a></li>
					<li><a href="http://book.cakephp.org/1.3/en/">1.3 Book</a></li>
					<li><a href="http://book.cakephp.org/1.2/en/">1.2 Book</a></li>
					<li><a href="http://book.cakephp.org/1.1/en">1.1 Book</a></li>
				</ul>
			</div>

			<div class="languages dropdown">
				<a href="#">en</a>

				<ul>
				
					<li></li>
				
					<li><a href="../../pt/controllers/request-response.html">pt</a></li>
				
					<li><a href="../../es/controllers/request-response.html">es</a></li>
				
					<li><a href="../../ja/controllers/request-response.html">ja</a></li>
				
					<li><a href="../../fr/controllers/request-response.html">fr</a></li>
				
					<li><a href="../../zh/controllers/request-response.html">zh_CN</a></li>
				
				</ul>
			</div>
		</div>
	</div>
</div>

<div class="content row">
	<div class="document columns nine push-three">
		<div class="body"><a class="button pale improve" href="https://github.com/cakephp/docs/edit/master/en/controllers/request-response.rst" target="_blank">Improve this Doc</a>
  <div class="section" id="request-and-response-objects">
<h1>Request and Response objects<a class="headerlink" href="#request-and-response-objects" title="Permalink to this headline">¶</a></h1>
<p>New in CakePHP 2.0 are request and response objects. In previous versions, these
objects were represented through arrays, and the related methods were spread
across <a class="reference internal" href="../core-libraries/components/request-handling.html#RequestHandlerComponent" title="RequestHandlerComponent"><tt class="xref php php-class docutils literal"><span class="pre">RequestHandlerComponent</span></tt></a>, <a class="reference internal" href="../development/routing.html#Router" title="Router"><tt class="xref php php-class docutils literal"><span class="pre">Router</span></tt></a>,
<tt class="xref php php-class docutils literal"><span class="pre">Dispatcher</span></tt> and <a class="reference internal" href="../controllers.html#Controller" title="Controller"><tt class="xref php php-class docutils literal"><span class="pre">Controller</span></tt></a>. There was no authoritative
object on what information the request contained. For 2.0,
<a class="reference internal" href="#CakeRequest" title="CakeRequest"><tt class="xref php php-class docutils literal"><span class="pre">CakeRequest</span></tt></a> and <a class="reference internal" href="#CakeResponse" title="CakeResponse"><tt class="xref php php-class docutils literal"><span class="pre">CakeResponse</span></tt></a> are used for this
purpose.</p>
</div>
<div class="section" id="cakerequest">
<span id="cake-request"></span><span id="index-0"></span><h1>CakeRequest<a class="headerlink" href="#cakerequest" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="#CakeRequest" title="CakeRequest"><tt class="xref php php-class docutils literal"><span class="pre">CakeRequest</span></tt></a> is the default request object used in CakePHP. It centralizes
a number of features for interrogating and interacting with request data.
On each request, one <a class="reference internal" href="#CakeRequest" title="CakeRequest"><tt class="xref php php-class docutils literal"><span class="pre">CakeRequest</span></tt></a> is created and then passed by reference to the various
layers of an application that use request data. By default, <a class="reference internal" href="#CakeRequest" title="CakeRequest"><tt class="xref php php-class docutils literal"><span class="pre">CakeRequest</span></tt></a> is assigned to
<tt class="docutils literal"><span class="pre">$this-&gt;request</span></tt>, and is available in Controllers, Views and Helpers. You can
also access it in Components by using the controller reference. Some of the duties
<a class="reference internal" href="#CakeRequest" title="CakeRequest"><tt class="xref php php-class docutils literal"><span class="pre">CakeRequest</span></tt></a> performs include:</p>
<ul class="simple">
<li>Process the GET, POST, and FILES arrays into the data structures you are
familiar with.</li>
<li>Provide environment introspection pertaining to the request. Things like the
headers sent, the client&#8217;s IP address, and the subdomain/domain information
about the application the server is running on.</li>
<li>Provide access to request parameters both as array indexes and object
properties.</li>
</ul>
<div class="section" id="accessing-request-parameters">
<h2>Accessing request parameters<a class="headerlink" href="#accessing-request-parameters" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="#CakeRequest" title="CakeRequest"><tt class="xref php php-class docutils literal"><span class="pre">CakeRequest</span></tt></a> exposes several interfaces for accessing request parameters. The first uses object
properties, the second uses array indexes, and the third uses <tt class="docutils literal"><span class="pre">$this-&gt;request-&gt;params</span></tt>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">controller</span><span class="p">;</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">[</span><span class="s1">&#39;controller&#39;</span><span class="p">];</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">params</span><span class="p">[</span><span class="s1">&#39;controller&#39;</span><span class="p">];</span>
</pre></div>
</div>
<p>All of the above will access the same value. Multiple ways of accessing the
parameters have been provided to ease migration for existing applications. All
<a class="reference internal" href="../development/routing.html#route-elements"><em>Route Elements</em></a> are accessed through this interface.</p>
<p>In addition to <a class="reference internal" href="../development/routing.html#route-elements"><em>Route Elements</em></a>, you also often need access to
<a class="reference internal" href="../development/routing.html#passed-arguments"><em>Passed Arguments</em></a> and <a class="reference internal" href="../development/routing.html#named-parameters"><em>Named Parameters</em></a>. These are both available
on the request object as well:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="c1">// Passed arguments</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">pass</span><span class="p">;</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">];</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">params</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">];</span>

<span class="c1">// named parameters</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">named</span><span class="p">;</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">[</span><span class="s1">&#39;named&#39;</span><span class="p">];</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">params</span><span class="p">[</span><span class="s1">&#39;named&#39;</span><span class="p">];</span>
</pre></div>
</div>
<p>All of these will provide you access to the passed arguments and named parameters. There
are several important/useful parameters that CakePHP uses internally. These
are also all found in the request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">plugin</span></tt> The plugin handling the request. Will be null when there is no plugin.</li>
<li><tt class="docutils literal"><span class="pre">controller</span></tt> The controller handling the current request.</li>
<li><tt class="docutils literal"><span class="pre">action</span></tt> The action handling the current request.</li>
<li><tt class="docutils literal"><span class="pre">prefix</span></tt> The prefix for the current action. See <a class="reference internal" href="../development/routing.html#prefix-routing"><em>Prefix Routing</em></a> for
more information.</li>
<li><tt class="docutils literal"><span class="pre">bare</span></tt> Present when the request came from <a class="reference internal" href="../controllers.html#Controller::requestAction" title="Controller::requestAction"><tt class="xref php php-meth docutils literal"><span class="pre">requestAction()</span></tt></a> and included the
bare option. Bare requests do not have layouts rendered.</li>
<li><tt class="docutils literal"><span class="pre">requested</span></tt> Present and set to true when the action came from <a class="reference internal" href="../controllers.html#Controller::requestAction" title="Controller::requestAction"><tt class="xref php php-meth docutils literal"><span class="pre">requestAction()</span></tt></a>.</li>
</ul>
</div>
<div class="section" id="accessing-querystring-parameters">
<h2>Accessing Querystring parameters<a class="headerlink" href="#accessing-querystring-parameters" title="Permalink to this headline">¶</a></h2>
<p>Querystring parameters can be read using <a class="reference internal" href="#CakeRequest::$query" title="CakeRequest::$query"><tt class="xref php php-attr docutils literal"><span class="pre">CakeRequest::$query</span></tt></a>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="c1">// URL is /posts/index?page=1&amp;sort=title</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">[</span><span class="s1">&#39;page&#39;</span><span class="p">];</span>

<span class="c1">// You can also access it via an array</span>
<span class="c1">// Note: BC accessor, will be deprecated in future versions</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">][</span><span class="s1">&#39;page&#39;</span><span class="p">];</span>
</pre></div>
</div>
<p>You can either directly access the <a class="reference internal" href="#CakeRequest::$query" title="CakeRequest::$query"><tt class="xref php php-attr docutils literal"><span class="pre">$query</span></tt></a> property, or you can use
<a class="reference internal" href="#CakeRequest::query" title="CakeRequest::query"><tt class="xref php php-meth docutils literal"><span class="pre">CakeRequest::query()</span></tt></a> to read the URL query array in an error-free manner.
Any keys that do not exist will return <tt class="docutils literal"><span class="pre">null</span></tt>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$foo</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;value_that_does_not_exist&#39;</span><span class="p">);</span>
<span class="c1">// $foo === null</span>
</pre></div>
</div>
</div>
<div class="section" id="accessing-post-data">
<h2>Accessing POST data<a class="headerlink" href="#accessing-post-data" title="Permalink to this headline">¶</a></h2>
<p>All POST data can be accessed using <a class="reference internal" href="#CakeRequest::$data" title="CakeRequest::$data"><tt class="xref php php-attr docutils literal"><span class="pre">CakeRequest::$data</span></tt></a>. Any form data
that contains a <tt class="docutils literal"><span class="pre">data</span></tt> prefix will have that data prefix removed. For example:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="c1">// An input with a name attribute equal to &#39;data[MyModel][title]&#39;</span>
<span class="c1">// is accessible at</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">[</span><span class="s1">&#39;MyModel&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">];</span>
</pre></div>
</div>
<p>You can either directly access the <a class="reference internal" href="#CakeRequest::$data" title="CakeRequest::$data"><tt class="xref php php-attr docutils literal"><span class="pre">$data</span></tt></a> property, or you can use
<a class="reference internal" href="#CakeRequest::data" title="CakeRequest::data"><tt class="xref php php-meth docutils literal"><span class="pre">CakeRequest::data()</span></tt></a> to read the data array in an error-free manner.
Any keys that do not exist will return <tt class="docutils literal"><span class="pre">null</span></tt>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$foo</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">(</span><span class="s1">&#39;Value.that.does.not.exist&#39;</span><span class="p">);</span>
<span class="c1">// $foo == null</span>
</pre></div>
</div>
</div>
<div class="section" id="accessing-put-or-post-data">
<h2>Accessing PUT or POST data<a class="headerlink" href="#accessing-put-or-post-data" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.2.</span></p>
</div>
<p>When building REST services, you often accept request data on <tt class="docutils literal"><span class="pre">PUT</span></tt> and
<tt class="docutils literal"><span class="pre">DELETE</span></tt> requests. As of 2.2, any <tt class="docutils literal"><span class="pre">application/x-www-form-urlencoded</span></tt>
request body data will automatically be parsed and set to <tt class="docutils literal"><span class="pre">$this-&gt;data</span></tt> for
<tt class="docutils literal"><span class="pre">PUT</span></tt> and <tt class="docutils literal"><span class="pre">DELETE</span></tt> requests. If you are accepting JSON or XML data, see
below for how you can access those request bodies.</p>
</div>
<div class="section" id="accessing-xml-or-json-data">
<h2>Accessing XML or JSON data<a class="headerlink" href="#accessing-xml-or-json-data" title="Permalink to this headline">¶</a></h2>
<p>Applications employing <a class="reference internal" href="../development/rest.html"><em>REST</em></a> often exchange data in non-URL-encoded
post bodies. You can read input data in any format using
<a class="reference internal" href="#CakeRequest::input" title="CakeRequest::input"><tt class="xref php php-meth docutils literal"><span class="pre">CakeRequest::input()</span></tt></a>. By providing a decoding function, you can
receive the content in a deserialized format:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="c1">// Get JSON encoded data submitted to a PUT/POST action</span>
<span class="nv">$data</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">input</span><span class="p">(</span><span class="s1">&#39;json_decode&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Some deserializing methods require additional parameters when called,
such as the &#8216;as array&#8217; parameter on <tt class="docutils literal"><span class="pre">json_decode</span></tt>. If you want XML converted
into a DOMDocument object, <a class="reference internal" href="#CakeRequest::input" title="CakeRequest::input"><tt class="xref php php-meth docutils literal"><span class="pre">CakeRequest::input()</span></tt></a> supports passing
in additional parameters as well:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="c1">// Get Xml encoded data submitted to a PUT/POST action</span>
<span class="nv">$data</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">input</span><span class="p">(</span><span class="s1">&#39;Xml::build&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;return&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;domdocument&#39;</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="section" id="accessing-path-information">
<h2>Accessing path information<a class="headerlink" href="#accessing-path-information" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="#CakeRequest" title="CakeRequest"><tt class="xref php php-class docutils literal"><span class="pre">CakeRequest</span></tt></a> also provides useful information about the paths in your
application. <a class="reference internal" href="#CakeRequest::$base" title="CakeRequest::$base"><tt class="xref php php-attr docutils literal"><span class="pre">CakeRequest::$base</span></tt></a> and
<a class="reference internal" href="#CakeRequest::$webroot" title="CakeRequest::$webroot"><tt class="xref php php-attr docutils literal"><span class="pre">CakeRequest::$webroot</span></tt></a> are useful for generating URLs, and
determining whether or not your application is in a subdirectory.</p>
</div>
<div class="section" id="inspecting-the-request">
<span id="check-the-request"></span><h2>Inspecting the request<a class="headerlink" href="#inspecting-the-request" title="Permalink to this headline">¶</a></h2>
<p>Detecting various request conditions used to require using
<a class="reference internal" href="../core-libraries/components/request-handling.html#RequestHandlerComponent" title="RequestHandlerComponent"><tt class="xref php php-class docutils literal"><span class="pre">RequestHandlerComponent</span></tt></a>. These methods have been moved to
<a class="reference internal" href="#CakeRequest" title="CakeRequest"><tt class="xref php php-class docutils literal"><span class="pre">CakeRequest</span></tt></a>, and offer a new interface alongside a more backwards-compatible
usage:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">);</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">isPost</span><span class="p">();</span> <span class="c1">// deprecated</span>
</pre></div>
</div>
<p>Both method calls will return the same value. For the time being, the methods
are still available on <a class="reference internal" href="../core-libraries/components/request-handling.html#RequestHandlerComponent" title="RequestHandlerComponent"><tt class="xref php php-class docutils literal"><span class="pre">RequestHandlerComponent</span></tt></a>, but are deprecated and
will be removed in 3.0.0. You can also easily extend the request
detectors that are available by using <a class="reference internal" href="#CakeRequest::addDetector" title="CakeRequest::addDetector"><tt class="xref php php-meth docutils literal"><span class="pre">CakeRequest::addDetector()</span></tt></a>
to create new kinds of detectors. There are four different types of detectors
that you can create:</p>
<ul class="simple">
<li>Environment value comparison - Compares a
value fetched from <a class="reference internal" href="../core-libraries/global-constants-and-functions.html#env" title="env"><tt class="xref php php-func docutils literal"><span class="pre">env()</span></tt></a> for equality
with the provided value.</li>
<li>Pattern value comparison - Pattern value comparison allows you to compare a
value fetched from <a class="reference internal" href="../core-libraries/global-constants-and-functions.html#env" title="env"><tt class="xref php php-func docutils literal"><span class="pre">env()</span></tt></a> to a regular expression.</li>
<li>Option based comparison -  Option based comparisons use a list of options to
create a regular expression. Subsequent calls to add an already defined
options detector will merge the options.</li>
<li>Callback detectors - Callback detectors allow you to provide a &#8216;callback&#8217; type
to handle the check. The callback will receive the request object as its only
parameter.</li>
</ul>
<p>Some examples would be:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="c1">// Add an environment detector.</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">addDetector</span><span class="p">(</span>
    <span class="s1">&#39;post&#39;</span><span class="p">,</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;env&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;REQUEST_METHOD&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;POST&#39;</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">// Add a pattern value detector.</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">addDetector</span><span class="p">(</span>
    <span class="s1">&#39;iphone&#39;</span><span class="p">,</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;env&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;HTTP_USER_AGENT&#39;</span><span class="p">,</span> <span class="s1">&#39;pattern&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;/iPhone/i&#39;</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">// Add an option detector.</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">addDetector</span><span class="p">(</span><span class="s1">&#39;internalIp&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;env&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;CLIENT_IP&#39;</span><span class="p">,</span>
    <span class="s1">&#39;options&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;192.168.0.101&#39;</span><span class="p">,</span> <span class="s1">&#39;192.168.0.100&#39;</span><span class="p">)</span>
<span class="p">));</span>

<span class="c1">// Add a callback detector. Can either be an anonymous function</span>
<span class="c1">// or a regular callable.</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">addDetector</span><span class="p">(</span>
    <span class="s1">&#39;awesome&#39;</span><span class="p">,</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;callback&#39;</span> <span class="o">=&gt;</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$request</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">awesome</span><span class="p">);</span>
    <span class="p">})</span>
<span class="p">);</span>
</pre></div>
</div>
<p><a class="reference internal" href="#CakeRequest" title="CakeRequest"><tt class="xref php php-class docutils literal"><span class="pre">CakeRequest</span></tt></a> also includes methods like <a class="reference internal" href="#CakeRequest::domain" title="CakeRequest::domain"><tt class="xref php php-meth docutils literal"><span class="pre">CakeRequest::domain()</span></tt></a>,
<a class="reference internal" href="#CakeRequest::subdomains" title="CakeRequest::subdomains"><tt class="xref php php-meth docutils literal"><span class="pre">CakeRequest::subdomains()</span></tt></a> and <a class="reference internal" href="#CakeRequest::host" title="CakeRequest::host"><tt class="xref php php-meth docutils literal"><span class="pre">CakeRequest::host()</span></tt></a> to
help applications with subdomains.</p>
<p>There are several built-in detectors that you can use:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">is('get')</span></tt> Check to see whether the current request is a GET.</li>
<li><tt class="docutils literal"><span class="pre">is('put')</span></tt> Check to see whether the current request is a PUT.</li>
<li><tt class="docutils literal"><span class="pre">is('post')</span></tt> Check to see whether the current request is a POST.</li>
<li><tt class="docutils literal"><span class="pre">is('delete')</span></tt> Check to see whether the current request is a DELETE.</li>
<li><tt class="docutils literal"><span class="pre">is('head')</span></tt> Check to see whether the current request is HEAD.</li>
<li><tt class="docutils literal"><span class="pre">is('options')</span></tt> Check to see whether the current request is OPTIONS.</li>
<li><tt class="docutils literal"><span class="pre">is('ajax')</span></tt> Check to see whether the current request came with
X-Requested-With = XMLHttpRequest.</li>
<li><tt class="docutils literal"><span class="pre">is('ssl')</span></tt> Check to see whether the request is via SSL</li>
<li><tt class="docutils literal"><span class="pre">is('flash')</span></tt> Check to see whether the request has a User-Agent of Flash</li>
<li><tt class="docutils literal"><span class="pre">is('mobile')</span></tt> Check to see whether the request came from a common list
of mobile agents.</li>
</ul>
</div>
<div class="section" id="cakerequest-and-requesthandlercomponent">
<h2>CakeRequest and RequestHandlerComponent<a class="headerlink" href="#cakerequest-and-requesthandlercomponent" title="Permalink to this headline">¶</a></h2>
<p>Since many of the features <a class="reference internal" href="#CakeRequest" title="CakeRequest"><tt class="xref php php-class docutils literal"><span class="pre">CakeRequest</span></tt></a> offers used to be the realm of
<a class="reference internal" href="../core-libraries/components/request-handling.html#RequestHandlerComponent" title="RequestHandlerComponent"><tt class="xref php php-class docutils literal"><span class="pre">RequestHandlerComponent</span></tt></a>, some rethinking was required to figure out how it
still fits into the picture. For 2.0, <a class="reference internal" href="../core-libraries/components/request-handling.html#RequestHandlerComponent" title="RequestHandlerComponent"><tt class="xref php php-class docutils literal"><span class="pre">RequestHandlerComponent</span></tt></a>
provides a layer of sugar, such as switching layout
and views based on content, on top of the utility that
<a class="reference internal" href="#CakeRequest" title="CakeRequest"><tt class="xref php php-class docutils literal"><span class="pre">CakeRequest</span></tt></a> affords.
This separation of utility and sugar between the two classes lets you
more easily choose what you want.</p>
</div>
<div class="section" id="interacting-with-other-aspects-of-the-request">
<h2>Interacting with other aspects of the request<a class="headerlink" href="#interacting-with-other-aspects-of-the-request" title="Permalink to this headline">¶</a></h2>
<p>You can use <a class="reference internal" href="#CakeRequest" title="CakeRequest"><tt class="xref php php-class docutils literal"><span class="pre">CakeRequest</span></tt></a> to introspect a variety of things about the request.
Beyond the detectors, you can also find out other information from various
properties and methods.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">$this-&gt;request-&gt;webroot</span></tt> contains the webroot directory.</li>
<li><tt class="docutils literal"><span class="pre">$this-&gt;request-&gt;base</span></tt> contains the base path.</li>
<li><tt class="docutils literal"><span class="pre">$this-&gt;request-&gt;here</span></tt> contains the full address to the current request.</li>
<li><tt class="docutils literal"><span class="pre">$this-&gt;request-&gt;query</span></tt> contains the query string parameters.</li>
</ul>
</div>
<div class="section" id="cakerequest-api">
<h2>CakeRequest API<a class="headerlink" href="#cakerequest-api" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="CakeRequest">
<em class="property">class </em><tt class="descname">CakeRequest</tt><a class="headerlink" href="#CakeRequest" title="Permalink to this definition">¶</a></dt>
<dd><p>CakeRequest encapsulates request parameter handling and introspection.</p>
</dd></dl>

<dl class="method">
<dt id="CakeRequest::domain">
<tt class="descclassname">CakeRequest::</tt><tt class="descname">domain</tt><big>(</big><em>$tldLength = 1</em><big>)</big><a class="headerlink" href="#CakeRequest::domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the domain name your application is running on.</p>
</dd></dl>

<dl class="method">
<dt id="CakeRequest::subdomains">
<tt class="descclassname">CakeRequest::</tt><tt class="descname">subdomains</tt><big>(</big><em>$tldLength = 1</em><big>)</big><a class="headerlink" href="#CakeRequest::subdomains" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the subdomains your application is running on as an array.</p>
</dd></dl>

<dl class="method">
<dt id="CakeRequest::host">
<tt class="descclassname">CakeRequest::</tt><tt class="descname">host</tt><big>(</big><big>)</big><a class="headerlink" href="#CakeRequest::host" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the host your application is on.</p>
</dd></dl>

<dl class="method">
<dt id="CakeRequest::method">
<tt class="descclassname">CakeRequest::</tt><tt class="descname">method</tt><big>(</big><big>)</big><a class="headerlink" href="#CakeRequest::method" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the HTTP method the request was made with.</p>
</dd></dl>

<dl class="method">
<dt id="CakeRequest::onlyAllow">
<tt class="descclassname">CakeRequest::</tt><tt class="descname">onlyAllow</tt><big>(</big><em>$methods</em><big>)</big><a class="headerlink" href="#CakeRequest::onlyAllow" title="Permalink to this definition">¶</a></dt>
<dd><p>Set allowed HTTP methods. If not matched, will throw MethodNotAllowedException.
The 405 response will include the required <tt class="docutils literal"><span class="pre">Allow</span></tt> header with the passed methods</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 2.5: </span>Use <a class="reference internal" href="#CakeRequest::allowMethod" title="CakeRequest::allowMethod"><tt class="xref php php-meth docutils literal"><span class="pre">CakeRequest::allowMethod()</span></tt></a> instead.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="CakeRequest::allowMethod">
<tt class="descclassname">CakeRequest::</tt><tt class="descname">allowMethod</tt><big>(</big><em>$methods</em><big>)</big><a class="headerlink" href="#CakeRequest::allowMethod" title="Permalink to this definition">¶</a></dt>
<dd><p>Set allowed HTTP methods. If not matched will throw MethodNotAllowedException.
The 405 response will include the required <tt class="docutils literal"><span class="pre">Allow</span></tt> header with the passed methods</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.5.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="CakeRequest::referer">
<tt class="descclassname">CakeRequest::</tt><tt class="descname">referer</tt><big>(</big><em>$local = false</em><big>)</big><a class="headerlink" href="#CakeRequest::referer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the referring address for the request.</p>
</dd></dl>

<dl class="method">
<dt id="CakeRequest::clientIp">
<tt class="descclassname">CakeRequest::</tt><tt class="descname">clientIp</tt><big>(</big><em>$safe = true</em><big>)</big><a class="headerlink" href="#CakeRequest::clientIp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the current visitor&#8217;s IP address.</p>
</dd></dl>

<dl class="method">
<dt id="CakeRequest::header">
<tt class="descclassname">CakeRequest::</tt><tt class="descname">header</tt><big>(</big><em>$name</em><big>)</big><a class="headerlink" href="#CakeRequest::header" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows you to access any of the <tt class="docutils literal"><span class="pre">HTTP_*</span></tt> headers that were used
for the request. For example:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">header</span><span class="p">(</span><span class="s1">&#39;User-Agent&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>would return the user agent used for the request.</p>
</dd></dl>

<dl class="method">
<dt id="CakeRequest::input">
<tt class="descclassname">CakeRequest::</tt><tt class="descname">input</tt><big>(</big><em>$callback</em><span class="optional">[</span>, <em>$options</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#CakeRequest::input" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the input data for a request, and optionally pass it through a
decoding function. Useful when interacting with XML or JSON
request body content. Additional parameters for the decoding function
can be passed as arguments to input():</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">input</span><span class="p">(</span><span class="s1">&#39;json_decode&#39;</span><span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="CakeRequest::data">
<tt class="descclassname">CakeRequest::</tt><tt class="descname">data</tt><big>(</big><em>$name</em><big>)</big><a class="headerlink" href="#CakeRequest::data" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides dot notation access to request data. Allows request data to be read and
modified. Calls can be chained together as well:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="c1">// Modify some request data, so you can prepopulate some form fields.</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">(</span><span class="s1">&#39;Post.title&#39;</span><span class="p">,</span> <span class="s1">&#39;New post&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">data</span><span class="p">(</span><span class="s1">&#39;Comment.1.author&#39;</span><span class="p">,</span> <span class="s1">&#39;Mark&#39;</span><span class="p">);</span>

<span class="c1">// You can also read out data.</span>
<span class="nv">$value</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">(</span><span class="s1">&#39;Post.title&#39;</span><span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="CakeRequest::query">
<tt class="descclassname">CakeRequest::</tt><tt class="descname">query</tt><big>(</big><em>$name</em><big>)</big><a class="headerlink" href="#CakeRequest::query" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides dot notation access to URL query data:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="c1">// URL is /posts/index?page=1&amp;sort=title</span>
<span class="nv">$value</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">);</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="CakeRequest::is">
<tt class="descclassname">CakeRequest::</tt><tt class="descname">is</tt><big>(</big><em>$type</em><big>)</big><a class="headerlink" href="#CakeRequest::is" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether or not a Request matches a certain criterion. Uses
the built-in detection rules as well as any additional rules defined
with <a class="reference internal" href="#CakeRequest::addDetector" title="CakeRequest::addDetector"><tt class="xref php php-meth docutils literal"><span class="pre">CakeRequest::addDetector()</span></tt></a>.</p>
</dd></dl>

<dl class="method">
<dt id="CakeRequest::addDetector">
<tt class="descclassname">CakeRequest::</tt><tt class="descname">addDetector</tt><big>(</big><em>$name</em>, <em>$options</em><big>)</big><a class="headerlink" href="#CakeRequest::addDetector" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a detector to be used with <a class="reference internal" href="#CakeRequest::is" title="CakeRequest::is"><tt class="xref php php-meth docutils literal"><span class="pre">CakeRequest::is()</span></tt></a>. See <a class="reference internal" href="#check-the-request"><em>Inspecting the request</em></a>
for more information.</p>
</dd></dl>

<dl class="method">
<dt id="CakeRequest::accepts">
<tt class="descclassname">CakeRequest::</tt><tt class="descname">accepts</tt><big>(</big><em>$type = null</em><big>)</big><a class="headerlink" href="#CakeRequest::accepts" title="Permalink to this definition">¶</a></dt>
<dd><p>Find out which content types the client accepts, or check whether it accepts a
particular type of content.</p>
<p>Get all types:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">accepts</span><span class="p">();</span>
</pre></div>
</div>
<p>Check for a single type:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">accepts</span><span class="p">(</span><span class="s1">&#39;application/json&#39;</span><span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<dl class="staticmethod">
<dt id="CakeRequest::acceptLanguage">
<em class="property">static </em><tt class="descclassname">CakeRequest::</tt><tt class="descname">acceptLanguage</tt><big>(</big><em>$language = null</em><big>)</big><a class="headerlink" href="#CakeRequest::acceptLanguage" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the languages accepted by the client,
or check whether a specific language is accepted.</p>
<p>Get the list of accepted languages:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nx">CakeRequest</span><span class="o">::</span><span class="na">acceptLanguage</span><span class="p">();</span>
</pre></div>
</div>
<p>Check whether a specific language is accepted:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nx">CakeRequest</span><span class="o">::</span><span class="na">acceptLanguage</span><span class="p">(</span><span class="s1">&#39;es-es&#39;</span><span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="CakeRequest::param">
<tt class="descclassname">CakeRequest::</tt><tt class="descname">param</tt><big>(</big><em>$name</em><big>)</big><a class="headerlink" href="#CakeRequest::param" title="Permalink to this definition">¶</a></dt>
<dd><p>Safely read values in <tt class="docutils literal"><span class="pre">$request-&gt;params</span></tt>. This removes the need to call
<tt class="docutils literal"><span class="pre">isset()</span></tt> or <tt class="docutils literal"><span class="pre">empty()</span></tt> before using param values.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.4.</span></p>
</div>
</dd></dl>

<dl class="attr">
<dt id="CakeRequest::$data">
<em class="property">property </em><tt class="descclassname">CakeRequest::$</tt><tt class="descname">data</tt><a class="headerlink" href="#CakeRequest::$data" title="Permalink to this definition">¶</a></dt>
<dd><p>An array of POST data. You can use <a class="reference internal" href="#CakeRequest::data" title="CakeRequest::data"><tt class="xref php php-meth docutils literal"><span class="pre">CakeRequest::data()</span></tt></a>
to read this property in a way that suppresses notice errors.</p>
</dd></dl>

<dl class="attr">
<dt id="CakeRequest::$query">
<em class="property">property </em><tt class="descclassname">CakeRequest::$</tt><tt class="descname">query</tt><a class="headerlink" href="#CakeRequest::$query" title="Permalink to this definition">¶</a></dt>
<dd><p>An array of query string parameters.</p>
</dd></dl>

<dl class="attr">
<dt id="CakeRequest::$params">
<em class="property">property </em><tt class="descclassname">CakeRequest::$</tt><tt class="descname">params</tt><a class="headerlink" href="#CakeRequest::$params" title="Permalink to this definition">¶</a></dt>
<dd><p>An array of route elements and request parameters.</p>
</dd></dl>

<dl class="attr">
<dt id="CakeRequest::$here">
<em class="property">property </em><tt class="descclassname">CakeRequest::$</tt><tt class="descname">here</tt><a class="headerlink" href="#CakeRequest::$here" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the current request uri.</p>
</dd></dl>

<dl class="attr">
<dt id="CakeRequest::$base">
<em class="property">property </em><tt class="descclassname">CakeRequest::$</tt><tt class="descname">base</tt><a class="headerlink" href="#CakeRequest::$base" title="Permalink to this definition">¶</a></dt>
<dd><p>The base path to the application, usually <tt class="docutils literal"><span class="pre">/</span></tt> unless your
application is in a subdirectory.</p>
</dd></dl>

<dl class="attr">
<dt id="CakeRequest::$webroot">
<em class="property">property </em><tt class="descclassname">CakeRequest::$</tt><tt class="descname">webroot</tt><a class="headerlink" href="#CakeRequest::$webroot" title="Permalink to this definition">¶</a></dt>
<dd><p>The current webroot.</p>
</dd></dl>

</div>
</div>
<div class="section" id="cakeresponse">
<span id="index-1"></span><h1>CakeResponse<a class="headerlink" href="#cakeresponse" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="#CakeResponse" title="CakeResponse"><tt class="xref php php-class docutils literal"><span class="pre">CakeResponse</span></tt></a> is the default response class in CakePHP. It
encapsulates a number of features and functionality for generating HTTP
responses in your application. It also assists in testing, as it can be
mocked/stubbed allowing you to inspect headers that will be sent.
Like <a class="reference internal" href="#CakeRequest" title="CakeRequest"><tt class="xref php php-class docutils literal"><span class="pre">CakeRequest</span></tt></a>, <a class="reference internal" href="#CakeResponse" title="CakeResponse"><tt class="xref php php-class docutils literal"><span class="pre">CakeResponse</span></tt></a> consolidates a number
of methods previously found on <a class="reference internal" href="../controllers.html#Controller" title="Controller"><tt class="xref php php-class docutils literal"><span class="pre">Controller</span></tt></a>,
<a class="reference internal" href="../core-libraries/components/request-handling.html#RequestHandlerComponent" title="RequestHandlerComponent"><tt class="xref php php-class docutils literal"><span class="pre">RequestHandlerComponent</span></tt></a> and <tt class="xref php php-class docutils literal"><span class="pre">Dispatcher</span></tt>. The old
methods are deprecated in favour of using <a class="reference internal" href="#CakeResponse" title="CakeResponse"><tt class="xref php php-class docutils literal"><span class="pre">CakeResponse</span></tt></a>.</p>
<p><a class="reference internal" href="#CakeResponse" title="CakeResponse"><tt class="xref php php-class docutils literal"><span class="pre">CakeResponse</span></tt></a> provides an interface to wrap the common response-related
tasks such as:</p>
<ul class="simple">
<li>Sending headers for redirects.</li>
<li>Sending content type headers.</li>
<li>Sending any header.</li>
<li>Sending the response body.</li>
</ul>
<div class="section" id="changing-the-response-class">
<h2>Changing the response class<a class="headerlink" href="#changing-the-response-class" title="Permalink to this headline">¶</a></h2>
<p>CakePHP uses <a class="reference internal" href="#CakeResponse" title="CakeResponse"><tt class="xref php php-class docutils literal"><span class="pre">CakeResponse</span></tt></a> by default. <a class="reference internal" href="#CakeResponse" title="CakeResponse"><tt class="xref php php-class docutils literal"><span class="pre">CakeResponse</span></tt></a> is a flexible and
transparent class. If you need to override it with your own application-specific class,
you can replace <a class="reference internal" href="#CakeResponse" title="CakeResponse"><tt class="xref php php-class docutils literal"><span class="pre">CakeResponse</span></tt></a> in <tt class="docutils literal"><span class="pre">app/webroot/index.php</span></tt>.
This will make all the controllers in your application use <tt class="docutils literal"><span class="pre">CustomResponse</span></tt>
instead of <a class="reference internal" href="#CakeResponse" title="CakeResponse"><tt class="xref php php-class docutils literal"><span class="pre">CakeResponse</span></tt></a>. You can also replace the response
instance by setting <tt class="docutils literal"><span class="pre">$this-&gt;response</span></tt> in your controllers. Overriding the
response object is handy during testing, as it allows you to stub
out the methods that interact with <a class="reference internal" href="#CakeResponse::header" title="CakeResponse::header"><tt class="xref php php-meth docutils literal"><span class="pre">header()</span></tt></a>. See the section on
<a class="reference internal" href="#cakeresponse-testing"><em>CakeResponse and testing</em></a> for more information.</p>
</div>
<div class="section" id="dealing-with-content-types">
<h2>Dealing with content types<a class="headerlink" href="#dealing-with-content-types" title="Permalink to this headline">¶</a></h2>
<p>You can control the Content-Type of your application&#8217;s responses with
<a class="reference internal" href="#CakeResponse::type" title="CakeResponse::type"><tt class="xref php php-meth docutils literal"><span class="pre">CakeResponse::type()</span></tt></a>. If your application needs to deal with
content types that are not built into <a class="reference internal" href="#CakeResponse" title="CakeResponse"><tt class="xref php php-class docutils literal"><span class="pre">CakeResponse</span></tt></a>, you can map them
with <a class="reference internal" href="#CakeResponse::type" title="CakeResponse::type"><tt class="xref php php-meth docutils literal"><span class="pre">CakeResponse::type()</span></tt></a> as well:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="c1">// Add a vCard type</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;vcf&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;text/v-card&#39;</span><span class="p">));</span>

<span class="c1">// Set the response Content-Type to vcard.</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">(</span><span class="s1">&#39;vcf&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Usually, you&#8217;ll want to map additional content types in your controller&#8217;s
<a class="reference internal" href="../controllers.html#Controller::beforeFilter" title="Controller::beforeFilter"><tt class="xref php php-meth docutils literal"><span class="pre">beforeFilter()</span></tt></a> callback, so you can leverage the automatic view switching
features of <a class="reference internal" href="../core-libraries/components/request-handling.html#RequestHandlerComponent" title="RequestHandlerComponent"><tt class="xref php php-class docutils literal"><span class="pre">RequestHandlerComponent</span></tt></a> if you are using it.</p>
</div>
<div class="section" id="sending-files">
<span id="cake-response-file"></span><h2>Sending files<a class="headerlink" href="#sending-files" title="Permalink to this headline">¶</a></h2>
<p>There are times when you want to send files as responses for your requests.
Prior to version 2.3, you could use <a class="reference internal" href="../views/media-view.html#MediaView" title="MediaView"><tt class="xref php php-class docutils literal"><span class="pre">MediaView</span></tt></a>.
As of 2.3, <a class="reference internal" href="../views/media-view.html#MediaView" title="MediaView"><tt class="xref php php-class docutils literal"><span class="pre">MediaView</span></tt></a> is deprecated and you can use <a class="reference internal" href="#CakeResponse::file" title="CakeResponse::file"><tt class="xref php php-meth docutils literal"><span class="pre">CakeResponse::file()</span></tt></a>
to send a file as response:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">sendFile</span><span class="p">(</span><span class="nv">$id</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Attachment</span><span class="o">-&gt;</span><span class="na">getFile</span><span class="p">(</span><span class="nv">$id</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">file</span><span class="p">(</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]);</span>
    <span class="c1">// Return response object to prevent controller from trying to render</span>
    <span class="c1">// a view</span>
    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As shown in the above example, you must pass the file path to the method.
CakePHP will send a proper content type header if it&#8217;s a known file type listed in
<tt class="xref php php-attr docutils literal"><span class="pre">CakeResponse::$_mimeTypes</span></tt>. You can add new types prior to calling <a class="reference internal" href="#CakeResponse::file" title="CakeResponse::file"><tt class="xref php php-meth docutils literal"><span class="pre">CakeResponse::file()</span></tt></a>
by using the <a class="reference internal" href="#CakeResponse::type" title="CakeResponse::type"><tt class="xref php php-meth docutils literal"><span class="pre">CakeResponse::type()</span></tt></a> method.</p>
<p>If you want, you can also force a file to be downloaded instead of displayed in
the browser by specifying the options:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">file</span><span class="p">(</span>
    <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">],</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;download&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="sending-a-string-as-file">
<h2>Sending a string as file<a class="headerlink" href="#sending-a-string-as-file" title="Permalink to this headline">¶</a></h2>
<p>You can respond with a file that does not exist on the disk, such as
a pdf or an ics generated on the fly from a string:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">sendIcs</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$icsString</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Calendar</span><span class="o">-&gt;</span><span class="na">generateIcs</span><span class="p">();</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">body</span><span class="p">(</span><span class="nv">$icsString</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">(</span><span class="s1">&#39;ics&#39;</span><span class="p">);</span>

    <span class="c1">//Optionally force file download</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">download</span><span class="p">(</span><span class="s1">&#39;filename_for_download.ics&#39;</span><span class="p">);</span>

    <span class="c1">// Return response object to prevent controller from trying to render</span>
    <span class="c1">// a view</span>
    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-headers">
<h2>Setting headers<a class="headerlink" href="#setting-headers" title="Permalink to this headline">¶</a></h2>
<p>Setting headers is done with the <a class="reference internal" href="#CakeResponse::header" title="CakeResponse::header"><tt class="xref php php-meth docutils literal"><span class="pre">CakeResponse::header()</span></tt></a> method. It
can be called with a few different parameter configurations:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="c1">// Set a single header</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">header</span><span class="p">(</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span> <span class="s1">&#39;http://example.com&#39;</span><span class="p">);</span>

<span class="c1">// Set multiple headers</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">header</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;Location&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;http://example.com&#39;</span><span class="p">,</span>
    <span class="s1">&#39;X-Extra&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;My header&#39;</span>
<span class="p">));</span>

<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">header</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;WWW-Authenticate: Negotiate&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Content-type: application/pdf&#39;</span>
<span class="p">));</span>
</pre></div>
</div>
<p>Setting the same <a class="reference internal" href="#CakeResponse::header" title="CakeResponse::header"><tt class="xref php php-meth docutils literal"><span class="pre">header()</span></tt></a> multiple times will result in overwriting the previous
values, just as regular header calls do. Headers are not sent when
<a class="reference internal" href="#CakeResponse::header" title="CakeResponse::header"><tt class="xref php php-meth docutils literal"><span class="pre">CakeResponse::header()</span></tt></a> is called; instead they are buffered
until the response is actually sent.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.4.</span></p>
</div>
<p>You can now use the convenience method <a class="reference internal" href="#CakeResponse::location" title="CakeResponse::location"><tt class="xref php php-meth docutils literal"><span class="pre">CakeResponse::location()</span></tt></a> to directly set or get
the redirect location header.</p>
</div>
<div class="section" id="interacting-with-browser-caching">
<h2>Interacting with browser caching<a class="headerlink" href="#interacting-with-browser-caching" title="Permalink to this headline">¶</a></h2>
<p>You sometimes need to force browsers not to cache the results of a controller
action. <a class="reference internal" href="#CakeResponse::disableCache" title="CakeResponse::disableCache"><tt class="xref php php-meth docutils literal"><span class="pre">CakeResponse::disableCache()</span></tt></a> is intended for just that:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// do something.</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">disableCache</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Using disableCache() with downloads from SSL domains while trying to send
files to Internet Explorer can result in errors.</p>
</div>
<p>You can also tell clients that you want them to cache responses. By using
<a class="reference internal" href="#CakeResponse::cache" title="CakeResponse::cache"><tt class="xref php php-meth docutils literal"><span class="pre">CakeResponse::cache()</span></tt></a>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//do something</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">(</span><span class="s1">&#39;-1 minute&#39;</span><span class="p">,</span> <span class="s1">&#39;+5 days&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above would tell clients to cache the resulting response for 5 days,
hopefully speeding up your visitors&#8217; experience. <a class="reference internal" href="#CakeResponse::cache" title="CakeResponse::cache"><tt class="xref php php-meth docutils literal"><span class="pre">CakeResponse::cache()</span></tt></a> sets the
<tt class="docutils literal"><span class="pre">Last-Modified</span></tt> value to the first argument.
<tt class="docutils literal"><span class="pre">Expires</span></tt> header and the <tt class="docutils literal"><span class="pre">max-age</span></tt> directive are set based on the second parameter.
Cache-Control&#8217;s <tt class="docutils literal"><span class="pre">public</span></tt> directive is set as well.</p>
</div>
<div class="section" id="fine-tuning-http-cache">
<span id="cake-response-caching"></span><h2>Fine tuning HTTP cache<a class="headerlink" href="#fine-tuning-http-cache" title="Permalink to this headline">¶</a></h2>
<p>One of the best and easiest ways of speeding up your application is to use HTTP
cache. Under this caching model, you are only required to help clients decide if
they should use a cached copy of the response by setting a few headers such as
modified time and response entity tag.</p>
<p>Rather than forcing you to code the logic for caching and for invalidating (refreshing)
it once the data has changed, HTTP uses two models, expiration and validation,
which usually are much simpler to use.</p>
<p>Apart from using <a class="reference internal" href="#CakeResponse::cache" title="CakeResponse::cache"><tt class="xref php php-meth docutils literal"><span class="pre">CakeResponse::cache()</span></tt></a>, you can also use many other
methods to fine-tune HTTP cache headers to take advantage of browser or reverse
proxy caching.</p>
<div class="section" id="the-cache-control-header">
<h3>The Cache Control header<a class="headerlink" href="#the-cache-control-header" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.1.</span></p>
</div>
<p>Used under the expiration model, this header contains multiple indicators
that can change the way browsers or proxies use the cached content. A
<tt class="docutils literal"><span class="pre">Cache-Control</span></tt> header can look like this:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nx">Cache</span><span class="o">-</span><span class="nx">Control</span><span class="o">:</span> <span class="k">private</span><span class="p">,</span> <span class="nb">max</span><span class="o">-</span><span class="nx">age</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span> <span class="nx">must</span><span class="o">-</span><span class="nx">revalidate</span>
</pre></div>
</div>
<p><a class="reference internal" href="#CakeResponse" title="CakeResponse"><tt class="xref php php-class docutils literal"><span class="pre">CakeResponse</span></tt></a> class helps you set this header with some utility methods that
will produce a final valid <tt class="docutils literal"><span class="pre">Cache-Control</span></tt> header. The first is the <a class="reference internal" href="#CakeResponse::sharable" title="CakeResponse::sharable"><tt class="xref php php-meth docutils literal"><span class="pre">CakeResponse::sharable()</span></tt></a>
method, which indicates whether a response is to be considered sharable across
different users or clients. This method actually controls the <tt class="docutils literal"><span class="pre">public</span></tt>
or <tt class="docutils literal"><span class="pre">private</span></tt> part of this header. Setting a response as private indicates that
all or part of it is intended for a single user. To take advantage of shared
caches, the control directive must be set as public.</p>
<p>The second parameter of this method is used to specify a <tt class="docutils literal"><span class="pre">max-age</span></tt> for the cache,
which is the number of seconds after which the response is no longer considered
fresh:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">view</span><span class="p">()</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="c1">// set the Cache-Control as public for 3600 seconds</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">sharable</span><span class="p">(</span><span class="k">true</span><span class="p">,</span> <span class="mi">3600</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">my_data</span><span class="p">()</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="c1">// set the Cache-Control as private for 3600 seconds</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">sharable</span><span class="p">(</span><span class="k">false</span><span class="p">,</span> <span class="mi">3600</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><a class="reference internal" href="#CakeResponse" title="CakeResponse"><tt class="xref php php-class docutils literal"><span class="pre">CakeResponse</span></tt></a> exposes separate methods for setting each of the directives in
the <tt class="docutils literal"><span class="pre">Cache-Control</span></tt> header.</p>
</div>
<div class="section" id="the-expiration-header">
<h3>The Expiration header<a class="headerlink" href="#the-expiration-header" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.1.</span></p>
</div>
<p>You can set the <tt class="docutils literal"><span class="pre">Expires</span></tt> header to a date and time after which the response is
no longer considered fresh. This header can be set using the
<a class="reference internal" href="#CakeResponse::expires" title="CakeResponse::expires"><tt class="xref php php-meth docutils literal"><span class="pre">CakeResponse::expires()</span></tt></a> method:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">view</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">expires</span><span class="p">(</span><span class="s1">&#39;+5 days&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This method also accepts a <tt class="xref php php-class docutils literal"><span class="pre">DateTime</span></tt> instance or any string that can be parsed by the
<tt class="xref php php-class docutils literal"><span class="pre">DateTime</span></tt> class.</p>
</div>
<div class="section" id="the-etag-header">
<h3>The Etag header<a class="headerlink" href="#the-etag-header" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.1.</span></p>
</div>
<p>Cache validation in HTTP is often used when content is constantly changing, and
asks the application to only generate the response contents if the cache is no
longer fresh. Under this model, the client continues to store pages in the
cache, but it asks the application every time
whether the resource has changed, instead of using it directly.
This is commonly used with static resources such as images and other assets.</p>
<p>The <a class="reference internal" href="#CakeResponse::etag" title="CakeResponse::etag"><tt class="xref php php-meth docutils literal"><span class="pre">etag()</span></tt></a> method (called entity tag) is a string that uniquely identifies the
requested resource, as a checksum does for a file, in order to determine whether
it matches a cached resource.</p>
<p>To take advantage of this header, you must either call the
<a class="reference internal" href="#CakeResponse::checkNotModified" title="CakeResponse::checkNotModified"><tt class="xref php php-meth docutils literal"><span class="pre">CakeResponse::checkNotModified()</span></tt></a> method manually or include the
<a class="reference internal" href="../core-libraries/components/request-handling.html#RequestHandlerComponent" title="RequestHandlerComponent"><tt class="xref php php-class docutils literal"><span class="pre">RequestHandlerComponent</span></tt></a> in your controller:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$articles</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Article</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">etag</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Article</span><span class="o">-&gt;</span><span class="na">generateHash</span><span class="p">(</span><span class="nv">$articles</span><span class="p">));</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">checkNotModified</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="the-last-modified-header">
<h3>The Last Modified header<a class="headerlink" href="#the-last-modified-header" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.1.</span></p>
</div>
<p>Under the HTTP cache validation model, you can also set the <tt class="docutils literal"><span class="pre">Last-Modified</span></tt>
header to indicate the date and time at which the resource was modified for the
last time. Setting this header helps CakePHP tell caching clients whether
the response was modified or not based on their cache.</p>
<p>To take advantage of this header, you must either call the
<a class="reference internal" href="#CakeResponse::checkNotModified" title="CakeResponse::checkNotModified"><tt class="xref php php-meth docutils literal"><span class="pre">CakeResponse::checkNotModified()</span></tt></a> method manually or include the
<a class="reference internal" href="../core-libraries/components/request-handling.html#RequestHandlerComponent" title="RequestHandlerComponent"><tt class="xref php php-class docutils literal"><span class="pre">RequestHandlerComponent</span></tt></a> in your controller:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">view</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$article</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Article</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;first&#39;</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">modified</span><span class="p">(</span><span class="nv">$article</span><span class="p">[</span><span class="s1">&#39;Article&#39;</span><span class="p">][</span><span class="s1">&#39;modified&#39;</span><span class="p">]);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">checkNotModified</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="the-vary-header">
<h3>The Vary header<a class="headerlink" href="#the-vary-header" title="Permalink to this headline">¶</a></h3>
<p>In some cases, you might want to serve different content using the same URL.
This is often the case if you have a multilingual page or respond with different
HTML depending on the browser. Under such circumstances you can use the <tt class="docutils literal"><span class="pre">Vary</span></tt> header:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">vary</span><span class="p">(</span><span class="s1">&#39;User-Agent&#39;</span><span class="p">);</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">vary</span><span class="p">(</span><span class="s1">&#39;Accept-Encoding&#39;</span><span class="p">,</span> <span class="s1">&#39;User-Agent&#39;</span><span class="p">);</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">vary</span><span class="p">(</span><span class="s1">&#39;Accept-Language&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="cakeresponse-and-testing">
<span id="cakeresponse-testing"></span><h2>CakeResponse and testing<a class="headerlink" href="#cakeresponse-and-testing" title="Permalink to this headline">¶</a></h2>
<p>Probably one of the biggest wins from <a class="reference internal" href="#CakeResponse" title="CakeResponse"><tt class="xref php php-class docutils literal"><span class="pre">CakeResponse</span></tt></a> comes from how it makes
testing controllers and components easier. Instead of having methods spread across
several objects, you only have to mock a single object, since controllers and
components delegate to <a class="reference internal" href="#CakeResponse" title="CakeResponse"><tt class="xref php php-class docutils literal"><span class="pre">CakeResponse</span></tt></a>. This helps you to get closer to a unit
test and makes testing controllers easier:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">testSomething</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">controller</span><span class="o">-&gt;</span><span class="na">response</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getMock</span><span class="p">(</span><span class="s1">&#39;CakeResponse&#39;</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">controller</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">expects</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">once</span><span class="p">())</span><span class="o">-&gt;</span><span class="na">method</span><span class="p">(</span><span class="s1">&#39;header&#39;</span><span class="p">);</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Additionally, you can run tests from the command line more easily, as you can use
mocks to avoid the &#8216;headers sent&#8217; errors that can occur when trying to set
headers in CLI.</p>
</div>
<div class="section" id="cakeresponse-api">
<h2>CakeResponse API<a class="headerlink" href="#cakeresponse-api" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="CakeResponse">
<em class="property">class </em><tt class="descname">CakeResponse</tt><a class="headerlink" href="#CakeResponse" title="Permalink to this definition">¶</a></dt>
<dd><p>CakeResponse provides a number of useful methods for interacting with
the response you are sending to a client.</p>
</dd></dl>

<dl class="method">
<dt id="CakeResponse::header">
<tt class="descclassname">CakeResponse::</tt><tt class="descname">header</tt><big>(</big><em>$header = null</em>, <em>$value = null</em><big>)</big><a class="headerlink" href="#CakeResponse::header" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows you to directly set one or more headers to be sent with the response.</p>
</dd></dl>

<dl class="method">
<dt id="CakeResponse::location">
<tt class="descclassname">CakeResponse::</tt><tt class="descname">location</tt><big>(</big><em>$url = null</em><big>)</big><a class="headerlink" href="#CakeResponse::location" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows you to directly set the redirect location header to be sent with the response:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span class="c1">// Set the redirect location</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">location</span><span class="p">(</span><span class="s1">&#39;http://example.com&#39;</span><span class="p">);</span>

<span class="c1">// Get the current redirect location header</span>
<span class="nv">$location</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">location</span><span class="p">();</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.4.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="CakeResponse::charset">
<tt class="descclassname">CakeResponse::</tt><tt class="descname">charset</tt><big>(</big><em>$charset = null</em><big>)</big><a class="headerlink" href="#CakeResponse::charset" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the charset that will be used in the response.</p>
</dd></dl>

<dl class="method">
<dt id="CakeResponse::type">
<tt class="descclassname">CakeResponse::</tt><tt class="descname">type</tt><big>(</big><em>$contentType = null</em><big>)</big><a class="headerlink" href="#CakeResponse::type" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the content type of the response. You can either use a known content
type alias or the full content type name.</p>
</dd></dl>

<dl class="method">
<dt id="CakeResponse::cache">
<tt class="descclassname">CakeResponse::</tt><tt class="descname">cache</tt><big>(</big><em>$since</em>, <em>$time = '+1 day'</em><big>)</big><a class="headerlink" href="#CakeResponse::cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows you to set caching headers in the response.</p>
</dd></dl>

<dl class="method">
<dt id="CakeResponse::disableCache">
<tt class="descclassname">CakeResponse::</tt><tt class="descname">disableCache</tt><big>(</big><big>)</big><a class="headerlink" href="#CakeResponse::disableCache" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the headers to disable client caching for the response.</p>
</dd></dl>

<dl class="method">
<dt id="CakeResponse::sharable">
<tt class="descclassname">CakeResponse::</tt><tt class="descname">sharable</tt><big>(</big><em>$public = null</em>, <em>$time = null</em><big>)</big><a class="headerlink" href="#CakeResponse::sharable" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the <tt class="docutils literal"><span class="pre">Cache-Control</span></tt> header to be either <tt class="docutils literal"><span class="pre">public</span></tt> or <tt class="docutils literal"><span class="pre">private</span></tt> and
optionally sets a <tt class="docutils literal"><span class="pre">max-age</span></tt> directive of the resource</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.1.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="CakeResponse::expires">
<tt class="descclassname">CakeResponse::</tt><tt class="descname">expires</tt><big>(</big><em>$time = null</em><big>)</big><a class="headerlink" href="#CakeResponse::expires" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows the <tt class="docutils literal"><span class="pre">Expires</span></tt> header to be set to a specific date.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.1.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="CakeResponse::etag">
<tt class="descclassname">CakeResponse::</tt><tt class="descname">etag</tt><big>(</big><em>$tag = null</em>, <em>$weak = false</em><big>)</big><a class="headerlink" href="#CakeResponse::etag" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the <tt class="docutils literal"><span class="pre">Etag</span></tt> header to uniquely identify a response resource.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.1.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="CakeResponse::modified">
<tt class="descclassname">CakeResponse::</tt><tt class="descname">modified</tt><big>(</big><em>$time = null</em><big>)</big><a class="headerlink" href="#CakeResponse::modified" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the <tt class="docutils literal"><span class="pre">Last-Modified</span></tt> header to a specific date and time in the correct
format.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.1.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="CakeResponse::checkNotModified">
<tt class="descclassname">CakeResponse::</tt><tt class="descname">checkNotModified</tt><big>(</big><em>CakeRequest $request</em><big>)</big><a class="headerlink" href="#CakeResponse::checkNotModified" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares the cache headers for the request object with the cache header from
the response and determines whether it can still be considered fresh. If so,
deletes the response content, and sends the <cite>304 Not Modified</cite> header.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.1.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="CakeResponse::compress">
<tt class="descclassname">CakeResponse::</tt><tt class="descname">compress</tt><big>(</big><big>)</big><a class="headerlink" href="#CakeResponse::compress" title="Permalink to this definition">¶</a></dt>
<dd><p>Turns on gzip compression for the request.</p>
</dd></dl>

<dl class="method">
<dt id="CakeResponse::download">
<tt class="descclassname">CakeResponse::</tt><tt class="descname">download</tt><big>(</big><em>$filename</em><big>)</big><a class="headerlink" href="#CakeResponse::download" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows you to send a response as an attachment, and to set its filename.</p>
</dd></dl>

<dl class="method">
<dt id="CakeResponse::statusCode">
<tt class="descclassname">CakeResponse::</tt><tt class="descname">statusCode</tt><big>(</big><em>$code = null</em><big>)</big><a class="headerlink" href="#CakeResponse::statusCode" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows you to set the status code of the response.</p>
</dd></dl>

<dl class="method">
<dt id="CakeResponse::body">
<tt class="descclassname">CakeResponse::</tt><tt class="descname">body</tt><big>(</big><em>$content = null</em><big>)</big><a class="headerlink" href="#CakeResponse::body" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the content body of the response.</p>
</dd></dl>

<dl class="method">
<dt id="CakeResponse::send">
<tt class="descclassname">CakeResponse::</tt><tt class="descname">send</tt><big>(</big><big>)</big><a class="headerlink" href="#CakeResponse::send" title="Permalink to this definition">¶</a></dt>
<dd><p>Once you are done creating a response, calling <a class="reference internal" href="#CakeResponse::send" title="CakeResponse::send"><tt class="xref php php-meth docutils literal"><span class="pre">send()</span></tt></a> will send all
the set headers as well as the body. This is done automatically at the
end of each request by <tt class="xref php php-class docutils literal"><span class="pre">Dispatcher</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="CakeResponse::file">
<tt class="descclassname">CakeResponse::</tt><tt class="descname">file</tt><big>(</big><em>$path</em>, <em>$options = array()</em><big>)</big><a class="headerlink" href="#CakeResponse::file" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows you to set the <tt class="docutils literal"><span class="pre">Content-Disposition</span></tt> header of a file either to display or to download.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
</dd></dl>

</div>
</div>


		</div>
	</div>

	<div class="sidebar columns three pull-nine">
<div id="sidebar-navigation" class="hide-on-phones">
	<h2 class="hide-on-desktops">Table of Contents</h2>
	<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cakephp-overview.html">CakePHP Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../controllers.html">Controllers</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">Request and Response objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cakerequest">CakeRequest</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#cakeresponse">CakeResponse</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="scaffolding.html">Scaffolding</a></li>
<li class="toctree-l2"><a class="reference internal" href="pages-controller.html">The Pages Controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="components.html">Components</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../views.html">Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries.html">Core Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../console-and-shells.html">Console and Shells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials-and-examples.html">Tutorials &amp; Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices.html">Appendices</a></li>
</ul>

</div>

<div class="page-contents">
	<h3>Page contents</h3>
	<ul>
<li><a class="reference internal" href="#">Request and Response objects</a></li>
<li><a class="reference internal" href="#cakerequest">CakeRequest</a><ul>
<li><a class="reference internal" href="#accessing-request-parameters">Accessing request parameters</a></li>
<li><a class="reference internal" href="#accessing-querystring-parameters">Accessing Querystring parameters</a></li>
<li><a class="reference internal" href="#accessing-post-data">Accessing POST data</a></li>
<li><a class="reference internal" href="#accessing-put-or-post-data">Accessing PUT or POST data</a></li>
<li><a class="reference internal" href="#accessing-xml-or-json-data">Accessing XML or JSON data</a></li>
<li><a class="reference internal" href="#accessing-path-information">Accessing path information</a></li>
<li><a class="reference internal" href="#inspecting-the-request">Inspecting the request</a></li>
<li><a class="reference internal" href="#cakerequest-and-requesthandlercomponent">CakeRequest and RequestHandlerComponent</a></li>
<li><a class="reference internal" href="#interacting-with-other-aspects-of-the-request">Interacting with other aspects of the request</a></li>
<li><a class="reference internal" href="#cakerequest-api">CakeRequest API</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cakeresponse">CakeResponse</a><ul>
<li><a class="reference internal" href="#changing-the-response-class">Changing the response class</a></li>
<li><a class="reference internal" href="#dealing-with-content-types">Dealing with content types</a></li>
<li><a class="reference internal" href="#sending-files">Sending files</a></li>
<li><a class="reference internal" href="#sending-a-string-as-file">Sending a string as file</a></li>
<li><a class="reference internal" href="#setting-headers">Setting headers</a></li>
<li><a class="reference internal" href="#interacting-with-browser-caching">Interacting with browser caching</a></li>
<li><a class="reference internal" href="#fine-tuning-http-cache">Fine tuning HTTP cache</a><ul>
<li><a class="reference internal" href="#the-cache-control-header">The Cache Control header</a></li>
<li><a class="reference internal" href="#the-expiration-header">The Expiration header</a></li>
<li><a class="reference internal" href="#the-etag-header">The Etag header</a></li>
<li><a class="reference internal" href="#the-last-modified-header">The Last Modified header</a></li>
<li><a class="reference internal" href="#the-vary-header">The Vary header</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cakeresponse-and-testing">CakeResponse and testing</a></li>
<li><a class="reference internal" href="#cakeresponse-api">CakeResponse API</a></li>
</ul>
</li>
</ul>

</div>
	</div>

</div>

<div class="content row">
	<ul class="related-pages inline">
	<li>
		<a href="../genindex.html" title="General Index" accesskey="I">index</a>
	</li>
	<li>
		<a href="scaffolding.html" title="Scaffolding" accesskey="N">next</a>
	</li>
	<li>
		<a href="../controllers.html" title="Controllers" accesskey="P">previous</a>
	</li>
	</ul>
</div>

	<div class="footer-push"> </div>
</div>






<div class="footer">
	<div class="row">
		<div class="columns six offset-by-three contribute">
			<strong>发现翻译错误?</strong>
			请在下面留言<br />
			<a href="https://github.com/blackpuppy/docs/wiki" target="_blank">[ 我要加入翻译 ]</a>
		</div>
	</div>
	
	<div class="row">
		<div class="columns nine offset-by-three copyright">
					&copy; Copyright 2014, Cake Software Foundation, Inc.
				Last updated on Sep 04, 2015.
				Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.3.
		</div>
	</div>
</div>

<div id="nav-modal" class="reveal-modal"> </div>
<div id="inline-search-results"></div>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F201cbc61deaf9f7ffb521fb23e83db40' type='text/javascript'%3E%3C/script%3E"));
</script>

<!-- Duoshuo Comment BEGIN -->
	<div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"cakephpchina"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0]
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- Duoshuo Comment END -->

<!-- Grunt Live Reload -->
<script src="http://192.168.56.113:35729/livereload.js"></script>
  </body>
</html>