
<!DOCTYPE html>



<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="Blog Tutorial" lang="en" name="title" />
<meta content="model view controller,object oriented programming,application logic,directory setup,basic knowledge,database server,server configuration,reins,documentroot,readme,repository,web server,productivity,lib,sql,aim,cakephp,servers,apache,downloads" lang="en" name="keywords" />
<meta content="Blog Tutorial Adding a Layer" lang="en" name="title" />
<meta content="doc models,validation check,controller actions,model post,php class,model class,model object,business logic,database table,naming convention,bread and butter,callbacks,prefixes,nutshell,interaction,array,cakephp,interface,applications,delete" lang="en" name="keywords" />
<meta content="Getting Started" lang="en" name="title" />
<meta content="folder structure,table names,initial request,database table,organizational structure,rst,filenames,conventions,mvc,web page,sit" lang="en" name="keywords" />

    <title>Getting Started &mdash; CakePHP Cookbook 2.x documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.x',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/app.js"></script>
    <script type="text/javascript" src="_static/modernizr.foundation.js"></script>
    <script type="text/javascript" src="_static/foundation.js"></script>
    <link rel="top" title="CakePHP Cookbook 2.x documentation" href="index.html" />
    <link rel="next" title="URL Rewriting" href="installation/url-rewriting.html" />
    <link rel="prev" title="URL Rewriting" href="installation/url-rewriting.html" />
<link href="_static/favicon.ico" type="image/x-icon" rel="icon" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<link rel="alternate" hreflang="pt" href="../pt/getting-started.html" /><link rel="alternate" hreflang="es" href="../es/getting-started.html" /><link rel="alternate" hreflang="ja" href="../ja/getting-started.html" /><link rel="alternate" hreflang="fr" href="../fr/getting-started.html" /><link rel="alternate" hreflang="zh_CN" href="../zh/getting-started.html" />

<link rel="search" type="application/opensearchdescription+xml" title="CakePHP Book 2.x Search" href="_static/opensearchdescription-book-2-x.xml">
<script type="text/javascript">
window.lang = "en";
</script>

  </head>
  <body>

<div id="container">

<div id="cakephp-global-navigation">
	<ul>
		<li class="main"><a href="http://cakephp.org">CakePHP</a></li>
		<li class="primary"><a href="#" class="empty">Downloads</a>
			<ul class="second-level">
				<li><a href="https://github.com/cakephp/cakephp/tags">Releases</a></li>
				<li><a href="http://pear.cakephp.org">Pear channel</a></li>
			</ul>
		</li>
		<li class="primary"><a href="#" class="empty">Documentation</a>
			<ul class="second-level">
				<li><a href="http://api.cakephp.org">API</a></li>
				<li><a href="http://book.cakephp.org">Book</a></li>
			</ul>
		</li>
		<li class="primary"><a href="http://community.cakephp.org">Community</a>
			<ul class="second-level">
				<li><a href="http://webchat.freenode.net/?channels=cakephp&uio=MT1mYWxzZSY5PXRydWUmMTE9MjQ2b8">Help &amp; Support</a></li>
				<li><a href="https://github.com/cakephp/cakephp/issues">Issues</a></li>
				<li><a href="http://bakery.cakephp.org">The Bakery</a></li>
				<li><a href="http://stackoverflow.com/tags/cakephp">Stack Overflow</a></li>
				<li><a href="http://www.facebook.com/groups/cake.community">Facebook Group</a></li>
				<li><a href="http://goo.gl/mSC0s">Google+ Community</a></li>
				<li><a href="http://www.youtube.com/user/CakePHP">YouTube Channel</a></li>
				<li><a href="http://podcast.cakephp.org">CakePHP Podcast</a></li>
				<li><a href="http://twitter.com/CakePHP">Follow us on Twitter</a></li>
				<li><a href="http://groups.google.com/group/cake-php">Google Group</a></li>
				<li><a href="http://github.com/cakephp/cakephp/contributors">Contributors</a></li>
				<li><a href="http://plugins.cakephp.org">Plugins &amp; Packages</a></li>
				<li><a href="http://community.cakephp.org/get-involved">Get Involved</a></li>
				<li><a href="http://community.cakephp.org/guidelines">Guidelines</a></li>
				<li><a href="http://cakefest.org">CakeFest</a></li>
				<li><a href="http://cakephp.org/logos">Logo</a></li>
			</ul>
		</li>
		<li class="primary"><a href="http://cakephp.org/services">Services</a>
			<ul class="second-level">
				<li><a href="http://certification.cakephp.org">Certification</a></li>
				<li><a href="http://cakephp.org/services/consultation">Consultation</a></li>
				<li><a href="http://cakephp.org/services/support">Support</a></li>
				<li><a href="http://training.cakephp.org">Training</a></li>
			</ul>
		</li>
	</ul>
</div>

<div class="masthead">
	<div class="header-backing"></div>
	<div class="searchbar row">
		<div class="columns three phone-one">
			<a class="logo" href="contents.html">
			<img src="_static/cake-logo.png" alt="CakePHP" width="70" />
			</a>
		</div>
		
<div id="searchbox" class="columns nine phone-three">

	<form id="searchform" class="search" action="search.html" method="get">
		<input class="search-input" autocomplete="off" type="search" name="q" size="18" />
		<input class="search-submit search-big button red" type="submit" value="Search" />
		<input type="hidden" name="check_keywords" value="yes" />
		<input type="hidden" name="area" value="default" />

		<a href="#" id="tablet-nav" class="show-on-phones pale button small">Nav</a>
	</form>

</div>
	</div>
</div>
<div class="breadcrumb-header">
	<div class="related row">
		<div class="columns three root-link">
			<a href="contents.html">Cookbook 2.x</a>
		</div>
		<div class="columns nine">
			<ul class="inline breadcrumb">
			</ul>
			<div class="versions dropdown">
				<a href="#">2.x Book</a>
				<ul>
					<li><a href="http://book.cakephp.org/3.0/en">3.0 Book</a></li>
					<li><a href="http://book.cakephp.org/1.3/en/">1.3 Book</a></li>
					<li><a href="http://book.cakephp.org/1.2/en/">1.2 Book</a></li>
					<li><a href="http://book.cakephp.org/1.1/en">1.1 Book</a></li>
				</ul>
			</div>

			<div class="languages dropdown">
				<a href="#">en</a>

				<ul>
				
					<li></li>
				
					<li><a href="../pt/getting-started.html">pt</a></li>
				
					<li><a href="../es/getting-started.html">es</a></li>
				
					<li><a href="../ja/getting-started.html">ja</a></li>
				
					<li><a href="../fr/getting-started.html">fr</a></li>
				
					<li><a href="../zh/getting-started.html">zh_CN</a></li>
				
				</ul>
			</div>
		</div>
	</div>
</div>

<div class="content row">
	<div class="document columns nine push-three">
		<div class="body"><a class="button pale improve" href="https://github.com/cakephp/docs/edit/master/en/getting-started.rst" target="_blank">Improve this Doc</a>
  <div class="section" id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<p>The CakePHP framework provides a robust base for your application.
It can handle every aspect, from the user&#8217;s initial request all the
way to the final rendering of a web page. And since the framework
follows the principles of MVC, it allows you to easily customize
and extend most aspects of your application.</p>
<p>The framework also provides a basic organizational structure, from
filenames to database table names, keeping your entire application
consistent and logical. This concept is simple but powerful. Follow
the conventions and you&#8217;ll always know exactly where things are and
how they&#8217;re organized.</p>
<p>The best way to experience and learn CakePHP is to sit down and build something.
To start off we&#8217;ll build a simple blog application.</p>
<div class="section" id="blog-tutorial">
<h2>Blog Tutorial<a class="headerlink" href="#blog-tutorial" title="Permalink to this headline">¶</a></h2>
<p>Welcome to CakePHP. You&#8217;re probably checking out this tutorial
because you want to learn more about how CakePHP works. It&#8217;s our
aim to increase productivity and make coding more enjoyable: we
hope you&#8217;ll see this as you dive into the code.</p>
<p>This tutorial will walk you through the creation of a simple blog
application. We&#8217;ll be getting and installing CakePHP, creating and
configuring a database, and creating enough application logic to
list, add, edit, and delete blog posts.</p>
<p>Here&#8217;s what you&#8217;ll need:</p>
<ol class="arabic simple">
<li>A running web server. We&#8217;re going to assume you&#8217;re using Apache,
though the instructions for using other servers should be very
similar. We might have to play a little with the server
configuration, but most folks can get CakePHP up and running without
any configuration at all. Make sure you have PHP 5.2.8 or greater.</li>
<li>A database server. We&#8217;re going to be using MySQL server in this
tutorial. You&#8217;ll need to know enough about SQL in order to create a
database: CakePHP will be taking the reins from there. Since we&#8217;re using MySQL,
also make sure that you have <tt class="docutils literal"><span class="pre">pdo_mysql</span></tt> enabled in PHP.</li>
<li>Basic PHP knowledge. The more object-oriented programming you&#8217;ve
done, the better: but fear not if you&#8217;re a procedural fan.</li>
<li>Finally, you&#8217;ll need a basic knowledge of the MVC programming pattern.
A quick overview can be found in
<a class="reference internal" href="cakephp-overview/understanding-model-view-controller.html"><em>Understanding Model-View-Controller</em></a>.  Don&#8217;t worry,
it&#8217;s only half a page or so.</li>
</ol>
<p>Let&#8217;s get started!</p>
<div class="section" id="getting-cakephp">
<h3>Getting CakePHP<a class="headerlink" href="#getting-cakephp" title="Permalink to this headline">¶</a></h3>
<p>First, let&#8217;s get a copy of fresh CakePHP code.</p>
<p>To get a fresh download, visit the CakePHP project on GitHub:
<a class="reference external" href="https://github.com/cakephp/cakephp/tags">https://github.com/cakephp/cakephp/tags</a>
and download the latest release of 2.0</p>
<p>You can also clone the repository using
<a class="reference external" href="http://git-scm.com/">git</a>.
<tt class="docutils literal"><span class="pre">git</span> <span class="pre">clone</span> <span class="pre">git://github.com/cakephp/cakephp.git</span></tt></p>
<p>Regardless of how you downloaded it, place the code inside of your
DocumentRoot. Once finished, your directory setup should look
something like the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="o">/</span><span class="nx">path_to_document_root</span>
    <span class="o">/</span><span class="nx">app</span>
    <span class="o">/</span><span class="nx">lib</span>
    <span class="o">/</span><span class="nx">plugins</span>
    <span class="o">/</span><span class="nx">vendors</span>
    <span class="o">.</span><span class="nx">htaccess</span>
    <span class="nx">index</span><span class="o">.</span><span class="nx">php</span>
    <span class="nx">README</span>
</pre></div>
</div>
<p>Now might be a good time to learn a bit about how CakePHP&#8217;s directory
structure works: check out the
<a class="reference internal" href="getting-started/cakephp-folder-structure.html"><em>CakePHP Folder Structure</em></a> section.</p>
<div class="section" id="tmp-directory-permissions">
<h4>Tmp directory permissions<a class="headerlink" href="#tmp-directory-permissions" title="Permalink to this headline">¶</a></h4>
<p>Next we&#8217;ll need to make the <tt class="docutils literal"><span class="pre">app/tmp</span></tt> directory writable by the webserver.
The best way to do this is to find out what user your webserver
runs as. You can run <tt class="docutils literal"><span class="pre">&lt;?php</span> <span class="pre">echo</span> <span class="pre">exec('whoami');</span> <span class="pre">?&gt;</span></tt> inside any PHP file your
webserver can execute. You should see a username printed. Change the ownership of
the <tt class="docutils literal"><span class="pre">app/tmp</span></tt> directory to that user. The final command you run
(in *nix) might look something like this:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="err">$</span> <span class="nb">chown</span> <span class="o">-</span><span class="nx">R</span> <span class="nx">www</span><span class="o">-</span><span class="nx">data</span> <span class="nx">app</span><span class="o">/</span><span class="nx">tmp</span>
</pre></div>
</div>
<p>If for some reason CakePHP can&#8217;t write to that directory, you&#8217;ll see
warnings and uncaught exceptions that cache data cannot be written.</p>
</div>
</div>
<div class="section" id="creating-the-blog-database">
<h3>Creating the Blog Database<a class="headerlink" href="#creating-the-blog-database" title="Permalink to this headline">¶</a></h3>
<p>Next, let&#8217;s set up the underlying database for our blog. If you
haven&#8217;t already done so, create an empty database for use in this
tutorial, with a name of your choice. Right now, we&#8217;ll just create
a single table to store our posts. We&#8217;ll also throw in a few posts
right now to use for testing purposes. Execute the following SQL
statements into your database:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="cm">/* First, create our posts table: */</span>
<span class="nx">CREATE</span> <span class="nx">TABLE</span> <span class="nx">posts</span> <span class="p">(</span>
    <span class="nx">id</span> <span class="nx">INT</span> <span class="nx">UNSIGNED</span> <span class="nx">AUTO_INCREMENT</span> <span class="nx">PRIMARY</span> <span class="nx">KEY</span><span class="p">,</span>
    <span class="nx">title</span> <span class="nx">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
    <span class="nx">body</span> <span class="nx">TEXT</span><span class="p">,</span>
    <span class="nx">created</span> <span class="nx">DATETIME</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="nx">modified</span> <span class="nx">DATETIME</span> <span class="k">DEFAULT</span> <span class="k">NULL</span>
<span class="p">);</span>

<span class="cm">/* Then insert some posts for testing: */</span>
<span class="nx">INSERT</span> <span class="nx">INTO</span> <span class="nx">posts</span> <span class="p">(</span><span class="nx">title</span><span class="p">,</span> <span class="nx">body</span><span class="p">,</span> <span class="nx">created</span><span class="p">)</span>
    <span class="nx">VALUES</span> <span class="p">(</span><span class="s1">&#39;The title&#39;</span><span class="p">,</span> <span class="s1">&#39;This is the post body.&#39;</span><span class="p">,</span> <span class="nx">NOW</span><span class="p">());</span>
<span class="nx">INSERT</span> <span class="nx">INTO</span> <span class="nx">posts</span> <span class="p">(</span><span class="nx">title</span><span class="p">,</span> <span class="nx">body</span><span class="p">,</span> <span class="nx">created</span><span class="p">)</span>
    <span class="nx">VALUES</span> <span class="p">(</span><span class="s1">&#39;A title once again&#39;</span><span class="p">,</span> <span class="s1">&#39;And the post body follows.&#39;</span><span class="p">,</span> <span class="nx">NOW</span><span class="p">());</span>
<span class="nx">INSERT</span> <span class="nx">INTO</span> <span class="nx">posts</span> <span class="p">(</span><span class="nx">title</span><span class="p">,</span> <span class="nx">body</span><span class="p">,</span> <span class="nx">created</span><span class="p">)</span>
    <span class="nx">VALUES</span> <span class="p">(</span><span class="s1">&#39;Title strikes back&#39;</span><span class="p">,</span> <span class="s1">&#39;This is really exciting! Not.&#39;</span><span class="p">,</span> <span class="nx">NOW</span><span class="p">());</span>
</pre></div>
</div>
<p>The choices on table and column names are not arbitrary. If you
follow CakePHP&#8217;s database naming conventions, and CakePHP&#8217;s class naming
conventions (both outlined in
<a class="reference internal" href="getting-started/cakephp-conventions.html"><em>CakePHP Conventions</em></a>), you&#8217;ll be able to take
advantage of a lot of free functionality and avoid configuration.
CakePHP is flexible enough to accommodate even the worst legacy
database schema, but adhering to convention will save you time.</p>
<p>Check out <a class="reference internal" href="getting-started/cakephp-conventions.html"><em>CakePHP Conventions</em></a> for more
information, but suffice it to say that naming our table &#8216;posts&#8217;
automatically hooks it to our Post model, and having fields called
&#8216;modified&#8217; and &#8216;created&#8217; will be automagically managed by CakePHP.</p>
</div>
<div class="section" id="cakephp-database-configuration">
<h3>CakePHP Database Configuration<a class="headerlink" href="#cakephp-database-configuration" title="Permalink to this headline">¶</a></h3>
<p>Onward and upward: let&#8217;s tell CakePHP where our database is and how to
connect to it. For many, this is the first and last time you
configure anything.</p>
<p>A copy of CakePHP&#8217;s database configuration file is found in
<tt class="docutils literal"><span class="pre">/app/Config/database.php.default</span></tt>. Make a copy of this file in
the same directory, but name it <tt class="docutils literal"><span class="pre">database.php</span></tt>.</p>
<p>The config file should be pretty straightforward: just replace the
values in the <tt class="docutils literal"><span class="pre">$default</span></tt> array with those that apply to your
setup. A sample completed configuration array might look something
like the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="nv">$default</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;datasource&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Database/Mysql&#39;</span><span class="p">,</span>
    <span class="s1">&#39;persistent&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
    <span class="s1">&#39;host&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
    <span class="s1">&#39;port&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;login&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;cakeBlog&#39;</span><span class="p">,</span>
    <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;c4k3-rUl3Z&#39;</span><span class="p">,</span>
    <span class="s1">&#39;database&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;cake_blog_tutorial&#39;</span><span class="p">,</span>
    <span class="s1">&#39;schema&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;prefix&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;encoding&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;utf8&#39;</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Once you&#8217;ve saved your new <tt class="docutils literal"><span class="pre">database.php</span></tt> file, you should be
able to open your browser and see the CakePHP welcome page. It should
also tell you that your database connection file was found, and
that CakePHP can successfully connect to the database.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Remember that you&#8217;ll need to have PDO, and pdo_mysql enabled in
your php.ini.</p>
</div>
</div>
<div class="section" id="optional-configuration">
<h3>Optional Configuration<a class="headerlink" href="#optional-configuration" title="Permalink to this headline">¶</a></h3>
<p>There are a few other items that can be configured. Most developers
complete these laundry-list items, but they&#8217;re not required for
this tutorial. One is defining a custom string (or &#8220;salt&#8221;) for use
in security hashes. The second is defining a custom number (or
&#8220;seed&#8221;) for use in encryption.</p>
<p>The security salt is used for generating hashes. Change the default
<tt class="docutils literal"><span class="pre">Security.salt</span></tt> value in <tt class="docutils literal"><span class="pre">/app/Config/core.php</span></tt>. The replacement value
should be long, hard to guess and be as random as you can make it:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="sd">/**</span>
<span class="sd"> * A random string used in security hashing methods.</span>
<span class="sd"> */</span>
<span class="nx">Configure</span><span class="o">::</span><span class="na">write</span><span class="p">(</span><span class="s1">&#39;Security.salt&#39;</span><span class="p">,</span> <span class="s1">&#39;pl345e-P45s_7h3*S@l7!&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>The cipher seed is used for encrypt/decrypt strings. Change the default
<tt class="docutils literal"><span class="pre">Security.cipherSeed</span></tt> value by editing <tt class="docutils literal"><span class="pre">/app/Config/core.php</span></tt>. The
replacement value should be a large random integer:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="sd">/**</span>
<span class="sd"> * A random numeric string (digits only) used to encrypt/decrypt strings.</span>
<span class="sd"> */</span>
<span class="nx">Configure</span><span class="o">::</span><span class="na">write</span><span class="p">(</span><span class="s1">&#39;Security.cipherSeed&#39;</span><span class="p">,</span> <span class="s1">&#39;7485712659625147843639846751&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="a-note-on-mod-rewrite">
<h3>A Note on mod_rewrite<a class="headerlink" href="#a-note-on-mod-rewrite" title="Permalink to this headline">¶</a></h3>
<p>Occasionally new users will run into mod_rewrite issues. For example
if the CakePHP welcome page looks a little funny (no images or CSS styles),
it probably means mod_rewrite is not functioning on your system. Please refer
to one of the sections below about URL rewriting for your webserver to get
you up and running:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation/url-rewriting.html">URL Rewriting</a></li>
</ul>
</div>
<p>Now continue to <a class="reference internal" href="tutorials-and-examples/blog/part-two.html"><em>Blog Tutorial - Adding a layer</em></a> to start building your first CakePHP application.</p>
</div>
</div>
<div class="section" id="blog-tutorial-adding-a-layer">
<h2>Blog Tutorial - Adding a layer<a class="headerlink" href="#blog-tutorial-adding-a-layer" title="Permalink to this headline">¶</a></h2>
<div class="section" id="create-a-post-model">
<h3>Create a Post Model<a class="headerlink" href="#create-a-post-model" title="Permalink to this headline">¶</a></h3>
<p>The Model class is the bread and butter of CakePHP applications. By
creating a CakePHP model that will interact with our database,
we&#8217;ll have the foundation in place needed to do our view, add,
edit, and delete operations later.</p>
<p>CakePHP&#8217;s model class files go in <tt class="docutils literal"><span class="pre">/app/Model</span></tt>, and the file
we&#8217;ll be creating will be saved to <tt class="docutils literal"><span class="pre">/app/Model/Post.php</span></tt>. The
completed file should look like this:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Post</span> <span class="k">extends</span> <span class="nx">AppModel</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Naming conventions are very important in CakePHP. By naming our model
Post, CakePHP can automatically infer that this model will be used
in the PostsController, and will be tied to a database table called
<tt class="docutils literal"><span class="pre">posts</span></tt>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">CakePHP will dynamically create a model object for you if it
cannot find a corresponding file in /app/Model. This also means
that if you accidentally name your file wrong (for example, post.php
or posts.php instead of Post.php), CakePHP will not recognize
any of your settings and will use the defaults instead.</p>
</div>
<p>For more on models, such as table prefixes, callbacks, and
validation, check out the <a class="reference internal" href="models.html"><em>Models</em></a> chapter of the
Manual.</p>
</div>
<div class="section" id="create-a-posts-controller">
<h3>Create a Posts Controller<a class="headerlink" href="#create-a-posts-controller" title="Permalink to this headline">¶</a></h3>
<p>Next, we&#8217;ll create a controller for our posts. The controller is
where all the business logic for post interaction will happen. In a
nutshell, it&#8217;s the place where you play with the models and get
post-related work done. We&#8217;ll place this new controller in a file
called <tt class="docutils literal"><span class="pre">PostsController.php</span></tt> inside the <tt class="docutils literal"><span class="pre">/app/Controller</span></tt>
directory. Here&#8217;s what the basic controller should look like:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PostsController</span> <span class="k">extends</span> <span class="nx">AppController</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$helpers</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Html&#39;</span><span class="p">,</span> <span class="s1">&#39;Form&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now, let&#8217;s add an action to our controller. Actions often represent
a single function or interface in an application. For example, when
users request www.example.com/posts/index (which is the same
as www.example.com/posts/), they might expect to see a listing of
posts. The code for that action would look something like this:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PostsController</span> <span class="k">extends</span> <span class="nx">AppController</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$helpers</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Html&#39;</span><span class="p">,</span> <span class="s1">&#39;Form&#39;</span><span class="p">);</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;posts&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>By defining function <tt class="docutils literal"><span class="pre">index()</span></tt>
in our PostsController, users can access the logic there by
requesting www.example.com/posts/index. Similarly, if we were to
define a function called <tt class="docutils literal"><span class="pre">foobar()</span></tt>, users would be able to
access that at www.example.com/posts/foobar.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">You may be tempted to name your controllers and actions a certain
way to obtain a certain URL. Resist that temptation. Follow CakePHP
conventions (capitalization, plural names, etc.) and create readable,
understandable action names. You can map URLs to your code using
&#8220;routes&#8221; covered later on.</p>
</div>
<p>The single instruction in the action uses <tt class="docutils literal"><span class="pre">set()</span></tt> to pass data
from the controller to the view (which we&#8217;ll create next). The line
sets the view variable called &#8216;posts&#8217; equal to the return value of
the <tt class="docutils literal"><span class="pre">find('all')</span></tt> method of the Post model. Our Post model is
automatically available at <tt class="docutils literal"><span class="pre">$this-&gt;Post</span></tt> because we&#8217;ve followed
CakePHP&#8217;s naming conventions.</p>
<p>To learn more about CakePHP&#8217;s controllers, check out the
<a class="reference internal" href="controllers.html"><em>Controllers</em></a> chapter.</p>
</div>
<div class="section" id="creating-post-views">
<h3>Creating Post Views<a class="headerlink" href="#creating-post-views" title="Permalink to this headline">¶</a></h3>
<p>Now that we have our data flowing to our model, and our application
logic and flow defined by our controller, let&#8217;s create a view for
the index action we created above.</p>
<p>CakePHP views are just presentation-flavored fragments that fit inside
an application&#8217;s layout. For most applications, they&#8217;re HTML mixed
with PHP, but they may end up as XML, CSV, or even binary data.</p>
<p>A layout is presentation code that is wrapped around a view.
Multiple layouts can be defined, and you can switch between
them, but for now, let&#8217;s just use the default.</p>
<p>Remember how in the last section we assigned the &#8216;posts&#8217; variable
to the view using the <tt class="docutils literal"><span class="pre">set()</span></tt> method? That would pass data
to the view that would look something like this:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// print_r($posts) output:</span>

<span class="k">Array</span>
<span class="p">(</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="k">Array</span>
        <span class="p">(</span>
            <span class="p">[</span><span class="nx">Post</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="k">Array</span>
                <span class="p">(</span>
                    <span class="p">[</span><span class="nx">id</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">1</span>
                    <span class="p">[</span><span class="nx">title</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="nx">The</span> <span class="nx">title</span>
                    <span class="p">[</span><span class="nx">body</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="k">This</span> <span class="nx">is</span> <span class="nx">the</span> <span class="nx">post</span> <span class="nx">body</span><span class="o">.</span>
                    <span class="p">[</span><span class="nx">created</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">2008</span><span class="o">-</span><span class="mo">02</span><span class="o">-</span><span class="mi">13</span> <span class="mi">18</span><span class="o">:</span><span class="mi">34</span><span class="o">:</span><span class="mi">55</span>
                    <span class="p">[</span><span class="nx">modified</span><span class="p">]</span> <span class="o">=&gt;</span>
                <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="k">Array</span>
        <span class="p">(</span>
            <span class="p">[</span><span class="nx">Post</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="k">Array</span>
                <span class="p">(</span>
                    <span class="p">[</span><span class="nx">id</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">2</span>
                    <span class="p">[</span><span class="nx">title</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="nx">A</span> <span class="nx">title</span> <span class="nx">once</span> <span class="nx">again</span>
                    <span class="p">[</span><span class="nx">body</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="k">And</span> <span class="nx">the</span> <span class="nx">post</span> <span class="nx">body</span> <span class="nx">follows</span><span class="o">.</span>
                    <span class="p">[</span><span class="nx">created</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">2008</span><span class="o">-</span><span class="mo">02</span><span class="o">-</span><span class="mi">13</span> <span class="mi">18</span><span class="o">:</span><span class="mi">34</span><span class="o">:</span><span class="mi">56</span>
                    <span class="p">[</span><span class="nx">modified</span><span class="p">]</span> <span class="o">=&gt;</span>
                <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="k">Array</span>
        <span class="p">(</span>
            <span class="p">[</span><span class="nx">Post</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="k">Array</span>
                <span class="p">(</span>
                    <span class="p">[</span><span class="nx">id</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">3</span>
                    <span class="p">[</span><span class="nx">title</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="nx">Title</span> <span class="nx">strikes</span> <span class="nx">back</span>
                    <span class="p">[</span><span class="nx">body</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="k">This</span> <span class="nx">is</span> <span class="nx">really</span> <span class="nx">exciting</span><span class="o">!</span> <span class="k">Not</span><span class="o">.</span>
                    <span class="p">[</span><span class="nx">created</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">2008</span><span class="o">-</span><span class="mo">02</span><span class="o">-</span><span class="mi">13</span> <span class="mi">18</span><span class="o">:</span><span class="mi">34</span><span class="o">:</span><span class="mi">57</span>
                    <span class="p">[</span><span class="nx">modified</span><span class="p">]</span> <span class="o">=&gt;</span>
                <span class="p">)</span>
        <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>CakePHP&#8217;s view files are stored in <tt class="docutils literal"><span class="pre">/app/View</span></tt> inside a folder
named after the controller to which they correspond. (We&#8217;ll have to create
a folder named &#8216;Posts&#8217; in this case.) To format this post data into a
nice table, our view code might look something like this</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="x">&lt;!-- File: /app/View/Posts/index.ctp --&gt;</span>

<span class="x">&lt;h1&gt;Blog posts&lt;/h1&gt;</span>
<span class="x">&lt;table&gt;</span>
<span class="x">    &lt;tr&gt;</span>
<span class="x">        &lt;th&gt;Id&lt;/th&gt;</span>
<span class="x">        &lt;th&gt;Title&lt;/th&gt;</span>
<span class="x">        &lt;th&gt;Created&lt;/th&gt;</span>
<span class="x">    &lt;/tr&gt;</span>

<span class="x">    &lt;!-- Here is where we loop through our $posts array, printing out post info --&gt;</span>

<span class="x">    </span><span class="cp">&lt;?php</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$posts</span> <span class="k">as</span> <span class="nv">$post</span><span class="p">)</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &lt;tr&gt;</span>
<span class="x">        &lt;td&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&lt;/td&gt;</span>
<span class="x">        &lt;td&gt;</span>
<span class="x">            </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">(</span><span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">],</span>
<span class="k">array</span><span class="p">(</span><span class="s1">&#39;controller&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;posts&#39;</span><span class="p">,</span> <span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;view&#39;</span><span class="p">,</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]));</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">        &lt;/td&gt;</span>
<span class="x">        &lt;td&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;created&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&lt;/td&gt;</span>
<span class="x">    &lt;/tr&gt;</span>
<span class="x">    </span><span class="cp">&lt;?php</span> <span class="k">endforeach</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    </span><span class="cp">&lt;?php</span> <span class="nb">unset</span><span class="p">(</span><span class="nv">$post</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">&lt;/table&gt;</span>
</pre></div>
</div>
<p>You might have noticed the use of an object called <tt class="docutils literal"><span class="pre">$this-&gt;Html</span></tt>.
This is an instance of the CakePHP <a class="reference internal" href="core-libraries/helpers/html.html#HtmlHelper" title="HtmlHelper"><tt class="xref php php-class docutils literal"><span class="pre">HtmlHelper</span></tt></a> class. CakePHP
comes with a set of view helpers that make things like linking,
form output, JavaScript and AJAX a snap. You can learn more about
how to use them in <a class="reference internal" href="views/helpers.html"><em>Helpers</em></a>, but
what&#8217;s important to note here is that the <tt class="docutils literal"><span class="pre">link()</span></tt> method will
generate an HTML link with the given title (the first parameter)
and URL (the second parameter).</p>
<p>When specifying URLs in CakePHP, it is recommended that you use the
array format. This is explained in more detail in the section on
Routes. Using the array format for URLs allows you to take
advantage of CakePHP&#8217;s reverse routing capabilities. You can also
specify URLs relative to the base of the application in the form of
/controller/action/param1/param2.</p>
<p>At this point, you should be able to point your browser to
<a class="reference external" href="http://www.example.com/posts/index">http://www.example.com/posts/index</a>. You should see your view,
correctly formatted with the title and table listing of the posts.</p>
<p>If you happened to have clicked on one of the links we created in
this view (which link a post&#8217;s title to a URL /posts/view/some_id),
you were probably informed by CakePHP that the action hadn&#8217;t yet
been defined. If you were not so informed, either something has
gone wrong, or you actually did define it already, in which case
you are very sneaky. Otherwise, we&#8217;ll create it in the
PostsController now:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// File: /app/Controller/PostsController.php</span>
<span class="k">class</span> <span class="nc">PostsController</span> <span class="k">extends</span> <span class="nx">AppController</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$helpers</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Html&#39;</span><span class="p">,</span> <span class="s1">&#39;Form&#39;</span><span class="p">);</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">()</span> <span class="p">{</span>
         <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;posts&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">view</span><span class="p">(</span><span class="nv">$id</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$id</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">NotFoundException</span><span class="p">(</span><span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Invalid post&#39;</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="nv">$post</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">findById</span><span class="p">(</span><span class="nv">$id</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$post</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">NotFoundException</span><span class="p">(</span><span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Invalid post&#39;</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="nv">$post</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">set()</span></tt> call should look familiar. Notice we&#8217;re using
<tt class="docutils literal"><span class="pre">findById()</span></tt> rather than <tt class="docutils literal"><span class="pre">find('all')</span></tt> because we only want
a single post&#8217;s information.</p>
<p>Notice that our view action takes a parameter: the ID of the post
we&#8217;d like to see. This parameter is handed to the action through
the requested URL. If a user requests <tt class="docutils literal"><span class="pre">/posts/view/3</span></tt>, then the value
&#8216;3&#8217; is passed as <tt class="docutils literal"><span class="pre">$id</span></tt>.</p>
<p>We also do a bit of error checking to ensure that a user is actually
accessing a record. If a user requests <tt class="docutils literal"><span class="pre">/posts/view</span></tt>, we will throw a
<tt class="docutils literal"><span class="pre">NotFoundException</span></tt> and let the CakePHP ErrorHandler take over. We
also perform a similar check to make sure the user has accessed a
record that exists.</p>
<p>Now let&#8217;s create the view for our new &#8216;view&#8217; action and place it in
<tt class="docutils literal"><span class="pre">/app/View/Posts/view.ctp</span></tt></p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="x">&lt;!-- File: /app/View/Posts/view.ctp --&gt;</span>

<span class="x">&lt;h1&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">h</span><span class="p">(</span><span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="x">&lt;/h1&gt;</span>

<span class="x">&lt;p&gt;&lt;small&gt;Created: </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;created&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&lt;/small&gt;&lt;/p&gt;</span>

<span class="x">&lt;p&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">h</span><span class="p">(</span><span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;body&#39;</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="x">&lt;/p&gt;</span>
</pre></div>
</div>
<p>Verify that this is working by trying the links at <tt class="docutils literal"><span class="pre">/posts/index</span></tt> or
manually requesting a post by accessing <tt class="docutils literal"><span class="pre">/posts/view/1</span></tt>.</p>
</div>
<div class="section" id="adding-posts">
<h3>Adding Posts<a class="headerlink" href="#adding-posts" title="Permalink to this headline">¶</a></h3>
<p>Reading from the database and showing us the posts is a great
start, but let&#8217;s allow for adding new posts.</p>
<p>First, start by creating an <tt class="docutils literal"><span class="pre">add()</span></tt> action in the
PostsController:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PostsController</span> <span class="k">extends</span> <span class="nx">AppController</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$helpers</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Html&#39;</span><span class="p">,</span> <span class="s1">&#39;Form&#39;</span><span class="p">,</span> <span class="s1">&#39;Session&#39;</span><span class="p">);</span>
    <span class="k">public</span> <span class="nv">$components</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Session&#39;</span><span class="p">);</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;posts&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">view</span><span class="p">(</span><span class="nv">$id</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$id</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">NotFoundException</span><span class="p">(</span><span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Invalid post&#39;</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="nv">$post</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">findById</span><span class="p">(</span><span class="nv">$id</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$post</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">NotFoundException</span><span class="p">(</span><span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Invalid post&#39;</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="nv">$post</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">add</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">))</span> <span class="p">{</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Session</span><span class="o">-&gt;</span><span class="na">setFlash</span><span class="p">(</span><span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Your post has been saved.&#39;</span><span class="p">));</span>
                <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;index&#39;</span><span class="p">));</span>
            <span class="p">}</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Session</span><span class="o">-&gt;</span><span class="na">setFlash</span><span class="p">(</span><span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Unable to add your post.&#39;</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><tt class="docutils literal"><span class="pre">$this-&gt;request-&gt;is()</span></tt> takes a single argument, which can be the
request METHOD (<tt class="docutils literal"><span class="pre">get</span></tt>, <tt class="docutils literal"><span class="pre">put</span></tt>, <tt class="docutils literal"><span class="pre">post</span></tt>, <tt class="docutils literal"><span class="pre">delete</span></tt>) or some request
identifier (<tt class="docutils literal"><span class="pre">ajax</span></tt>). It is <strong>not</strong> a way to check for specific posted
data. For instance, <tt class="docutils literal"><span class="pre">$this-&gt;request-&gt;is('book')</span></tt> will not return true
if book data was posted.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You need to include the SessionComponent - and SessionHelper - in
any controller where you will use it. If necessary, include it in
your AppController.</p>
</div>
<p>Here&#8217;s what the <tt class="docutils literal"><span class="pre">add()</span></tt> action does: if the HTTP method of the
request was POST, it tries to save the data using the Post model. If for some
reason it doesn&#8217;t save, it just renders the view. This gives us a
chance to show the user validation errors or other warnings.</p>
<p>Every CakePHP request includes a <tt class="docutils literal"><span class="pre">CakeRequest</span></tt> object which is accessible using
<tt class="docutils literal"><span class="pre">$this-&gt;request</span></tt>. The request object contains useful information regarding the
request that was just received, and can be used to control the flow of your application.
In this case, we use the <a class="reference internal" href="controllers/request-response.html#CakeRequest::is" title="CakeRequest::is"><tt class="xref php php-meth docutils literal"><span class="pre">CakeRequest::is()</span></tt></a> method to check that the request is a HTTP POST request.</p>
<p>When a user uses a form to POST data to your application, that
information is available in <tt class="docutils literal"><span class="pre">$this-&gt;request-&gt;data</span></tt>. You can use the
<a class="reference internal" href="core-libraries/global-constants-and-functions.html#pr" title="pr"><tt class="xref php php-func docutils literal"><span class="pre">pr()</span></tt></a> or <a class="reference internal" href="development/debugging.html#debug" title="debug"><tt class="xref php php-func docutils literal"><span class="pre">debug()</span></tt></a> functions to print it out if you want to see
what it looks like.</p>
<p>We use the SessionComponent&#8217;s <a class="reference internal" href="core-libraries/components/sessions.html#SessionComponent::setFlash" title="SessionComponent::setFlash"><tt class="xref php php-meth docutils literal"><span class="pre">SessionComponent::setFlash()</span></tt></a>
method to set a message to a session variable to be displayed on the page after
redirection. In the layout we have
<a class="reference internal" href="core-libraries/helpers/session.html#SessionHelper::flash" title="SessionHelper::flash"><tt class="xref php php-func docutils literal"><span class="pre">SessionHelper::flash</span></tt></a> which displays the
message and clears the corresponding session variable. The
controller&#8217;s <a class="reference internal" href="controllers.html#Controller::redirect" title="Controller::redirect"><tt class="xref php php-meth docutils literal"><span class="pre">Controller::redirect</span></tt></a> function
redirects to another URL. The param <tt class="docutils literal"><span class="pre">array('action'</span> <span class="pre">=&gt;</span> <span class="pre">'index')</span></tt>
translates to URL /posts (that is, the index action of the posts controller).
You can refer to <a class="reference internal" href="development/routing.html#Router::url" title="Router::url"><tt class="xref php php-func docutils literal"><span class="pre">Router::url()</span></tt></a> function on the
<a class="reference external" href="http://api.cakephp.org">API</a> to see the formats in which you can specify a
URL for various CakePHP functions.</p>
<p>Calling the <tt class="docutils literal"><span class="pre">save()</span></tt> method will check for validation errors and
abort the save if any occur. We&#8217;ll discuss how those errors are
handled in the following sections.</p>
<p>We call the <tt class="docutils literal"><span class="pre">create()</span></tt> method first in order to reset the model
state for saving new information. It does not actually create a record in the
database, but clears Model::$id and sets Model::$data based on your database
field defaults.</p>
</div>
<div class="section" id="data-validation">
<h3>Data Validation<a class="headerlink" href="#data-validation" title="Permalink to this headline">¶</a></h3>
<p>CakePHP goes a long way toward taking the monotony out of form input
validation. Everyone hates coding up endless forms and their
validation routines. CakePHP makes it easier and faster.</p>
<p>To take advantage of the validation features, you&#8217;ll need to use
CakePHP&#8217;s FormHelper in your views. The <a class="reference internal" href="core-libraries/helpers/form.html#FormHelper" title="FormHelper"><tt class="xref php php-class docutils literal"><span class="pre">FormHelper</span></tt></a> is available by
default to all views at <tt class="docutils literal"><span class="pre">$this-&gt;Form</span></tt>.</p>
<p>Here&#8217;s our add view:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="x">&lt;!-- File: /app/View/Posts/add.ctp --&gt;</span>

<span class="x">&lt;h1&gt;Add Post&lt;/h1&gt;</span>
<span class="cp">&lt;?php</span>
<span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="s1">&#39;Post&#39;</span><span class="p">);</span>
<span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">input</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">);</span>
<span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">input</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;rows&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;3&#39;</span><span class="p">));</span>
<span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">end</span><span class="p">(</span><span class="s1">&#39;Save Post&#39;</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
<p>We use the FormHelper to generate the opening tag for an HTML
form. Here&#8217;s the HTML that <tt class="docutils literal"><span class="pre">$this-&gt;Form-&gt;create()</span></tt> generates:</p>
<div class="highlight-html"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">form</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;PostAddForm&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;post&quot;</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;/posts/add&quot;</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>If <tt class="docutils literal"><span class="pre">create()</span></tt> is called with no parameters supplied, it assumes
you are building a form that submits via POST to the current controller&#8217;s
<tt class="docutils literal"><span class="pre">add()</span></tt> action (or <tt class="docutils literal"><span class="pre">edit()</span></tt> action when <tt class="docutils literal"><span class="pre">id</span></tt> is included in
the form data).</p>
<p>The <tt class="docutils literal"><span class="pre">$this-&gt;Form-&gt;input()</span></tt> method is used to create form elements
of the same name. The first parameter tells CakePHP which field
they correspond to, and the second parameter allows you to specify
a wide array of options - in this case, the number of rows for the
textarea. There&#8217;s a bit of introspection and automagic here:
<tt class="docutils literal"><span class="pre">input()</span></tt> will output different form elements based on the model
field specified.</p>
<p>The <tt class="docutils literal"><span class="pre">$this-&gt;Form-&gt;end()</span></tt> call generates a submit button and ends
the form. If a string is supplied as the first parameter to
<tt class="docutils literal"><span class="pre">end()</span></tt>, the FormHelper outputs a submit button named accordingly
along with the closing form tag. Again, refer to
<a class="reference internal" href="views/helpers.html"><em>Helpers</em></a> for more on helpers.</p>
<p>Now let&#8217;s go back and update our <tt class="docutils literal"><span class="pre">/app/View/Posts/index.ctp</span></tt>
view to include a new &#8220;Add Post&#8221; link. Before the <tt class="docutils literal"><span class="pre">&lt;table&gt;</span></tt>, add
the following line:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span> <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">(</span>
    <span class="s1">&#39;Add Post&#39;</span><span class="p">,</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;controller&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;posts&#39;</span><span class="p">,</span> <span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;add&#39;</span><span class="p">)</span>
<span class="p">);</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
<p>You may be wondering: how do I tell CakePHP about my validation
requirements? Validation rules are defined in the model. Let&#8217;s look
back at our Post model and make a few adjustments:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Post</span> <span class="k">extends</span> <span class="nx">AppModel</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$validate</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;rule&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;notBlank&#39;</span>
        <span class="p">),</span>
        <span class="s1">&#39;body&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;rule&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;notBlank&#39;</span>
        <span class="p">)</span>
    <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">$validate</span></tt> array tells CakePHP how to validate your data
when the <tt class="docutils literal"><span class="pre">save()</span></tt> method is called. Here, I&#8217;ve specified that
both the body and title fields must not be empty. CakePHP&#8217;s
validation engine is strong, with a number of pre-built rules
(credit card numbers, email addresses, etc.) and flexibility for
adding your own validation rules. For more information,
check the <a class="reference internal" href="models/data-validation.html"><em>Data Validation</em></a>.</p>
<p>Now that you have your validation rules in place, use the app to
try to add a post with an empty title or body to see how it works.
Since we&#8217;ve used the <a class="reference internal" href="core-libraries/helpers/form.html#FormHelper::input" title="FormHelper::input"><tt class="xref php php-meth docutils literal"><span class="pre">FormHelper::input()</span></tt></a> method of the
FormHelper to create our form elements, our validation error
messages will be shown automatically.</p>
</div>
<div class="section" id="editing-posts">
<h3>Editing Posts<a class="headerlink" href="#editing-posts" title="Permalink to this headline">¶</a></h3>
<p>Post editing: here we go. You&#8217;re a CakePHP pro by now, so you
should have picked up a pattern. Make the action, then the view.
Here&#8217;s what the <tt class="docutils literal"><span class="pre">edit()</span></tt> action of the PostsController would look
like:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">edit</span><span class="p">(</span><span class="nv">$id</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$id</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nx">NotFoundException</span><span class="p">(</span><span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Invalid post&#39;</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="nv">$post</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">findById</span><span class="p">(</span><span class="nv">$id</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$post</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nx">NotFoundException</span><span class="p">(</span><span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Invalid post&#39;</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="s1">&#39;put&#39;</span><span class="p">)))</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">id</span> <span class="o">=</span> <span class="nv">$id</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Session</span><span class="o">-&gt;</span><span class="na">setFlash</span><span class="p">(</span><span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Your post has been updated.&#39;</span><span class="p">));</span>
            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;index&#39;</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Session</span><span class="o">-&gt;</span><span class="na">setFlash</span><span class="p">(</span><span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Unable to update your post.&#39;</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span> <span class="o">=</span> <span class="nv">$post</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This action first ensures that the user has tried to access an existing record.
If they haven&#8217;t passed in an <tt class="docutils literal"><span class="pre">$id</span></tt> parameter, or the post does not
exist, we throw a <tt class="docutils literal"><span class="pre">NotFoundException</span></tt> for the CakePHP ErrorHandler to take care of.</p>
<p>Next the action checks whether the request is either a POST or a PUT request. If it is, then we
use the POST data to update our Post record, or kick back and show the user
validation errors.</p>
<p>If there is no data set to <tt class="docutils literal"><span class="pre">$this-&gt;request-&gt;data</span></tt>, we simply set it to the
previously retrieved post.</p>
<p>The edit view might look something like this:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="x">&lt;!-- File: /app/View/Posts/edit.ctp --&gt;</span>

<span class="x">&lt;h1&gt;Edit Post&lt;/h1&gt;</span>
<span class="cp">&lt;?php</span>
<span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="s1">&#39;Post&#39;</span><span class="p">);</span>
<span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">input</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">);</span>
<span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">input</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;rows&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;3&#39;</span><span class="p">));</span>
<span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">input</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;hidden&#39;</span><span class="p">));</span>
<span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">end</span><span class="p">(</span><span class="s1">&#39;Save Post&#39;</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
<p>This view outputs the edit form (with the values populated), along
with any necessary validation error messages.</p>
<p>One thing to note here: CakePHP will assume that you are editing a
model if the &#8216;id&#8217; field is present in the data array. If no &#8216;id&#8217; is
present (look back at our add view), CakePHP will assume that you are
inserting a new model when <tt class="docutils literal"><span class="pre">save()</span></tt> is called.</p>
<p>You can now update your index view with links to edit specific
posts:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="x">&lt;!-- File: /app/View/Posts/index.ctp  (edit links added) --&gt;</span>

<span class="x">&lt;h1&gt;Blog posts&lt;/h1&gt;</span>
<span class="x">&lt;p&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">(</span><span class="s2">&quot;Add Post&quot;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;add&#39;</span><span class="p">));</span> <span class="cp">?&gt;</span><span class="x">&lt;/p&gt;</span>
<span class="x">&lt;table&gt;</span>
<span class="x">    &lt;tr&gt;</span>
<span class="x">        &lt;th&gt;Id&lt;/th&gt;</span>
<span class="x">        &lt;th&gt;Title&lt;/th&gt;</span>
<span class="x">        &lt;th&gt;Action&lt;/th&gt;</span>
<span class="x">        &lt;th&gt;Created&lt;/th&gt;</span>
<span class="x">    &lt;/tr&gt;</span>

<span class="x">&lt;!-- Here&#39;s where we loop through our $posts array, printing out post info --&gt;</span>

<span class="cp">&lt;?php</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$posts</span> <span class="k">as</span> <span class="nv">$post</span><span class="p">)</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &lt;tr&gt;</span>
<span class="x">        &lt;td&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&lt;/td&gt;</span>
<span class="x">        &lt;td&gt;</span>
<span class="x">            </span><span class="cp">&lt;?php</span>
                <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">(</span>
                    <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">],</span>
                    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;view&#39;</span><span class="p">,</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
                <span class="p">);</span>
            <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">        &lt;/td&gt;</span>
<span class="x">        &lt;td&gt;</span>
<span class="x">            </span><span class="cp">&lt;?php</span>
                <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">(</span>
                    <span class="s1">&#39;Edit&#39;</span><span class="p">,</span>
                    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;edit&#39;</span><span class="p">,</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
                <span class="p">);</span>
            <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">        &lt;/td&gt;</span>
<span class="x">        &lt;td&gt;</span>
<span class="x">            </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;created&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">        &lt;/td&gt;</span>
<span class="x">    &lt;/tr&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">endforeach</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>

<span class="x">&lt;/table&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="deleting-posts">
<h3>Deleting Posts<a class="headerlink" href="#deleting-posts" title="Permalink to this headline">¶</a></h3>
<p>Next, let&#8217;s make a way for users to delete posts. Start with a
<tt class="docutils literal"><span class="pre">delete()</span></tt> action in the PostsController:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">delete</span><span class="p">(</span><span class="nv">$id</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;get&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nx">MethodNotAllowedException</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">(</span><span class="nv">$id</span><span class="p">))</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Session</span><span class="o">-&gt;</span><span class="na">setFlash</span><span class="p">(</span>
            <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;The post with id: %s has been deleted.&#39;</span><span class="p">,</span> <span class="nx">h</span><span class="p">(</span><span class="nv">$id</span><span class="p">))</span>
        <span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Session</span><span class="o">-&gt;</span><span class="na">setFlash</span><span class="p">(</span>
            <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;The post with id: %s could not be deleted.&#39;</span><span class="p">,</span> <span class="nx">h</span><span class="p">(</span><span class="nv">$id</span><span class="p">))</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;index&#39;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This logic deletes the post specified by $id, and uses
<tt class="docutils literal"><span class="pre">$this-&gt;Session-&gt;setFlash()</span></tt> to show the user a confirmation
message after redirecting them on to <tt class="docutils literal"><span class="pre">/posts</span></tt>. If the user attempts to
do a delete using a GET request, we throw an Exception. Uncaught exceptions
are captured by CakePHP&#8217;s exception handler, and a nice error page is
displayed. There are many built-in <a class="reference internal" href="development/exceptions.html"><em>Exceptions</em></a> that can
be used to indicate the various HTTP errors your application might need
to generate.</p>
<p>Because we&#8217;re just executing some logic and redirecting, this
action has no view. You might want to update your index view with
links that allow users to delete posts, however:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="x">&lt;!-- File: /app/View/Posts/index.ctp --&gt;</span>

<span class="x">&lt;h1&gt;Blog posts&lt;/h1&gt;</span>
<span class="x">&lt;p&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">(</span><span class="s1">&#39;Add Post&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;add&#39;</span><span class="p">));</span> <span class="cp">?&gt;</span><span class="x">&lt;/p&gt;</span>
<span class="x">&lt;table&gt;</span>
<span class="x">    &lt;tr&gt;</span>
<span class="x">        &lt;th&gt;Id&lt;/th&gt;</span>
<span class="x">        &lt;th&gt;Title&lt;/th&gt;</span>
<span class="x">        &lt;th&gt;Actions&lt;/th&gt;</span>
<span class="x">        &lt;th&gt;Created&lt;/th&gt;</span>
<span class="x">    &lt;/tr&gt;</span>

<span class="x">&lt;!-- Here&#39;s where we loop through our $posts array, printing out post info --&gt;</span>

<span class="x">    </span><span class="cp">&lt;?php</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$posts</span> <span class="k">as</span> <span class="nv">$post</span><span class="p">)</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &lt;tr&gt;</span>
<span class="x">        &lt;td&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&lt;/td&gt;</span>
<span class="x">        &lt;td&gt;</span>
<span class="x">            </span><span class="cp">&lt;?php</span>
                <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">(</span>
                    <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">],</span>
                    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;view&#39;</span><span class="p">,</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
                <span class="p">);</span>
            <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">        &lt;/td&gt;</span>
<span class="x">        &lt;td&gt;</span>
<span class="x">            </span><span class="cp">&lt;?php</span>
                <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">postLink</span><span class="p">(</span>
                    <span class="s1">&#39;Delete&#39;</span><span class="p">,</span>
                    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;delete&#39;</span><span class="p">,</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]),</span>
                    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;confirm&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Are you sure?&#39;</span><span class="p">)</span>
                <span class="p">);</span>
            <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">            </span><span class="cp">&lt;?php</span>
                <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">(</span>
                    <span class="s1">&#39;Edit&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;edit&#39;</span><span class="p">,</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
                <span class="p">);</span>
            <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">        &lt;/td&gt;</span>
<span class="x">        &lt;td&gt;</span>
<span class="x">            </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;created&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">        &lt;/td&gt;</span>
<span class="x">    &lt;/tr&gt;</span>
<span class="x">    </span><span class="cp">&lt;?php</span> <span class="k">endforeach</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>

<span class="x">&lt;/table&gt;</span>
</pre></div>
</div>
<p>Using <a class="reference internal" href="core-libraries/helpers/form.html#FormHelper::postLink" title="FormHelper::postLink"><tt class="xref php php-meth docutils literal"><span class="pre">postLink()</span></tt></a> will create a link that uses
JavaScript to do a POST request to delete our post. Allowing content to be
deleted using GET requests is dangerous, as web crawlers could accidentally
delete all your content.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This view code also uses the FormHelper to prompt the user with a
JavaScript confirmation dialog before they attempt to delete a
post.</p>
</div>
</div>
<div class="section" id="routes">
<h3>Routes<a class="headerlink" href="#routes" title="Permalink to this headline">¶</a></h3>
<p>For some, CakePHP&#8217;s default routing works well enough. Developers
who are sensitive to user-friendliness and general search engine
compatibility will appreciate the way that CakePHP&#8217;s URLs map to
specific actions. So we&#8217;ll just make a quick change to routes in
this tutorial.</p>
<p>For more information on advanced routing techniques, see
<a class="reference internal" href="development/routing.html#routes-configuration"><em>Routes Configuration</em></a>.</p>
<p>By default, CakePHP responds to a request for the root of your site
(e.g., <a class="reference external" href="http://www.example.com">http://www.example.com</a>) using its PagesController, rendering
a view called &#8220;home&#8221;. Instead, we&#8217;ll replace this with our
PostsController by creating a routing rule.</p>
<p>CakePHP&#8217;s routing is found in <tt class="docutils literal"><span class="pre">/app/Config/routes.php</span></tt>. You&#8217;ll want
to comment out or remove the line that defines the default root
route. It looks like this:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="x">Router::connect(</span>
<span class="x">    &#39;/&#39;,</span>
<span class="x">    array(&#39;controller&#39; =&gt; &#39;pages&#39;, &#39;action&#39; =&gt; &#39;display&#39;, &#39;home&#39;)</span>
<span class="x">);</span>
</pre></div>
</div>
<p>This line connects the URL &#8216;/&#8217; with the default CakePHP home page.
We want it to connect with our own controller, so replace that line
with this one:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">Router</span><span class="o">::</span><span class="na">connect</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;controller&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;posts&#39;</span><span class="p">,</span> <span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;index&#39;</span><span class="p">));</span>
</pre></div>
</div>
<p>This should connect users requesting &#8216;/&#8217; to the index() action of
our PostsController.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">CakePHP also makes use of &#8216;reverse routing&#8217;. If, with the above
route defined, you pass
<tt class="docutils literal"><span class="pre">array('controller'</span> <span class="pre">=&gt;</span> <span class="pre">'posts',</span> <span class="pre">'action'</span> <span class="pre">=&gt;</span> <span class="pre">'index')</span></tt> to a
function expecting an array, the resulting URL used will be &#8216;/&#8217;.
It&#8217;s therefore a good idea to always use arrays for URLs, as this
means your routes define where a URL goes, and also ensures that
links point to the same place.</p>
</div>
</div>
<div class="section" id="conclusion">
<h3>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h3>
<p>Creating applications this way will win you peace, honor, love, and
money beyond even your wildest fantasies. Simple, isn&#8217;t it? Keep in
mind that this tutorial was very basic. CakePHP has <em>many</em> more
features to offer, and is flexible in ways we didn&#8217;t wish to cover
here for simplicity&#8217;s sake. Use the rest of this manual as a guide
for building more feature-rich applications.</p>
<p>Now that you&#8217;ve created a basic CakePHP application, you&#8217;re ready for
the real thing. Start your own project and read the rest of the
<a class="reference internal" href="index.html"><em>Cookbook</em></a> and <a class="reference external" href="http://api.cakephp.org">API</a>.</p>
<p>If you need help, there are many ways to get the help you need - please see the <a class="reference internal" href="cakephp-overview/where-to-get-help.html"><em>Where to Get Help</em></a> page.
Welcome to CakePHP!</p>
<div class="section" id="suggested-follow-up-reading">
<h4>Suggested Follow-up Reading<a class="headerlink" href="#suggested-follow-up-reading" title="Permalink to this headline">¶</a></h4>
<p>These are common tasks people learning CakePHP usually want to study next:</p>
<ol class="arabic simple">
<li><a class="reference internal" href="views.html#view-layouts"><em>Layouts</em></a>: Customizing your website layout</li>
<li><a class="reference internal" href="views.html#view-elements"><em>Elements</em></a>: Including and reusing view snippets</li>
<li><a class="reference internal" href="controllers/scaffolding.html"><em>Scaffolding</em></a>: Prototyping before creating code</li>
<li><a class="reference internal" href="console-and-shells/code-generation-with-bake.html"><em>Code Generation with Bake</em></a>: Generating basic CRUD code</li>
<li><a class="reference internal" href="tutorials-and-examples/blog-auth-example/auth.html"><em>Simple Authentication and Authorization Application</em></a>: User authentication and authorization tutorial</li>
</ol>
</div>
</div>
<div class="section" id="additional-reading">
<h3>Additional Reading<a class="headerlink" href="#additional-reading" title="Permalink to this headline">¶</a></h3>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting-started/a-typical-cakephp-request.html">A Typical CakePHP Request</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started/cakephp-conventions.html">CakePHP Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started/cakephp-folder-structure.html">CakePHP Folder Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started/cakephp-structure.html">CakePHP Structure</a></li>
</ul>
</div>
</div>
</div>
</div>


		</div>
	</div>

	<div class="sidebar columns three pull-nine">
<div id="sidebar-navigation" class="hide-on-phones">
	<h2 class="hide-on-desktops">Table of Contents</h2>
	<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation/url-rewriting.html">URL Rewriting</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting-started/a-typical-cakephp-request.html">A Typical CakePHP Request</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting-started/cakephp-conventions.html">CakePHP Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting-started/cakephp-folder-structure.html">CakePHP Folder Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting-started/cakephp-structure.html">CakePHP Structure</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cakephp-overview.html">CakePHP Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="controllers.html">Controllers</a></li>
<li class="toctree-l1"><a class="reference internal" href="views.html">Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-libraries.html">Core Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="console-and-shells.html">Console and Shells</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials-and-examples.html">Tutorials &amp; Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendices.html">Appendices</a></li>
</ul>

</div>

<div class="page-contents">
	<h3>Page contents</h3>
	<ul>
<li><a class="reference internal" href="#">Getting Started</a><ul>
<li><a class="reference internal" href="#blog-tutorial">Blog Tutorial</a><ul>
<li><a class="reference internal" href="#getting-cakephp">Getting CakePHP</a><ul>
<li><a class="reference internal" href="#tmp-directory-permissions">Tmp directory permissions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-the-blog-database">Creating the Blog Database</a></li>
<li><a class="reference internal" href="#cakephp-database-configuration">CakePHP Database Configuration</a></li>
<li><a class="reference internal" href="#optional-configuration">Optional Configuration</a></li>
<li><a class="reference internal" href="#a-note-on-mod-rewrite">A Note on mod_rewrite</a></li>
</ul>
</li>
<li><a class="reference internal" href="#blog-tutorial-adding-a-layer">Blog Tutorial - Adding a layer</a><ul>
<li><a class="reference internal" href="#create-a-post-model">Create a Post Model</a></li>
<li><a class="reference internal" href="#create-a-posts-controller">Create a Posts Controller</a></li>
<li><a class="reference internal" href="#creating-post-views">Creating Post Views</a></li>
<li><a class="reference internal" href="#adding-posts">Adding Posts</a></li>
<li><a class="reference internal" href="#data-validation">Data Validation</a></li>
<li><a class="reference internal" href="#editing-posts">Editing Posts</a></li>
<li><a class="reference internal" href="#deleting-posts">Deleting Posts</a></li>
<li><a class="reference internal" href="#routes">Routes</a></li>
<li><a class="reference internal" href="#conclusion">Conclusion</a><ul>
<li><a class="reference internal" href="#suggested-follow-up-reading">Suggested Follow-up Reading</a></li>
</ul>
</li>
<li><a class="reference internal" href="#additional-reading">Additional Reading</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
	</div>

</div>

<div class="content row">
	<ul class="related-pages inline">
	<li>
		<a href="genindex.html" title="General Index" accesskey="I">index</a>
	</li>
	<li>
		<a href="installation/url-rewriting.html" title="URL Rewriting" accesskey="N">next</a>
	</li>
	<li>
		<a href="installation/url-rewriting.html" title="URL Rewriting" accesskey="P">previous</a>
	</li>
	</ul>
</div>

	<div class="footer-push"> </div>
</div>






<div class="footer">
	<div class="row">
		<div class="columns six offset-by-three contribute">
			<strong>发现翻译错误?</strong>
			请在下面留言<br />
			<a href="https://github.com/blackpuppy/docs/wiki" target="_blank">[ 我要加入翻译 ]</a>
		</div>
	</div>
	
	<div class="row">
		<div class="columns nine offset-by-three copyright">
					&copy; Copyright 2014, Cake Software Foundation, Inc.
				Last updated on Jul 10, 2016.
				Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.3.
		</div>
	</div>
</div>

<div id="nav-modal" class="reveal-modal"> </div>
<div id="inline-search-results"></div>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F201cbc61deaf9f7ffb521fb23e83db40' type='text/javascript'%3E%3C/script%3E"));
</script>

<!-- Duoshuo Comment BEGIN -->
	<div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"cakephpchina"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0]
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- Duoshuo Comment END -->

<!-- Grunt Live Reload -->
<script src="http://192.168.56.113:35729/livereload.js"></script>
  </body>
</html>