

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="Authentication" lang="en" name="title" />
<meta content="authentication handlers,array php,basic authentication,web application,different ways,credentials,exceptions,cakephp,logging" lang="en" name="keywords" />

    <title>Authentication</title>
    <link href="../../_static/favicon.png" type="image/png" rel="icon" />

    
    <link rel="stylesheet" href="../../_static/css/app.css" type="text/css" />
    
    <script type="text/javascript" src="../../_static/app.js"></script>

    <link rel="alternate" hreflang="pt" href="../../../pt/core-libraries/components/authentication.html" /><link rel="alternate" hreflang="es" href="../../../es/core-libraries/components/authentication.html" /><link rel="alternate" hreflang="ja" href="../../../ja/core-libraries/components/authentication.html" /><link rel="alternate" hreflang="fr" href="../../../fr/core-libraries/components/authentication.html" /><link rel="alternate" hreflang="zh" href="../../../zh/core-libraries/components/authentication.html" />

    <link rel="search" type="application/opensearchdescription+xml" title="Search within CakePHP Cookbook 2.x documentation" href="../../_static/opensearchdescription-book-3-x.xml">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="top" title="CakePHP Cookbook 2.x documentation" href="../../index.html" />
    <link rel="up" title="Components" href="../toc-components.html" />
    <link rel="next" title="Security" href="security-component.html" />
    <link rel="prev" title="Sessions" href="sessions.html" />

    <script type="text/javascript">
    window.lang = "en";
    </script>
  </head>
  <body>

<div id="container">
	
	<header class="nav-down">
		<div class="container-fluid hidden-xs hidden-sm">
			<div class="row">
				<div class="col-sm-3 col-md-3">
					<a class="logo-cake" href="http://cakephp.org">
						<img src="../../_static/logo-cake.png" alt="CakePHP" />
					</a>
				</div>

				<div class="col-sm-9 col-md-9">
					<nav class="navbar-right">
						<ul class="menu">
							<li class="first">
								<a href="#"><i class="fa fa-menu fa-chevron-down"></i>Documentation</a>
								<ul class="submenu">
									
<li><a href="http://book.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>CookBook</a></li>
<li><a href="http://api.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>API</a></li>

<li><a href="http://cakephp.org/documentation/videos"><i class="fa fa-menu fa-chevron-right"></i>Videos</a></li>
<li><a href="http://cakephp.org/privacy"><i class="fa fa-menu fa-chevron-right"></i>Privacy Policy</a></li>
<li><a href="http://cakephp.org/pages/trademark"><i class="fa fa-menu fa-chevron-right"></i>Logos &amp; Trademarks</a></li>
								</ul>
							</li>

							<li><a href="http://cakephp.org/business-solutions">Business Solutions</a></li>
							<li><a href="http://cakephp.org/showcase">Showcase</a></li>

							<li>
								<a href="#"><i class="fa fa-menu fa-chevron-down"></i>Community</a>
								<div class="megamenu full">
									<div class="row">
										<div class="col-6 pl30">
											<ul class="megamenu-list">
												
<li class="menu-title"><i class="fa fa-menu-title fa-users"></i>Community</li>

<li><a href="http://cakephp.org/team"><i class="fa fa-menu fa-chevron-right"></i>Team</a></li>
<li><a href="https://github.com/cakephp/cakephp/issues"><i class="fa fa-menu fa-chevron-right"></i>Issues (Github)</a></li>
<li><a href="http://www.youtube.com/user/CakePHP"><i class="fa fa-menu fa-chevron-right"></i>YouTube Channel</a></li>
<li><a href="http://cakephp.org/get-involved"><i class="fa fa-menu fa-chevron-right"></i>Get Involved</a></li>

<li><a href="http://bakery.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Bakery</a></li>
<li><a href="http://cakephp.org/newsletter/signup"><i class="fa fa-menu fa-chevron-right"></i>Newsletter</a></li>
<li><a href="http://certification.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Certification</a></li>
<li><a href="http://my.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>My CakePHP</a></li>
<li><a href="http://cakefest.org"><i class="fa fa-menu fa-chevron-right"></i>CakeFest</a></li>
<li><a href="http://www.facebook.com/groups/cake.community"><i class="fa fa-menu fa-chevron-right"></i>Facebook</a></li>
<li><a href="http://twitter.com/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Twitter</a></li>
											</ul>
										</div>
										<div class="col-6 pl30">
											<ul class="megamenu-list">
												
<li class="menu-title"><i class="fa fa-menu-title fa-comments-o"></i>Help &amp; Support</li>

<li><a href="http://discourse.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Forum</a></li>
<li><a href="http://stackoverflow.com/tags/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Stack Overflow</a></li>
<li><a href="http://webchat.freenode.net/?channels=cakephp"><i class="fa fa-menu fa-chevron-right"></i>IRC</a></li>
<li><a href="http://cakesf.herokuapp.com/"><i class="fa fa-menu fa-chevron-right"></i>Slack</a></li>
<li><a href="http://cakedc.com"><i class="fa fa-menu fa-chevron-right"></i>Paid Support</a></li>
											</ul>
										</div>
									</div>
								</div>
							</li>
						</ul>
					</nav>
				</div>
			</div>
		</div>

		
		<div class="container-fluid hidden-md hidden-lg">
			<div class="row">
				<div class="col-sm-6 col-xs-6">
					<a class="logo-cake" href="http://cakephp.org">
						<img src="../../_static/logo-cake.png" alt="CakePHP" />
					</a>
				</div>

				<div class="col-sm-6 col-xs-6">
					<div class="navbar-right">
						<button id="btn-menu" class="btn-menu" data-toggle="modal" data-target="#modal">
							<i class="fa fa-bars toggle-modal"></i>
						</button>
					</div>
					<div id="wrap">
						<form class="search" action="../../search.html" method="get">
							<input name="q" type="search" placeholder="What are you looking for?">
							<input id="search_submit" value="Search" type="submit">
						</form>
					</div>
				</div>
			</div>
		</div>

		
		<section id="nav-cook" class="hidden-xs hidden-sm">
			<div class="container-fluid ">
				<div class="row ">
					<div class="col-md-12 back-book">
						<div class="col-md-4 col-md-offset-1 text-center t-cook-nav p0 hidden-sm hidden-xs">
							<h2>
								<a href="../../contents.html">
									<span class="glyph_range icon-submenu icon-submenu-cook">B</span>
									CakePHP 2.x <strong>Cookbook</strong>
								</a>
							</h2>
						</div>

						<div class="col-md-4 hidden-sm">
							<form class="search" action="../../search.html" method="get">
								<input type="hidden" name="check_keywords" value="yes" />
								<input type="hidden" name="area" value="default" />

								<div class="col-md-10 p0">
									<input class="form-control form-cook" autocomplete="off" type="search" name="q" size="18" placeholder='Cookbook Search' />
								</div>
								<div class="col-md-2 p0 search-cook">
									<button type="submit">
										<span class="glyph_range icon-submenu icon-submenu-cook">A</span>
									</button>
								</div>
							</form>
						</div>

						
						<div class="col-md-3">
							<div class="col-md-6 p0">
								<div class="col-md-7 t-language p0">
									<h6>Language:</h6>
								</div>
								<div class="col-md-5 p0">
									<ul class="nav navbar-nav">
										<li class="dropdown">
											<a class="dropdown-toggle" data-hover="dropdown" data-toggle="dropdown"
													role="button" aria-haspopup="true" aria-expanded="false" href="#">
														en
														<i class="fa fa-menu-en fa-chevron-down"></i>
													</a>
											<ul class="dropdown-menu">
											
												<li></li>
											
												<li><a href="../../../pt/core-libraries/components/authentication.html">pt</a></li>
											
												<li><a href="../../../es/core-libraries/components/authentication.html">es</a></li>
											
												<li><a href="../../../ja/core-libraries/components/authentication.html">ja</a></li>
											
												<li><a href="../../../fr/core-libraries/components/authentication.html">fr</a></li>
											
												<li><a href="../../../zh/core-libraries/components/authentication.html">zh</a></li>
											
											</ul>
										</li>
									</ul>
								</div>
							</div>

							<div class="col-md-6 p0">
								<div class="col-md-7 t-language p0">
									<h6>Version:</h6>
								</div>
								<div class="col-md-5 p0">
									<ul class="nav navbar-nav">
										<li class="dropdown">
											<a href="#" class="dropdown-toggle" data-hover="dropdown" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">2.x <i class="fa fa-menu-en fa-chevron-down"></i></a>
											<ul class="dropdown-menu">
												<li><a href="http://book.cakephp.org/3.0/en">3.x Book</a></li>
												<li><a href="http://book.cakephp.org/2.0/en">2.x Book</a></li>
												<li><a href="http://book.cakephp.org/1.3/en/">1.3 Book</a></li>
												<li><a href="http://book.cakephp.org/1.2/en/">1.2 Book</a></li>
												<li><a href="http://book.cakephp.org/1.1/en">1.1 Book</a></li>
											</ul>
										</li>
									</ul>
								</div>
							</div>
						</div>

					</div>
				</div>
			</div>
		</section>
	</header>

	
	<section class="nav-btn visible-sm visible-xs">
		<div class="container">
			<div class="row">
				<div class="col-sm-6 col-xs-6 text-center">
					<button id="btn-nav" class="btn btn-b btn-nav" data-toggle="modal" data-target="#modal"><strong>Nav</strong></button>
				</div>

				<div class="col-sm-6 col-xs-6 text-center">
					<button id="btn-toc" class="btn btn-b btn-nav" data-toggle="modal" data-target="#modal"><strong>Table of Contents</strong></button>
				</div>
			</div>
		</div>
	</section>

	
	<div id="modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modal-header">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
					<h4 class="modal-title-cookbook" id="modal-header"></h4>
				</div>
				<div class="modal-body"></div>
			</div>
		</div>
	</div>

<div class="container page-container"><div id="improve-slideout">
		<i class="fa fa-pencil icon-improve"></i>
		<a href="https://github.com/cakephp/docs/edit/master/en/core-libraries/components/authentication.rst" target="_blank">
			<div id="improve-slideout-inner"><h6>Improve This Doc <i class="fa fa-github git-improve"></i></h6></div>
		</a>
	</div><a id="back-to-contents" href="#page-contents"><i class="fa fa-arrow-circle-up icon-improve" title="Back to Contents"></i></a>

	
	<div class="row">
		<div class="col-sm-12 col-md-9 col-md-push-3 space-left push-off"><div class="page-contents col-sm-5">
				<h3>Page Contents</h3>
				<ul>
<li><a class="reference internal" href="#">Authentication</a><ul>
<li><a class="reference internal" href="#suggested-reading-before-continuing">Suggested Reading Before Continuing</a></li>
<li><a class="reference internal" href="#id1">Authentication</a><ul>
<li><a class="reference internal" href="#choosing-an-authentication-type">Choosing an Authentication type</a></li>
<li><a class="reference internal" href="#configuring-authentication-handlers">Configuring Authentication handlers</a></li>
<li><a class="reference internal" href="#identifying-users-and-logging-them-in">Identifying users and logging them in</a><ul>
<li><a class="reference internal" href="#using-digest-and-basic-authentication-for-logging-in">Using Digest and Basic Authentication for logging in</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-custom-authentication-objects">Creating Custom Authentication objects</a></li>
<li><a class="reference internal" href="#using-custom-authentication-objects">Using custom authentication objects</a></li>
<li><a class="reference internal" href="#creating-stateless-authentication-systems">Creating stateless authentication systems</a></li>
<li><a class="reference internal" href="#handling-unauthenticated-requests">Handling unauthenticated requests</a></li>
<li><a class="reference internal" href="#displaying-auth-related-flash-messages">Displaying auth related flash messages</a></li>
<li><a class="reference internal" href="#hashing-passwords">Hashing passwords</a></li>
<li><a class="reference internal" href="#using-bcrypt-for-passwords">Using bcrypt for passwords</a><ul>
<li><a class="reference internal" href="#hashing-passwords-for-digest-authentication">Hashing passwords for digest authentication</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-custom-password-hasher-classes">Creating custom password hasher classes</a></li>
<li><a class="reference internal" href="#manually-logging-users-in">Manually logging users in</a></li>
<li><a class="reference internal" href="#accessing-the-logged-in-user">Accessing the logged in user</a></li>
<li><a class="reference internal" href="#logging-users-out">Logging users out</a></li>
</ul>
</li>
<li><a class="reference internal" href="#authorization">Authorization</a><ul>
<li><a class="reference internal" href="#configuring-authorization-handlers">Configuring Authorization handlers</a></li>
<li><a class="reference internal" href="#creating-custom-authorize-objects">Creating Custom Authorize objects</a><ul>
<li><a class="reference internal" href="#using-custom-authorize-objects">Using custom authorize objects</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-no-authorization">Using no authorization</a></li>
<li><a class="reference internal" href="#making-actions-public">Making actions public</a></li>
<li><a class="reference internal" href="#making-actions-require-authorization">Making actions require authorization</a></li>
<li><a class="reference internal" href="#using-controllerauthorize">Using ControllerAuthorize</a></li>
<li><a class="reference internal" href="#using-actionsauthorize">Using ActionsAuthorize</a></li>
<li><a class="reference internal" href="#using-crudauthorize">Using CrudAuthorize</a></li>
<li><a class="reference internal" href="#mapping-actions-when-using-crudauthorize">Mapping actions when using CrudAuthorize</a></li>
</ul>
</li>
<li><a class="reference internal" href="#authcomponent-api">AuthComponent API</a></li>
</ul>
</li>
</ul>

			</div><div class="document-body">
			
  <div class="section" id="authentication">
<h1>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="AuthComponent">
<em class="property">class </em><code class="descname">AuthComponent</code><span class="sig-paren">(</span><em>ComponentCollection $collection</em>, <em>array $settings = array()</em><span class="sig-paren">)</span><a class="headerlink" href="#AuthComponent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Identifying, authenticating and authorizing users is a common part of almost
every web application. In CakePHP AuthComponent provides a pluggable way to do
these tasks. AuthComponent allows you to combine authentication objects, and
authorization objects to create flexible ways of identifying and checking user
authorization.</p>
<div class="section" id="suggested-reading-before-continuing">
<span id="authentication-objects"></span><h2>Suggested Reading Before Continuing<a class="headerlink" href="#suggested-reading-before-continuing" title="Permalink to this headline">¶</a></h2>
<p>Configuring authentication requires several steps including defining a users
table, creating a model, controller &amp; views, etc.</p>
<p>This is all covered step by step in the
<a class="reference internal" href="../../tutorials-and-examples/blog-auth-example/auth.html"><span class="doc">Blog Tutorial</span></a>.</p>
</div>
<div class="section" id="id1">
<h2>Authentication<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Authentication is the process of identifying users by provided credentials and
ensuring that users are who they say they are. Generally this is done through a
username and password, that are checked against a known list of users. In
CakePHP, there are several built-in ways of authenticating users stored in your
application.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">FormAuthenticate</span></code> allows you to authenticate users based on form POST
data. Usually this is a login form that users enter information into.</li>
<li><code class="docutils literal"><span class="pre">BasicAuthenticate</span></code> allows you to authenticate users using Basic HTTP
authentication.</li>
<li><code class="docutils literal"><span class="pre">DigestAuthenticate</span></code> allows you to authenticate users using Digest
HTTP authentication.</li>
</ul>
<p>By default <code class="docutils literal"><span class="pre">AuthComponent</span></code> uses <code class="docutils literal"><span class="pre">FormAuthenticate</span></code>.</p>
<div class="section" id="choosing-an-authentication-type">
<h3>Choosing an Authentication type<a class="headerlink" href="#choosing-an-authentication-type" title="Permalink to this headline">¶</a></h3>
<p>Generally you&#8217;ll want to offer form based authentication. It is the easiest for
users using a web-browser to use. If you are building an API or webservice, you
may want to consider basic authentication or digest authentication. The key
differences between digest and basic authentication are mostly related to how
passwords are handled. In basic authentication, the username and password are
transmitted as plain-text to the server. This makes basic authentication
un-suitable for applications without SSL, as you would end up exposing sensitive
passwords. Digest authentication uses a digest hash of the username, password,
and a few other details. This makes digest authentication more appropriate for
applications without SSL encryption.</p>
<p>You can also use authentication systems like openid as well, however openid is
not part of CakePHP core.</p>
</div>
<div class="section" id="configuring-authentication-handlers">
<h3>Configuring Authentication handlers<a class="headerlink" href="#configuring-authentication-handlers" title="Permalink to this headline">¶</a></h3>
<p>You configure authentication handlers using <code class="docutils literal"><span class="pre">$this-&gt;Auth-&gt;authenticate</span></code>.
You can configure one or many handlers for authentication. Using multiple
handlers allows you to support different ways of logging users in. When logging
users in, authentication handlers are checked in the order they are declared.
Once one handler is able to identify the user, no other handlers will be
checked. Conversely you can halt all authentication by throwing an exception.
You will need to catch any thrown exceptions, and handle them as needed.</p>
<p>You can configure authentication handlers in your controller&#8217;s <code class="docutils literal"><span class="pre">beforeFilter</span></code>
or, in the <code class="docutils literal"><span class="pre">$components</span></code> array. You can pass configuration information into
each authentication object, using an array:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Basic setup</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">authenticate</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Form&#39;</span><span class="p">);</span>

<span class="c1">// Pass settings in</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">authenticate</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;Basic&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;userModel&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Member&#39;</span><span class="p">),</span>
    <span class="s1">&#39;Form&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;userModel&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Member&#39;</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p>In the second example you&#8217;ll notice that we had to declare the <code class="docutils literal"><span class="pre">userModel</span></code> key
twice. To help you keep your code DRY, you can use the <code class="docutils literal"><span class="pre">all</span></code> key. This special
key allows you to set settings that are passed to every attached object. The all
key is also exposed as <code class="docutils literal"><span class="pre">AuthComponent::ALL</span></code>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Pass settings in using &#39;all&#39;</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">authenticate</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="nx">AuthComponent</span><span class="o">::</span><span class="na">ALL</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;userModel&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Member&#39;</span><span class="p">),</span>
    <span class="s1">&#39;Basic&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Form&#39;</span>
<span class="p">);</span>
</pre></div>
</div>
<p>In the above example, both <code class="docutils literal"><span class="pre">Form</span></code> and <code class="docutils literal"><span class="pre">Basic</span></code> will get the settings defined
for the &#8216;all&#8217; key. Any settings passed to a specific authentication object will
override the matching key in the &#8216;all&#8217; key. The core authentication objects
support the following configuration keys.</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">fields</span></code> The fields to use to identify a user by.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">userModel</span></code> The model name of the User, defaults to User.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">scope</span></code> Additional conditions to use when looking up and
authenticating users, i.e. <code class="docutils literal"><span class="pre">array('User.is_active'</span> <span class="pre">=&gt;</span> <span class="pre">1)</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">recursive</span></code> The value of the recursive key passed to <code class="docutils literal"><span class="pre">find()</span></code>. Defaults to
<code class="docutils literal"><span class="pre">0</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">contain</span></code> Containable options for when the user record is loaded.
If you want to use this option, you&#8217;ll need to make sure your model has the
containable behavior attached.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.2.</span></p>
</div>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">passwordHasher</span></code> Password hasher class. Defaults to <code class="docutils literal"><span class="pre">Simple</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.4.</span></p>
</div>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">userFields</span></code> The list of fields to fetch from the <code class="docutils literal"><span class="pre">userModel</span></code>. This option
is helpful when you have a wide user table and do not need all the columns in
the session. By default all fields are fetched.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.6.</span></p>
</div>
</li>
</ul>
<p>To configure different fields for user in <code class="docutils literal"><span class="pre">$components</span></code> array:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Pass settings in $components array</span>
<span class="k">public</span> <span class="nv">$components</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;Auth&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;authenticate&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;Form&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;fields&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;email&#39;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Do not put other Auth configuration keys (like authError, loginAction etc)
within the authenticate or Form element. They should be at the same level as the
authenticate key. The setup above with other Auth configuration should look
like:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Pass settings in $components array</span>
<span class="k">public</span> <span class="nv">$components</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;Auth&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;loginAction&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;controller&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;users&#39;</span><span class="p">,</span>
            <span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;login&#39;</span><span class="p">,</span>
            <span class="s1">&#39;plugin&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;users&#39;</span>
        <span class="p">),</span>
        <span class="s1">&#39;authError&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Did you really think you are allowed to see that?&#39;</span><span class="p">,</span>
        <span class="s1">&#39;authenticate&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;Form&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;fields&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                  <span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;my_user_model_username_field&#39;</span><span class="p">,</span> <span class="c1">//Default is &#39;username&#39; in the userModel</span>
                  <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;my_user_model_password_field&#39;</span>  <span class="c1">//Default is &#39;password&#39; in the userModel</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p>In addition to the common configuration, Basic authentication supports the
following keys:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">realm</span></code> The realm being authenticated. Defaults to <code class="docutils literal"><span class="pre">env('SERVER_NAME')</span></code>.</li>
</ul>
<p>In addition to the common configuration Digest authentication supports the
following keys:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">realm</span></code> The realm authentication is for, Defaults to the servername.</li>
<li><code class="docutils literal"><span class="pre">nonce</span></code> A nonce used for authentication. Defaults to <code class="docutils literal"><span class="pre">uniqid()</span></code>.</li>
<li><code class="docutils literal"><span class="pre">qop</span></code> Defaults to auth, no other values are supported at this time.</li>
<li><code class="docutils literal"><span class="pre">opaque</span></code> A string that must be returned unchanged by clients. Defaults
to <code class="docutils literal"><span class="pre">md5($settings['realm'])</span></code></li>
</ul>
</div>
<div class="section" id="identifying-users-and-logging-them-in">
<h3>Identifying users and logging them in<a class="headerlink" href="#identifying-users-and-logging-them-in" title="Permalink to this headline">¶</a></h3>
<p>In the past <code class="docutils literal"><span class="pre">AuthComponent</span></code> auto-magically logged users in. This was confusing
for many people, and made using AuthComponent a bit difficult at times. For 2.0,
you&#8217;ll need to manually call <code class="docutils literal"><span class="pre">$this-&gt;Auth-&gt;login()</span></code> to log a user in.</p>
<p>When authenticating users, attached authentication objects are checked in the
order they are attached. Once one of the objects can identify the user, no other
objects are checked. A sample login function for working with a login form could
look like:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">login</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="c1">// Important: Use login() without arguments! See warning below.</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">login</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">redirectUrl</span><span class="p">());</span>
            <span class="c1">// Prior to 2.3 use</span>
            <span class="c1">// `return $this-&gt;redirect($this-&gt;Auth-&gt;redirect());`</span>
        <span class="p">}</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Flash</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">(</span>
            <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Username or password is incorrect&#39;</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="c1">// Prior to 2.7 use</span>
        <span class="c1">// $this-&gt;Session-&gt;setFlash(__(&#39;Username or password is incorrect&#39;));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above code (without any data passed to the <code class="docutils literal"><span class="pre">login</span></code> method), will attempt
to log a user in using the POST data, and if successful redirect the user to
either the last page they were visiting, or
<a class="reference internal" href="#AuthComponent::$loginRedirect" title="AuthComponent::$loginRedirect"><code class="xref php php-attr docutils literal"><span class="pre">AuthComponent::$loginRedirect</span></code></a>. If the login is unsuccessful, a flash
message is set.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In 2.x <code class="docutils literal"><span class="pre">$this-&gt;Auth-&gt;login($this-&gt;request-&gt;data)</span></code> will log the user in
with whatever data is posted, whereas in 1.3
<code class="docutils literal"><span class="pre">$this-&gt;Auth-&gt;login($this-&gt;data)</span></code> would try to identify the user first and
only log in when successful.</p>
</div>
<div class="section" id="using-digest-and-basic-authentication-for-logging-in">
<h4>Using Digest and Basic Authentication for logging in<a class="headerlink" href="#using-digest-and-basic-authentication-for-logging-in" title="Permalink to this headline">¶</a></h4>
<p>Because basic and digest authentication don&#8217;t require an initial POST or a form
so if using only basic / digest authenticators you don&#8217;t require a login action
in your controller. Also you can set <code class="docutils literal"><span class="pre">AuthComponent::$sessionKey</span></code> to false to
ensure AuthComponent doesn&#8217;t try to read user info from session. Stateless
authentication will re-verify the user&#8217;s credentials on each request, this
creates a small amount of additional overhead, but allows clients that to login
in without using cookies.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Prior to 2.4 you still need the login action as you are redirected to login
when an unauthenticated user tries to access a protected page even when using
only basic or digest auth. Also setting <code class="docutils literal"><span class="pre">AuthComponent::$sessionKey</span></code> to
false will cause an error prior to 2.4.</p>
</div>
</div>
</div>
<div class="section" id="creating-custom-authentication-objects">
<h3>Creating Custom Authentication objects<a class="headerlink" href="#creating-custom-authentication-objects" title="Permalink to this headline">¶</a></h3>
<p>Because authentication objects are pluggable, you can create custom
authentication objects in your application or plugins. If for example you wanted
to create an OpenID authentication object. In
<code class="docutils literal"><span class="pre">app/Controller/Component/Auth/OpenidAuthenticate.php</span></code> you could put the
following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;BaseAuthenticate&#39;</span><span class="p">,</span> <span class="s1">&#39;Controller/Component/Auth&#39;</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">OpenidAuthenticate</span> <span class="k">extends</span> <span class="nx">BaseAuthenticate</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">authenticate</span><span class="p">(</span><span class="nx">CakeRequest</span> <span class="nv">$request</span><span class="p">,</span> <span class="nx">CakeResponse</span> <span class="nv">$response</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Do things for OpenID here.</span>
        <span class="c1">// Return an array of user if they could authenticate the user,</span>
        <span class="c1">// return false if not</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Authentication objects should return <code class="docutils literal"><span class="pre">false</span></code> if they cannot identify the user.
And an array of user information if they can. It&#8217;s not required that you extend
<code class="docutils literal"><span class="pre">BaseAuthenticate</span></code>, only that your authentication object implements an
<code class="docutils literal"><span class="pre">authenticate()</span></code> method. The <code class="docutils literal"><span class="pre">BaseAuthenticate</span></code> class provides a number of
helpful methods that are commonly used. You can also implement a <code class="docutils literal"><span class="pre">getUser()</span></code>
method if your authentication object needs to support stateless or cookie-less
authentication. See the sections on basic and digest authentication below for
more information.</p>
</div>
<div class="section" id="using-custom-authentication-objects">
<h3>Using custom authentication objects<a class="headerlink" href="#using-custom-authentication-objects" title="Permalink to this headline">¶</a></h3>
<p>Once you&#8217;ve created your custom authentication object, you can use them by
including them in AuthComponents authenticate array:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">authenticate</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;Openid&#39;</span><span class="p">,</span> <span class="c1">// app authentication object.</span>
    <span class="s1">&#39;AuthBag.Combo&#39;</span><span class="p">,</span> <span class="c1">// plugin authentication object.</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-stateless-authentication-systems">
<h3>Creating stateless authentication systems<a class="headerlink" href="#creating-stateless-authentication-systems" title="Permalink to this headline">¶</a></h3>
<p>Authentication objects can implement a <code class="docutils literal"><span class="pre">getUser()</span></code> method that can be
used to support user login systems that don&#8217;t rely on cookies. A
typical getUser method looks at the request/environment and uses the
information there to confirm the identity of the user. HTTP Basic
authentication for example uses <code class="docutils literal"><span class="pre">$_SERVER['PHP_AUTH_USER']</span></code> and
<code class="docutils literal"><span class="pre">$_SERVER['PHP_AUTH_PW']</span></code> for the username and password fields. On each
request, these values are used to re-identify the user and ensure they are
valid user. As with authentication object&#8217;s <code class="docutils literal"><span class="pre">authenticate()</span></code> method the
<code class="docutils literal"><span class="pre">getUser()</span></code> method should return an array of user information on success or
<code class="docutils literal"><span class="pre">false</span></code> on failure.</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">getUser</span><span class="p">(</span><span class="nv">$request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$username</span> <span class="o">=</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;PHP_AUTH_USER&#39;</span><span class="p">);</span>
    <span class="nv">$pass</span> <span class="o">=</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;PHP_AUTH_PW&#39;</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$username</span><span class="p">)</span> <span class="o">||</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$pass</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_findUser</span><span class="p">(</span><span class="nv">$username</span><span class="p">,</span> <span class="nv">$pass</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above is how you could implement getUser method for HTTP basic
authentication. The <code class="docutils literal"><span class="pre">_findUser()</span></code> method is part of <code class="docutils literal"><span class="pre">BaseAuthenticate</span></code>
and identifies a user based on a username and password.</p>
</div>
<div class="section" id="handling-unauthenticated-requests">
<h3>Handling unauthenticated requests<a class="headerlink" href="#handling-unauthenticated-requests" title="Permalink to this headline">¶</a></h3>
<p>When an unauthenticated user tries to access a protected page first the
<cite>unauthenticated()</cite> method of the last authenticator in the chain is called.
The authenticate object can handle sending response or redirection as
appropriate and return <cite>true</cite> to indicate no further action is necessary. Due to
this the order in which you specify the authenticate object in
<cite>AuthComponent::$authenticate</cite> property matters.</p>
<p>If authenticator returns null, <cite>AuthComponent</cite> redirects user to login action.
If it&#8217;s an AJAX request and <cite>AuthComponent::$ajaxLogin</cite> is specified that
element is rendered else a 403 HTTP status code is returned.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Prior to 2.4 the authenticate objects do not provide an <cite>unauthenticated()</cite>
method.</p>
</div>
</div>
<div class="section" id="displaying-auth-related-flash-messages">
<h3>Displaying auth related flash messages<a class="headerlink" href="#displaying-auth-related-flash-messages" title="Permalink to this headline">¶</a></h3>
<p>In order to display the session error messages that Auth generates, you need to
add the following code to your layout. Add the following two lines to the
<code class="docutils literal"><span class="pre">app/View/Layouts/default.ctp</span></code> file in the body section preferable before the
content_for_layout line.</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// CakePHP 2.7+</span>
<span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Flash</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">();</span>
<span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Flash</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">(</span><span class="s1">&#39;auth&#39;</span><span class="p">);</span>

<span class="c1">// Prior to 2.7</span>
<span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Session</span><span class="o">-&gt;</span><span class="na">flash</span><span class="p">();</span>
<span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Session</span><span class="o">-&gt;</span><span class="na">flash</span><span class="p">(</span><span class="s1">&#39;auth&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>You can customize the error messages, and flash settings AuthComponent uses.
Using <code class="docutils literal"><span class="pre">$this-&gt;Auth-&gt;flash</span></code> you can configure the parameters AuthComponent uses
for setting flash messages. The available keys are</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">element</span></code> - The element to use, defaults to &#8216;default&#8217;.</li>
<li><code class="docutils literal"><span class="pre">key</span></code> - The key to use, defaults to &#8216;auth&#8217;</li>
<li><code class="docutils literal"><span class="pre">params</span></code> - The array of additional params to use, defaults to array()</li>
</ul>
<p>In addition to the flash message settings you can customize other error messages
AuthComponent uses. In your controller&#8217;s beforeFilter, or component settings you
can use <code class="docutils literal"><span class="pre">authError</span></code> to customize the error used for when authorization fails:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">authError</span> <span class="o">=</span> <span class="s2">&quot;This error shows up with the user tries to access&quot;</span> <span class="o">.</span>
                            <span class="s2">&quot;a part of the website that is protected.&quot;</span><span class="p">;</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 2.4: </span>Sometimes, you want to display the authorization error only after the user
has already logged-in. You can suppress this message by setting its value to
boolean <cite>false</cite></p>
</div>
<p>In your controller&#8217;s beforeFilter(), or component settings:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">loggedIn</span><span class="p">())</span> <span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">authError</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="hashing-passwords">
<span id="id2"></span><h3>Hashing passwords<a class="headerlink" href="#hashing-passwords" title="Permalink to this headline">¶</a></h3>
<p>AuthComponent no longer automatically hashes every password it can find.
This was removed because it made a number of common tasks like validation
difficult. You should <strong>never</strong> store plain text passwords, and before saving a
user record you should always hash the password.</p>
<p>As of 2.4 the generation and checking of password hashes has been delegated to
password hasher classes. Authenticating objects use a new setting
<code class="docutils literal"><span class="pre">passwordHasher</span></code> which specifies the password hasher class to use. It can be a
string specifying class name or an array with key <code class="docutils literal"><span class="pre">className</span></code> stating the
class name and any extra keys will be passed to password hasher constructor as
config. The default hasher class <code class="docutils literal"><span class="pre">Simple</span></code> can be used for sha1, sha256, md5
hashing. By default the hash type set in Security class will be used. You can
use specific hash type like this:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="nv">$components</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;Auth&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;authenticate&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;Form&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;passwordHasher&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                    <span class="s1">&#39;className&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Simple&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;hashType&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;sha256&#39;</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p>When creating new user records you can hash a password in the <code class="docutils literal"><span class="pre">beforeSave</span></code>
callback of your model using appropriate password hasher class:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;SimplePasswordHasher&#39;</span><span class="p">,</span> <span class="s1">&#39;Controller/Component/Auth&#39;</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">AppModel</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">beforeSave</span><span class="p">(</span><span class="nv">$options</span> <span class="o">=</span> <span class="k">array</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">alias</span><span class="p">][</span><span class="s1">&#39;password&#39;</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nv">$passwordHasher</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SimplePasswordHasher</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;hashType&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;sha256&#39;</span><span class="p">));</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">alias</span><span class="p">][</span><span class="s1">&#39;password&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$passwordHasher</span><span class="o">-&gt;</span><span class="na">hash</span><span class="p">(</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">alias</span><span class="p">][</span><span class="s1">&#39;password&#39;</span><span class="p">]</span>
            <span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You don&#8217;t need to hash passwords before calling <code class="docutils literal"><span class="pre">$this-&gt;Auth-&gt;login()</span></code>.
The various authentication objects will hash passwords individually.</p>
</div>
<div class="section" id="using-bcrypt-for-passwords">
<h3>Using bcrypt for passwords<a class="headerlink" href="#using-bcrypt-for-passwords" title="Permalink to this headline">¶</a></h3>
<p>In CakePHP 2.3 the <code class="docutils literal"><span class="pre">BlowfishAuthenticate</span></code> class was introduced to allow using
<a class="reference external" href="https://en.wikipedia.org/wiki/Bcrypt">bcrypt</a> a.k.a Blowfish for hash
passwords. Bcrypt hashes are much harder to brute force than passwords stored
with sha1. But <code class="docutils literal"><span class="pre">BlowfishAuthenticate</span></code> has been deprecated in 2.4 and instead
<code class="docutils literal"><span class="pre">BlowfishPasswordHasher</span></code> has been added.</p>
<p>A blowfish password hasher can be used with any authentication class. All you
have to do with specify <code class="docutils literal"><span class="pre">passwordHasher</span></code> setting for the authenticating
object:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="nv">$components</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;Auth&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;authenticate&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;Form&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;passwordHasher&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Blowfish&#39;</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<div class="section" id="hashing-passwords-for-digest-authentication">
<h4>Hashing passwords for digest authentication<a class="headerlink" href="#hashing-passwords-for-digest-authentication" title="Permalink to this headline">¶</a></h4>
<p>Because Digest authentication requires a password hashed in the format defined
by the RFC, in order to correctly hash a password for use with Digest
authentication you should use the special password hashing function on
<code class="docutils literal"><span class="pre">DigestAuthenticate</span></code>. If you are going to be combining digest authentication
with any other authentication strategies, it&#8217;s also recommended that you store
the digest password in a separate column, from the normal password hash:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;DigestAuthenticate&#39;</span><span class="p">,</span> <span class="s1">&#39;Controller/Component/Auth&#39;</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">AppModel</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">beforeSave</span><span class="p">(</span><span class="nv">$options</span> <span class="o">=</span> <span class="k">array</span><span class="p">())</span> <span class="p">{</span>
        <span class="c1">// make a password for digest auth.</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">alias</span><span class="p">][</span><span class="s1">&#39;digest_hash&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">DigestAuthenticate</span><span class="o">::</span><span class="na">password</span><span class="p">(</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">alias</span><span class="p">][</span><span class="s1">&#39;username&#39;</span><span class="p">],</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">alias</span><span class="p">][</span><span class="s1">&#39;password&#39;</span><span class="p">],</span>
            <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;SERVER_NAME&#39;</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Passwords for digest authentication need a bit more information than other
password hashes, based on the RFC for digest authentication.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The third parameter of DigestAuthenticate::password() must match the &#8216;realm&#8217;
config value defined when DigestAuthentication was configured in
AuthComponent::$authenticate. This defaults to <code class="docutils literal"><span class="pre">env('SCRIPT_NAME')</span></code>. You
may wish to use a static string if you want consistent hashes in multiple
environments.</p>
</div>
</div>
</div>
<div class="section" id="creating-custom-password-hasher-classes">
<h3>Creating custom password hasher classes<a class="headerlink" href="#creating-custom-password-hasher-classes" title="Permalink to this headline">¶</a></h3>
<p>Custom password hasher classes need to extend the <code class="docutils literal"><span class="pre">AbstractPasswordHasher</span></code>
class and need to implement the abstract methods <code class="docutils literal"><span class="pre">hash()</span></code> and <code class="docutils literal"><span class="pre">check()</span></code>.
In <code class="docutils literal"><span class="pre">app/Controller/Component/Auth/CustomPasswordHasher.php</span></code> you could put the
following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;AbstractPasswordHasher&#39;</span><span class="p">,</span> <span class="s1">&#39;Controller/Component/Auth&#39;</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">CustomPasswordHasher</span> <span class="k">extends</span> <span class="nx">AbstractPasswordHasher</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">hash</span><span class="p">(</span><span class="nv">$password</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// stuff here</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">check</span><span class="p">(</span><span class="nv">$password</span><span class="p">,</span> <span class="nv">$hashedPassword</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// stuff here</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="manually-logging-users-in">
<h3>Manually logging users in<a class="headerlink" href="#manually-logging-users-in" title="Permalink to this headline">¶</a></h3>
<p>Sometimes the need arises where you need to manually log a user in, such as just
after they registered for your application. You can do this by calling
<code class="docutils literal"><span class="pre">$this-&gt;Auth-&gt;login()</span></code> with the user data you want to &#8216;login&#8217;:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">register</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">User</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">))</span> <span class="p">{</span>
        <span class="nv">$id</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">User</span><span class="o">-&gt;</span><span class="na">id</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">[</span><span class="s1">&#39;User&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">[</span><span class="s1">&#39;User&#39;</span><span class="p">],</span>
            <span class="k">array</span><span class="p">(</span><span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="nv">$id</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="nb">unset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">[</span><span class="s1">&#39;User&#39;</span><span class="p">][</span><span class="s1">&#39;password&#39;</span><span class="p">]);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">login</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">[</span><span class="s1">&#39;User&#39;</span><span class="p">]);</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="s1">&#39;/users/home&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Be sure to manually add the new User id to the array passed to the login
method. Otherwise you won&#8217;t have the user id available.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Be sure to unset password fields before manually passing data into
<code class="docutils literal"><span class="pre">$this-&gt;Auth-&gt;login()</span></code>, or it will get saved in the Session unhashed.</p>
</div>
</div>
<div class="section" id="accessing-the-logged-in-user">
<h3>Accessing the logged in user<a class="headerlink" href="#accessing-the-logged-in-user" title="Permalink to this headline">¶</a></h3>
<p>Once a user is logged in, you will often need some particular information about
the current user. You can access the currently logged in user using
<code class="docutils literal"><span class="pre">AuthComponent::user()</span></code>. This method is static, and can be used globally after
the AuthComponent has been loaded. You can access it both as an instance method
or as a static method:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Use anywhere</span>
<span class="nx">AuthComponent</span><span class="o">::</span><span class="na">user</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>

<span class="c1">// From inside a controller</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="logging-users-out">
<h3>Logging users out<a class="headerlink" href="#logging-users-out" title="Permalink to this headline">¶</a></h3>
<p>Eventually you&#8217;ll want a quick way to de-authenticate someone, and redirect them
to where they need to go. This method is also useful if you want to provide a
&#8216;Log me out&#8217; link inside a members&#8217; area of your application:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">logout</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">logout</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Logging out users that logged in with Digest or Basic auth is difficult to
accomplish for all clients. Most browsers will retain credentials for the
duration they are still open. Some clients can be forced to logout by sending a
401 status code. Changing the authentication realm is another solution that
works for some clients.</p>
</div>
</div>
<div class="section" id="authorization">
<span id="authorization-objects"></span><h2>Authorization<a class="headerlink" href="#authorization" title="Permalink to this headline">¶</a></h2>
<p>Authorization is the process of ensuring that an identified/authenticated user
is allowed to access the resources they are requesting. If enabled
<code class="docutils literal"><span class="pre">AuthComponent</span></code> can automatically check authorization handlers and ensure that
logged in users are allowed to access the resources they are requesting. There
are several built-in authorization handlers, and you can create custom ones for
your application, or as part of a plugin.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ActionsAuthorize</span></code> Uses the AclComponent to check for permissions on an
action level.</li>
<li><code class="docutils literal"><span class="pre">CrudAuthorize</span></code> Uses the AclComponent and action -&gt; CRUD mappings to check
permissions for resources.</li>
<li><code class="docutils literal"><span class="pre">ControllerAuthorize</span></code> Calls <code class="docutils literal"><span class="pre">isAuthorized()</span></code> on the active controller, and
uses the return of that to authorize a user. This is often the most simple way
to authorize users.</li>
</ul>
<div class="section" id="configuring-authorization-handlers">
<h3>Configuring Authorization handlers<a class="headerlink" href="#configuring-authorization-handlers" title="Permalink to this headline">¶</a></h3>
<p>You configure authorization handlers using <code class="docutils literal"><span class="pre">$this-&gt;Auth-&gt;authorize</span></code>. You can
configure one or many handlers for authorization. Using multiple handlers allows
you to support different ways of checking authorization. When authorization
handlers are checked, they will be called in the order they are declared.
Handlers should return false, if they are unable to check authorization, or the
check has failed.
Handlers should return true if they were able to check authorization
successfully. Handlers will be called in sequence until one passes. If all
checks fail, the user will be redirected to the page they came from.
Additionally you can halt all authorization by throwing an exception. You will
need to catch any thrown exceptions, and handle them.</p>
<p>You can configure authorization handlers in your controller&#8217;s <code class="docutils literal"><span class="pre">beforeFilter</span></code>
or, in the <code class="docutils literal"><span class="pre">$components</span></code> array. You can pass configuration information into
each authorization object, using an array:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Basic setup</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">authorize</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Controller&#39;</span><span class="p">);</span>

<span class="c1">// Pass settings in</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">authorize</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;Actions&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;actionPath&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;controllers/&#39;</span><span class="p">),</span>
    <span class="s1">&#39;Controller&#39;</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Much like <code class="docutils literal"><span class="pre">Auth-&gt;authenticate</span></code>, <code class="docutils literal"><span class="pre">Auth-&gt;authorize</span></code>, helps you keep your code
DRY, by using the <code class="docutils literal"><span class="pre">all</span></code> key. This special key allows you to set settings that
are passed to every attached object. The all key is also exposed as
<code class="docutils literal"><span class="pre">AuthComponent::ALL</span></code>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Pass settings in using &#39;all&#39;</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">authorize</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="nx">AuthComponent</span><span class="o">::</span><span class="na">ALL</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;actionPath&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;controllers/&#39;</span><span class="p">),</span>
    <span class="s1">&#39;Actions&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Controller&#39;</span>
<span class="p">);</span>
</pre></div>
</div>
<p>In the above example, both the <code class="docutils literal"><span class="pre">Actions</span></code> and <code class="docutils literal"><span class="pre">Controller</span></code> will get the
settings defined for the &#8216;all&#8217; key. Any settings passed to a specific
authorization object will override the matching key in the &#8216;all&#8217; key.
The core authorize objects support the following configuration keys.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">actionPath</span></code> Used by <code class="docutils literal"><span class="pre">ActionsAuthorize</span></code> to locate controller action
ACO&#8217;s in the ACO tree.</li>
<li><code class="docutils literal"><span class="pre">actionMap</span></code> Action -&gt; CRUD mappings. Used by <code class="docutils literal"><span class="pre">CrudAuthorize</span></code> and
authorization objects that want to map actions to CRUD roles.</li>
<li><code class="docutils literal"><span class="pre">userModel</span></code> The name of the ARO/Model node user information can be found
under. Used with ActionsAuthorize.</li>
</ul>
</div>
<div class="section" id="creating-custom-authorize-objects">
<h3>Creating Custom Authorize objects<a class="headerlink" href="#creating-custom-authorize-objects" title="Permalink to this headline">¶</a></h3>
<p>Because authorize objects are pluggable, you can create custom authorize
objects in your application or plugins. If for example you wanted to
create an LDAP authorize object. In
<code class="docutils literal"><span class="pre">app/Controller/Component/Auth/LdapAuthorize.php</span></code> you could put the
following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;BaseAuthorize&#39;</span><span class="p">,</span> <span class="s1">&#39;Controller/Component/Auth&#39;</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">LdapAuthorize</span> <span class="k">extends</span> <span class="nx">BaseAuthorize</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">authorize</span><span class="p">(</span><span class="nv">$user</span><span class="p">,</span> <span class="nx">CakeRequest</span> <span class="nv">$request</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Do things for LDAP here.</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Authorize objects should return <code class="docutils literal"><span class="pre">false</span></code> if the user is denied access, or
if the object is unable to perform a check. If the object is able to
verify the user&#8217;s access, <code class="docutils literal"><span class="pre">true</span></code> should be returned. It&#8217;s not required
that you extend <code class="docutils literal"><span class="pre">BaseAuthorize</span></code>, only that your authorize object
implements an <code class="docutils literal"><span class="pre">authorize()</span></code> method. The <code class="docutils literal"><span class="pre">BaseAuthorize</span></code> class provides
a number of helpful methods that are commonly used.</p>
<div class="section" id="using-custom-authorize-objects">
<h4>Using custom authorize objects<a class="headerlink" href="#using-custom-authorize-objects" title="Permalink to this headline">¶</a></h4>
<p>Once you&#8217;ve created your custom authorize object, you can use them by
including them in your AuthComponent&#8217;s authorize array:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">authorize</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;Ldap&#39;</span><span class="p">,</span> <span class="c1">// app authorize object.</span>
    <span class="s1">&#39;AuthBag.Combo&#39;</span><span class="p">,</span> <span class="c1">// plugin authorize object.</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-no-authorization">
<h3>Using no authorization<a class="headerlink" href="#using-no-authorization" title="Permalink to this headline">¶</a></h3>
<p>If you&#8217;d like to not use any of the built-in authorization objects, and
want to handle things entirely outside of AuthComponent you can set
<code class="docutils literal"><span class="pre">$this-&gt;Auth-&gt;authorize</span> <span class="pre">=</span> <span class="pre">false;</span></code>. By default AuthComponent starts off
with <code class="docutils literal"><span class="pre">authorize</span> <span class="pre">=</span> <span class="pre">false</span></code>. If you don&#8217;t use an authorization scheme,
make sure to check authorization yourself in your controller&#8217;s
beforeFilter, or with another component.</p>
</div>
<div class="section" id="making-actions-public">
<h3>Making actions public<a class="headerlink" href="#making-actions-public" title="Permalink to this headline">¶</a></h3>
<p>There are often times controller actions that you wish to remain
entirely public, or that don&#8217;t require users to be logged in.
AuthComponent is pessimistic, and defaults to denying access. You can
mark actions as public actions by using <code class="docutils literal"><span class="pre">AuthComponent::allow()</span></code>. By
marking actions as public, AuthComponent, will not check for a logged in
user, nor will authorize objects be checked:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// Allow all actions. CakePHP 2.0 (deprecated).</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">allow</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">);</span>

<span class="c1">// Allow all actions. CakePHP 2.1 and later.</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">allow</span><span class="p">();</span>

<span class="c1">// Allow only the view and index actions.</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">allow</span><span class="p">(</span><span class="s1">&#39;view&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">);</span>

<span class="c1">// Allow only the view and index actions.</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">allow</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;view&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">));</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If you&#8217;re using scaffolding, allow all will not identify and allow the
scaffolded methods. You have to specify their action names.</p>
</div>
<p>You can provide as many action names as you need to <code class="docutils literal"><span class="pre">allow()</span></code>. You can
also supply an array containing all the action names.</p>
</div>
<div class="section" id="making-actions-require-authorization">
<h3>Making actions require authorization<a class="headerlink" href="#making-actions-require-authorization" title="Permalink to this headline">¶</a></h3>
<p>By default all actions require authorization. However, after making actions
public, you want to revoke the public access. You can do so using
<code class="docutils literal"><span class="pre">AuthComponent::deny()</span></code>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// remove one action</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">deny</span><span class="p">(</span><span class="s1">&#39;add&#39;</span><span class="p">);</span>

<span class="c1">// remove all the actions.</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">deny</span><span class="p">();</span>

<span class="c1">// remove a group of actions.</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">deny</span><span class="p">(</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="s1">&#39;edit&#39;</span><span class="p">);</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">deny</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="s1">&#39;edit&#39;</span><span class="p">));</span>
</pre></div>
</div>
<p>You can provide as many action names as you need to <code class="docutils literal"><span class="pre">deny()</span></code>. You can
also supply an array containing all the action names.</p>
</div>
<div class="section" id="using-controllerauthorize">
<h3>Using ControllerAuthorize<a class="headerlink" href="#using-controllerauthorize" title="Permalink to this headline">¶</a></h3>
<p>ControllerAuthorize allows you to handle authorization checks in a
controller callback. This is ideal when you have very simple
authorization, or you need to use a combination of models + components
to do your authorization, and don&#8217;t want to create a custom authorize
object.</p>
<p>The callback is always called <code class="docutils literal"><span class="pre">isAuthorized()</span></code> and it should return a
boolean as to whether or not the user is allowed to access resources in
the request. The callback is passed the active user, so it can be
checked:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">AppController</span> <span class="k">extends</span> <span class="nx">Controller</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$components</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;Auth&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;authorize&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Controller&#39;</span><span class="p">),</span>
    <span class="p">);</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">isAuthorized</span><span class="p">(</span><span class="nv">$user</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Any registered user can access public functions</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">params</span><span class="p">[</span><span class="s1">&#39;admin&#39;</span><span class="p">]))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// Only admins can access admin functions</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">params</span><span class="p">[</span><span class="s1">&#39;admin&#39;</span><span class="p">]))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="p">(</span><span class="nx">bool</span><span class="p">)(</span><span class="nv">$user</span><span class="p">[</span><span class="s1">&#39;role&#39;</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;admin&#39;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// Default deny</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above callback would provide a very simple authorization system
where, only users with role = admin could access actions that were in
the admin prefix.</p>
</div>
<div class="section" id="using-actionsauthorize">
<h3>Using ActionsAuthorize<a class="headerlink" href="#using-actionsauthorize" title="Permalink to this headline">¶</a></h3>
<p>ActionsAuthorize integrates with the AclComponent, and provides a fine
grained per action ACL check on each request. ActionsAuthorize is often
paired with DbAcl to give dynamic and flexible permission systems that
can be edited by admin users through the application. It can however,
be combined with other Acl implementations such as IniAcl and custom
application Acl backends.</p>
</div>
<div class="section" id="using-crudauthorize">
<h3>Using CrudAuthorize<a class="headerlink" href="#using-crudauthorize" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">CrudAuthorize</span></code> integrates with AclComponent, and provides the ability to
map requests to CRUD operations. Provides the ability to authorize
using CRUD mappings. These mapped results are then checked in the
AclComponent as specific permissions.</p>
<p>For example, taking <code class="docutils literal"><span class="pre">/posts/index</span></code> as the current request. The default
mapping for <code class="docutils literal"><span class="pre">index</span></code>, is a <code class="docutils literal"><span class="pre">read</span></code> permission check. The Acl check would
then be for the <code class="docutils literal"><span class="pre">posts</span></code> controller with the <code class="docutils literal"><span class="pre">read</span></code> permission. This
allows you to create permission systems that focus more on what is being
done to resources, rather than the specific actions being visited.</p>
</div>
<div class="section" id="mapping-actions-when-using-crudauthorize">
<h3>Mapping actions when using CrudAuthorize<a class="headerlink" href="#mapping-actions-when-using-crudauthorize" title="Permalink to this headline">¶</a></h3>
<p>When using CrudAuthorize or any other authorize objects that use action
mappings, it might be necessary to map additional methods. You can
map actions -&gt; CRUD permissions using mapAction(). Calling this on
AuthComponent will delegate to all the of the configured authorize
objects, so you can be sure the settings were applied every where:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">mapActions</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;create&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;register&#39;</span><span class="p">),</span>
    <span class="s1">&#39;view&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;show&#39;</span><span class="p">,</span> <span class="s1">&#39;display&#39;</span><span class="p">)</span>
<span class="p">));</span>
</pre></div>
</div>
<p>The keys for mapActions should be the CRUD permissions you want to set,
while the values should be an array of all the actions that are mapped
to the CRUD permission.</p>
</div>
</div>
<div class="section" id="authcomponent-api">
<h2>AuthComponent API<a class="headerlink" href="#authcomponent-api" title="Permalink to this headline">¶</a></h2>
<p>AuthComponent is the primary interface to the built-in authorization
and authentication mechanics in CakePHP.</p>
<dl class="attr">
<dt id="AuthComponent::$ajaxLogin">
<em class="property">property </em><code class="descclassname">AuthComponent::$</code><code class="descname">ajaxLogin</code><a class="headerlink" href="#AuthComponent::$ajaxLogin" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of an optional view element to render when an AJAX request is made
with an invalid or expired session.</p>
</dd></dl>

<dl class="attr">
<dt id="AuthComponent::$allowedActions">
<em class="property">property </em><code class="descclassname">AuthComponent::$</code><code class="descname">allowedActions</code><a class="headerlink" href="#AuthComponent::$allowedActions" title="Permalink to this definition">¶</a></dt>
<dd><p>Controller actions for which user validation is not required.</p>
</dd></dl>

<dl class="attr">
<dt id="AuthComponent::$authenticate">
<em class="property">property </em><code class="descclassname">AuthComponent::$</code><code class="descname">authenticate</code><a class="headerlink" href="#AuthComponent::$authenticate" title="Permalink to this definition">¶</a></dt>
<dd><p>Set to an array of Authentication objects you want to use when
logging users in. There are several core authentication objects,
see the section on <a class="reference internal" href="#authentication-objects"><span class="std std-ref">Suggested Reading Before Continuing</span></a>.</p>
</dd></dl>

<dl class="attr">
<dt id="AuthComponent::$authError">
<em class="property">property </em><code class="descclassname">AuthComponent::$</code><code class="descname">authError</code><a class="headerlink" href="#AuthComponent::$authError" title="Permalink to this definition">¶</a></dt>
<dd><p>Error to display when user attempts to access an object or action to which
they do not have access.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 2.4: </span>You can suppress authError message from being displayed by setting this
value to boolean <cite>false</cite>.</p>
</div>
</dd></dl>

<dl class="attr">
<dt id="AuthComponent::$authorize">
<em class="property">property </em><code class="descclassname">AuthComponent::$</code><code class="descname">authorize</code><a class="headerlink" href="#AuthComponent::$authorize" title="Permalink to this definition">¶</a></dt>
<dd><p>Set to an array of Authorization objects you want to use when
authorizing users on each request, see the section on
<a class="reference internal" href="#authorization-objects"><span class="std std-ref">Authorization</span></a>.</p>
</dd></dl>

<dl class="attr">
<dt id="AuthComponent::$components">
<em class="property">property </em><code class="descclassname">AuthComponent::$</code><code class="descname">components</code><a class="headerlink" href="#AuthComponent::$components" title="Permalink to this definition">¶</a></dt>
<dd><p>Other components utilized by AuthComponent</p>
</dd></dl>

<dl class="attr">
<dt id="AuthComponent::$flash">
<em class="property">property </em><code class="descclassname">AuthComponent::$</code><code class="descname">flash</code><a class="headerlink" href="#AuthComponent::$flash" title="Permalink to this definition">¶</a></dt>
<dd><p>Settings to use when Auth needs to do a flash message with
<code class="xref php php-meth docutils literal"><span class="pre">FlashComponent::set()</span></code>.
Available keys are:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">element</span></code> - The element to use, defaults to &#8216;default&#8217;.</li>
<li><code class="docutils literal"><span class="pre">key</span></code> - The key to use, defaults to &#8216;auth&#8217;</li>
<li><code class="docutils literal"><span class="pre">params</span></code> - The array of additional params to use, defaults to array()</li>
</ul>
</dd></dl>

<dl class="attr">
<dt id="AuthComponent::$loginAction">
<em class="property">property </em><code class="descclassname">AuthComponent::$</code><code class="descname">loginAction</code><a class="headerlink" href="#AuthComponent::$loginAction" title="Permalink to this definition">¶</a></dt>
<dd><p>A URL (defined as a string or array) to the controller action that handles
logins. Defaults to <cite>/users/login</cite></p>
</dd></dl>

<dl class="attr">
<dt id="AuthComponent::$loginRedirect">
<em class="property">property </em><code class="descclassname">AuthComponent::$</code><code class="descname">loginRedirect</code><a class="headerlink" href="#AuthComponent::$loginRedirect" title="Permalink to this definition">¶</a></dt>
<dd><p>The URL (defined as a string or array) to the controller action users
should be redirected to after logging in. This value will be ignored if the
user has an <code class="docutils literal"><span class="pre">Auth.redirect</span></code> value in their session.</p>
</dd></dl>

<dl class="attr">
<dt id="AuthComponent::$logoutRedirect">
<em class="property">property </em><code class="descclassname">AuthComponent::$</code><code class="descname">logoutRedirect</code><a class="headerlink" href="#AuthComponent::$logoutRedirect" title="Permalink to this definition">¶</a></dt>
<dd><p>The default action to redirect to after the user is logged out. While
AuthComponent does not handle post-logout redirection, a redirect URL will
be returned from <a class="reference internal" href="#AuthComponent::logout" title="AuthComponent::logout"><code class="xref php php-meth docutils literal"><span class="pre">AuthComponent::logout()</span></code></a>. Defaults to
<a class="reference internal" href="#AuthComponent::$loginAction" title="AuthComponent::$loginAction"><code class="xref php php-attr docutils literal"><span class="pre">AuthComponent::$loginAction</span></code></a>.</p>
</dd></dl>

<dl class="attr">
<dt id="AuthComponent::$unauthorizedRedirect">
<em class="property">property </em><code class="descclassname">AuthComponent::$</code><code class="descname">unauthorizedRedirect</code><a class="headerlink" href="#AuthComponent::$unauthorizedRedirect" title="Permalink to this definition">¶</a></dt>
<dd><p>Controls handling of unauthorized access. By default unauthorized user is
redirected to the referrer URL or <code class="docutils literal"><span class="pre">AuthComponent::$loginRedirect</span></code> or &#8216;/&#8217;.
If set to false a ForbiddenException exception is thrown instead of redirecting.</p>
</dd></dl>

<dl class="attr">
<dt id="AuthComponent::$request">
<em class="property">property </em><code class="descclassname">AuthComponent::$</code><code class="descname">request</code><a class="headerlink" href="#AuthComponent::$request" title="Permalink to this definition">¶</a></dt>
<dd><p>Request object</p>
</dd></dl>

<dl class="attr">
<dt id="AuthComponent::$response">
<em class="property">property </em><code class="descclassname">AuthComponent::$</code><code class="descname">response</code><a class="headerlink" href="#AuthComponent::$response" title="Permalink to this definition">¶</a></dt>
<dd><p>Response object</p>
</dd></dl>

<dl class="attr">
<dt id="AuthComponent::$sessionKey">
<em class="property">property </em><code class="descclassname">AuthComponent::$</code><code class="descname">sessionKey</code><a class="headerlink" href="#AuthComponent::$sessionKey" title="Permalink to this definition">¶</a></dt>
<dd><p>The session key name where the record of the current user is stored. If
unspecified, it will be &#8220;Auth.User&#8221;.</p>
</dd></dl>

<dl class="method">
<dt id="AuthComponent::allow">
<code class="descclassname">AuthComponent::</code><code class="descname">allow</code><span class="sig-paren">(</span><em>$action</em><span class="optional">[</span>, <em>$action</em>, <em>...</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#AuthComponent::allow" title="Permalink to this definition">¶</a></dt>
<dd><p>Set one or more actions as public actions, this means that no
authorization checks will be performed for the specified actions.
The special value of <code class="docutils literal"><span class="pre">'*'</span></code> will mark all the current controllers
actions as public. Best used in your controller&#8217;s beforeFilter
method.</p>
</dd></dl>

<dl class="method">
<dt id="AuthComponent::constructAuthenticate">
<code class="descclassname">AuthComponent::</code><code class="descname">constructAuthenticate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AuthComponent::constructAuthenticate" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the configured authentication objects.</p>
</dd></dl>

<dl class="method">
<dt id="AuthComponent::constructAuthorize">
<code class="descclassname">AuthComponent::</code><code class="descname">constructAuthorize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AuthComponent::constructAuthorize" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the authorization objects configured.</p>
</dd></dl>

<dl class="method">
<dt id="AuthComponent::deny">
<code class="descclassname">AuthComponent::</code><code class="descname">deny</code><span class="sig-paren">(</span><em>$action</em><span class="optional">[</span>, <em>$action</em>, <em>...</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#AuthComponent::deny" title="Permalink to this definition">¶</a></dt>
<dd><p>Toggle one or more actions previously declared as public actions,
as non-public methods. These methods will now require
authorization. Best used inside your controller&#8217;s beforeFilter
method.</p>
</dd></dl>

<dl class="method">
<dt id="AuthComponent::identify">
<code class="descclassname">AuthComponent::</code><code class="descname">identify</code><span class="sig-paren">(</span><em>$request</em>, <em>$response</em><span class="sig-paren">)</span><a class="headerlink" href="#AuthComponent::identify" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>$request</strong> (<a class="reference internal" href="../../controllers/request-response.html#CakeRequest" title="CakeRequest"><em>CakeRequest</em></a>) &#8211; The request to use.</li>
<li><strong>$response</strong> (<a class="reference internal" href="../../controllers/request-response.html#CakeResponse" title="CakeResponse"><em>CakeResponse</em></a>) &#8211; The response to use, headers can be
sent if authentication fails.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>This method is used by AuthComponent to identify a user based on the
information contained in the current request.</p>
</dd></dl>

<dl class="method">
<dt id="AuthComponent::initialize">
<code class="descclassname">AuthComponent::</code><code class="descname">initialize</code><span class="sig-paren">(</span><em>$Controller</em><span class="sig-paren">)</span><a class="headerlink" href="#AuthComponent::initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes AuthComponent for use in the controller.</p>
</dd></dl>

<dl class="method">
<dt id="AuthComponent::isAuthorized">
<code class="descclassname">AuthComponent::</code><code class="descname">isAuthorized</code><span class="sig-paren">(</span><em>$user = null</em>, <em>$request = null</em><span class="sig-paren">)</span><a class="headerlink" href="#AuthComponent::isAuthorized" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the configured Authorization adapters to check whether or not a user
is authorized. Each adapter will be checked in sequence, if any of them
return true, then the user will be authorized for the request.</p>
</dd></dl>

<dl class="method">
<dt id="AuthComponent::loggedIn">
<code class="descclassname">AuthComponent::</code><code class="descname">loggedIn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AuthComponent::loggedIn" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if the current client is a logged in user, or false if
they are not.</p>
</dd></dl>

<dl class="method">
<dt id="AuthComponent::login">
<code class="descclassname">AuthComponent::</code><code class="descname">login</code><span class="sig-paren">(</span><em>$user</em><span class="sig-paren">)</span><a class="headerlink" href="#AuthComponent::login" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>$user</strong> (<em>array</em>) &#8211; Array of logged in user data.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Takes an array of user data to login with. Allows for manual
logging of users. Calling user() will populate the session value
with the provided information. If no user is provided,
AuthComponent will try to identify a user using the current request
information. See <a class="reference internal" href="#AuthComponent::identify" title="AuthComponent::identify"><code class="xref php php-meth docutils literal"><span class="pre">AuthComponent::identify()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="AuthComponent::logout">
<code class="descclassname">AuthComponent::</code><code class="descname">logout</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AuthComponent::logout" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A string URL to redirect the logged out user to.</td>
</tr>
</tbody>
</table>
<p>Logs out the current user.</p>
</dd></dl>

<dl class="method">
<dt id="AuthComponent::mapActions">
<code class="descclassname">AuthComponent::</code><code class="descname">mapActions</code><span class="sig-paren">(</span><em>$map = array()</em><span class="sig-paren">)</span><a class="headerlink" href="#AuthComponent::mapActions" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps action names to CRUD operations. Used for controller-based
authentication. Make sure to configure the authorize property before
calling this method. As it delegates $map to all the attached authorize
objects.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="AuthComponent::password">
<em class="property">static </em><code class="descclassname">AuthComponent::</code><code class="descname">password</code><span class="sig-paren">(</span><em>$pass</em><span class="sig-paren">)</span><a class="headerlink" href="#AuthComponent::password" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 2.4.</span></p>
</div>
<dl class="method">
<dt id="AuthComponent::redirect">
<code class="descclassname">AuthComponent::</code><code class="descname">redirect</code><span class="sig-paren">(</span><em>$url = null</em><span class="sig-paren">)</span><a class="headerlink" href="#AuthComponent::redirect" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 2.3.</span></p>
</div>
<dl class="method">
<dt id="AuthComponent::redirectUrl">
<code class="descclassname">AuthComponent::</code><code class="descname">redirectUrl</code><span class="sig-paren">(</span><em>$url = null</em><span class="sig-paren">)</span><a class="headerlink" href="#AuthComponent::redirectUrl" title="Permalink to this definition">¶</a></dt>
<dd><p>If no parameter is passed, gets the authentication redirect URL. Pass a
URL in to set the destination a user should be redirected to upon logging
in. Will fallback to <a class="reference internal" href="#AuthComponent::$loginRedirect" title="AuthComponent::$loginRedirect"><code class="xref php php-attr docutils literal"><span class="pre">AuthComponent::$loginRedirect</span></code></a> if there is
no stored redirect value.</p>
</dd></dl>

<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
<dl class="method">
<dt id="AuthComponent::shutdown">
<code class="descclassname">AuthComponent::</code><code class="descname">shutdown</code><span class="sig-paren">(</span><em>$Controller</em><span class="sig-paren">)</span><a class="headerlink" href="#AuthComponent::shutdown" title="Permalink to this definition">¶</a></dt>
<dd><p>Component shutdown. If user is logged in, wipe out redirect.</p>
</dd></dl>

<dl class="method">
<dt id="AuthComponent::startup">
<code class="descclassname">AuthComponent::</code><code class="descname">startup</code><span class="sig-paren">(</span><em>$Controller</em><span class="sig-paren">)</span><a class="headerlink" href="#AuthComponent::startup" title="Permalink to this definition">¶</a></dt>
<dd><p>Main execution method. Handles redirecting of invalid users, and
processing of login form data.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="AuthComponent::user">
<em class="property">static </em><code class="descclassname">AuthComponent::</code><code class="descname">user</code><span class="sig-paren">(</span><em>$key = null</em><span class="sig-paren">)</span><a class="headerlink" href="#AuthComponent::user" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>$key</strong> (<em>string</em>) &#8211; The user data key you want to fetch. If null,
all user data will be returned. Can also be called as an instance
method.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Get data concerning the currently logged in user, you can use a
property key to fetch specific data about the user:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$id</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>If the current user is not logged in or the key doesn&#8217;t exist, null will
be returned.</p>
</dd></dl>

</div>
</div>


			</div>
		</div>

		
		<div class="col-md-3 col-md-pull-9 pull-off hidden-xs hidden-sm" lang="en">
			<aside class="sidebar">
				<div class="mb30 row">
<div id="sidebar-navigation" class="hidden-xs">
	<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cakephp-overview.html">CakePHP Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../controllers.html">Controllers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../views.html">Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../models.html">Models</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../core-libraries.html">Core Libraries</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../toc-general-purpose.html">General Purpose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../toc-behaviors.html">Behaviors</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../toc-components.html">Components</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="pagination.html">Pagination</a></li>
<li class="toctree-l3"><a class="reference internal" href="flash.html">Flash</a></li>
<li class="toctree-l3"><a class="reference internal" href="sessions.html">Sessions</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="security-component.html">Security</a></li>
<li class="toctree-l3"><a class="reference internal" href="request-handling.html">Request Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="cookie.html">Cookie</a></li>
<li class="toctree-l3"><a class="reference internal" href="access-control-lists.html">Access Control Lists</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../toc-helpers.html">Helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../toc-utilities.html">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../console-and-shells.html">Shells, Tasks &amp; Console Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deployment.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials-and-examples.html">Tutorials &amp; Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices.html">Appendices</a></li>
</ul>

</div>

				</div>
			</aside>
			<aside class="sidebar">
				<div class="mb30 row">
				</div>
			</aside>
		</div>
	</div>
</div>

<section id="socials" class="back-3">
	<div class="container-fluid">
		<div class="row">
			<div class="col-xs-12 col-sm-12 col-md-4  social text-center">
				<div class="col-sm-3 col-xs-3">
					<div id="fb-root"></div>
						<script>(function(d, s, id) {
						  var js, fjs = d.getElementsByTagName(s)[0];
						  if (d.getElementById(id)) return;
						  js = d.createElement(s); js.id = id;
						  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";
						  fjs.parentNode.insertBefore(js, fjs);
						}(document, 'script', 'facebook-jssdk'));
						</script>
						<div id="fb-root-face" class="fb-like" data-href="https://www.facebook.com/CakePHP/" data-layout="button_count" data-action="like" data-show-faces="true" data-share="false"></div>
				</div>

				<div class="col-sm-3 col-xs-3">
					<iframe src="https://ghbtns.com/github-btn.html?user=cakephp&amp;repo=cakephp&amp;type=star&amp;count=true&amp;size=small" frameborder="0" scrolling="0" width="120px" height="30px"></iframe>
				</div>

				<div class="col-sm-3 col-xs-3">
					<iframe src="https://ghbtns.com/github-btn.html?user=cakephp&amp;repo=cakephp&amp;type=fork&amp;count=true&amp;size=small" frameborder="0" scrolling="0" width="120px" height="30px"></iframe>
				</div>

				<div class="col-sm-3 col-xs-3">
					<a href="https://twitter.com/CakePHP" class="twitter-follow-button" data-show-count="false" data-show-screen-name="false">Follow @CakePHP</a>
					<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
				</div>
			</div>

			<div class="col-xs-12 col-sm-12 col-md-8 social-footer text-center ">
				<a href="#">发现翻译错误? 请在下面留言</a>
				<a href="https://github.com/blackpuppy/docs/wiki" target="_blank">我要加入翻译</a>
				<a href="https://twitter.com/cakephp" data-toggle="tooltip" title="Twitter"><i class="fa icon-social fa-twitter"></i>
				<a href="http://www.facebook.com/groups/cake.community" data-toggle="tooltip" title="Facebook"><i class="fa icon-social fa-facebook"></i></a>
				<a href="http://goo.gl/mSC0s" data-toggle="tooltip" title="Google Plus"><i class="fa icon-social  fa-google-plus"></i></a>
				<a href="http://www.youtube.com/user/CakePHP" data-toggle="tooltip" title="Youtube"><i class="fa icon-social fa-youtube-play"></i></a>
				<a href="https://github.com/cakephp" data-toggle="tooltip" title="Github"><i class="fa icon-social fa-git"></i></a>
				<a href="http://cakesf.herokuapp.com/" target="_blank" title="Slack" data-toggle="tooltip"><i class="fa fa-slack icon-social"></i></a>
				<a href="http://stackoverflow.com/tags/cakephp" data-toggle="tooltip" title="Stack Overflow"><i class="fa icon-social fa-stack-overflow"></i></a>
				<a href="http://webchat.freenode.net/?channels=cakephp" data-toggle="tooltip" title="IRC" class="icon-irc">#IRC</a>
			</div>
		</div>
	</div>
</section>

<footer id="footer" class="footer-wrapper">
	<div class="container">

		<div class="row col-p30">
			<div class="col-sm-12 col-md-3">
				<div class="footer-widget t-footer">
					<div class="col-md-12">
						<a href="https://www.openhub.net/p/cakephp">
							<img src="../../_static/open-hub.png">
						</a>
						<div class="mt10">
							<a href="https://www.rackspace.com/">
								<img src="../../_static/rackspace.png">
							</a>
						</div>
					</div>
				</div>
			</div>

			<div class="col-sm-12 col-md-9">
				<div class="col-md-3 col-sm-6 business-solution">
					<ul class="footer-menu">
						<li class="menu-title">
	<a href="http://cakephp.org/business-solutions"><i class="fa fa-menu-title fa-briefcase"></i>Business Solutions</a>
</li>
<li class="menu-title mt30">
	<a href="http://cakephp.org/showcase"><i class="fa fa-menu-title fa-desktop"></i>Showcase</a>
</li>
					</ul>
				</div>

				<div class="col-md-3 col-sm-6">
					<ul class="footer-menu">
						
<li class="menu-title">
	<i class="fa fa-menu-title fa-book"></i>Documentation
</li>

<li><a href="http://book.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>CookBook</a></li>
<li><a href="http://api.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>API</a></li>

<li><a href="http://cakephp.org/documentation/videos"><i class="fa fa-menu fa-chevron-right"></i>Videos</a></li>
<li><a href="http://cakephp.org/privacy"><i class="fa fa-menu fa-chevron-right"></i>Privacy Policy</a></li>
<li><a href="http://cakephp.org/pages/trademark"><i class="fa fa-menu fa-chevron-right"></i>Logos &amp; Trademarks</a></li>
					</ul>
				</div>

				<div class="col-md-3 col-sm-6">
					<ul class="footer-menu">
						
<li class="menu-title"><i class="fa fa-menu-title fa-users"></i>Community</li>

<li><a href="http://cakephp.org/team"><i class="fa fa-menu fa-chevron-right"></i>Team</a></li>
<li><a href="https://github.com/cakephp/cakephp/issues"><i class="fa fa-menu fa-chevron-right"></i>Issues (Github)</a></li>
<li><a href="http://www.youtube.com/user/CakePHP"><i class="fa fa-menu fa-chevron-right"></i>YouTube Channel</a></li>
<li><a href="http://cakephp.org/get-involved"><i class="fa fa-menu fa-chevron-right"></i>Get Involved</a></li>

<li><a href="http://bakery.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Bakery</a></li>
<li><a href="http://cakephp.org/newsletter/signup"><i class="fa fa-menu fa-chevron-right"></i>Newsletter</a></li>
<li><a href="http://certification.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Certification</a></li>
<li><a href="http://my.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>My CakePHP</a></li>
<li><a href="http://cakefest.org"><i class="fa fa-menu fa-chevron-right"></i>CakeFest</a></li>
<li><a href="http://www.facebook.com/groups/cake.community"><i class="fa fa-menu fa-chevron-right"></i>Facebook</a></li>
<li><a href="http://twitter.com/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Twitter</a></li>
					</ul>
				</div>

				<div class="col-md-3 col-sm-6">
					<ul class="footer-menu">
						
<li class="menu-title"><i class="fa fa-menu-title fa-comments-o"></i>Help &amp; Support</li>

<li><a href="http://discourse.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Forum</a></li>
<li><a href="http://stackoverflow.com/tags/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Stack Overflow</a></li>
<li><a href="http://webchat.freenode.net/?channels=cakephp"><i class="fa fa-menu fa-chevron-right"></i>IRC</a></li>
<li><a href="http://cakesf.herokuapp.com/"><i class="fa fa-menu fa-chevron-right"></i>Slack</a></li>
<li><a href="http://cakedc.com"><i class="fa fa-menu fa-chevron-right"></i>Paid Support</a></li>
					</ul>
				</div>
			</div>
		</div>

		<div class="row">
			<div class="col-md-12 text-center mt30">
				<p class="copyright">
							&copy; Copyright 2016, Cake Software Foundation, Inc.
						Last updated on Aug 04, 2016.
						Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.5.
				</p>
			</div>
		</div>
	</div>
</footer>

<div id="inline-search-results"></div>


</div>

<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-743287-3']);
	_gaq.push(['_trackPageview']);
	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>

<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F201cbc61deaf9f7ffb521fb23e83db40' type='text/javascript'%3E%3C/script%3E"));
</script>

<!-- Duoshuo Comment BEGIN -->
	<div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"cakephpchina"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0]
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- Duoshuo Comment END -->
  </body>
</html>