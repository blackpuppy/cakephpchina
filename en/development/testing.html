

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="Testing" lang="en" name="title" />
<meta content="web runner,phpunit,test database,database configuration,database setup,database test,public test,test framework,running one,test setup,de facto standard,pear,runners,array,databases,cakephp,php,integration" lang="en" name="keywords" />

    <title>Testing</title>
    <link href="../_static/favicon.png" type="image/png" rel="icon" />

    
    <link rel="stylesheet" href="../_static/css/app.css" type="text/css" />
    
    <script type="text/javascript" src="../_static/app.js"></script>

    <link rel="alternate" hreflang="pt" href="../../pt/development/testing.html" /><link rel="alternate" hreflang="es" href="../../es/development/testing.html" /><link rel="alternate" hreflang="ja" href="../../ja/development/testing.html" /><link rel="alternate" hreflang="fr" href="../../fr/development/testing.html" /><link rel="alternate" hreflang="zh" href="../../zh/development/testing.html" />

    <link rel="search" type="application/opensearchdescription+xml" title="Search within CakePHP Cookbook 2.x documentation" href="../_static/opensearchdescription-book-3-x.xml">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="top" title="CakePHP Cookbook 2.x documentation" href="../index.html" />
    <link rel="up" title="Development" href="../development.html" />
    <link rel="next" title="REST" href="rest.html" />
    <link rel="prev" title="Debugging" href="debugging.html" />

    <script type="text/javascript">
    window.lang = "en";
    </script>
  </head>
  <body>

<div id="container">
	
	<header class="nav-down">
		<div class="container-fluid hidden-xs hidden-sm">
			<div class="row">
				<div class="col-sm-3 col-md-3">
					<a class="logo-cake" href="http://cakephp.org">
						<img src="../_static/logo-cake.png" alt="CakePHP" />
					</a>
				</div>

				<div class="col-sm-9 col-md-9">
					<nav class="navbar-right">
						<ul class="menu">
							<li class="first">
								<a href="#"><i class="fa fa-menu fa-chevron-down"></i>Documentation</a>
								<ul class="submenu">
									
<li><a href="http://book.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>CookBook</a></li>
<li><a href="http://api.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>API</a></li>

<li><a href="http://cakephp.org/documentation/videos"><i class="fa fa-menu fa-chevron-right"></i>Videos</a></li>
<li><a href="http://cakephp.org/privacy"><i class="fa fa-menu fa-chevron-right"></i>Privacy Policy</a></li>
<li><a href="http://cakephp.org/pages/trademark"><i class="fa fa-menu fa-chevron-right"></i>Logos &amp; Trademarks</a></li>
								</ul>
							</li>

							<li><a href="http://cakephp.org/business-solutions">Business Solutions</a></li>
							<li><a href="http://cakephp.org/showcase">Showcase</a></li>

							<li>
								<a href="#"><i class="fa fa-menu fa-chevron-down"></i>Community</a>
								<div class="megamenu full">
									<div class="row">
										<div class="col-6 pl30">
											<ul class="megamenu-list">
												
<li class="menu-title"><i class="fa fa-menu-title fa-users"></i>Community</li>

<li><a href="http://cakephp.org/team"><i class="fa fa-menu fa-chevron-right"></i>Team</a></li>
<li><a href="https://github.com/cakephp/cakephp/issues"><i class="fa fa-menu fa-chevron-right"></i>Issues (Github)</a></li>
<li><a href="http://www.youtube.com/user/CakePHP"><i class="fa fa-menu fa-chevron-right"></i>YouTube Channel</a></li>
<li><a href="http://cakephp.org/get-involved"><i class="fa fa-menu fa-chevron-right"></i>Get Involved</a></li>

<li><a href="http://bakery.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Bakery</a></li>
<li><a href="http://cakephp.org/newsletter/signup"><i class="fa fa-menu fa-chevron-right"></i>Newsletter</a></li>
<li><a href="http://certification.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Certification</a></li>
<li><a href="http://my.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>My CakePHP</a></li>
<li><a href="http://cakefest.org"><i class="fa fa-menu fa-chevron-right"></i>CakeFest</a></li>
<li><a href="http://www.facebook.com/groups/cake.community"><i class="fa fa-menu fa-chevron-right"></i>Facebook</a></li>
<li><a href="http://twitter.com/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Twitter</a></li>
											</ul>
										</div>
										<div class="col-6 pl30">
											<ul class="megamenu-list">
												
<li class="menu-title"><i class="fa fa-menu-title fa-comments-o"></i>Help &amp; Support</li>

<li><a href="http://discourse.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Forum</a></li>
<li><a href="http://stackoverflow.com/tags/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Stack Overflow</a></li>
<li><a href="http://webchat.freenode.net/?channels=cakephp"><i class="fa fa-menu fa-chevron-right"></i>IRC</a></li>
<li><a href="http://cakesf.herokuapp.com/"><i class="fa fa-menu fa-chevron-right"></i>Slack</a></li>
<li><a href="http://cakedc.com"><i class="fa fa-menu fa-chevron-right"></i>Paid Support</a></li>
											</ul>
										</div>
									</div>
								</div>
							</li>
						</ul>
					</nav>
				</div>
			</div>
		</div>

		
		<div class="container-fluid hidden-md hidden-lg">
			<div class="row">
				<div class="col-sm-6 col-xs-6">
					<a class="logo-cake" href="http://cakephp.org">
						<img src="../_static/logo-cake.png" alt="CakePHP" />
					</a>
				</div>

				<div class="col-sm-6 col-xs-6">
					<div class="navbar-right">
						<button id="btn-menu" class="btn-menu" data-toggle="modal" data-target="#modal">
							<i class="fa fa-bars toggle-modal"></i>
						</button>
					</div>
					<div id="wrap">
						<form class="search" action="../search.html" method="get">
							<input name="q" type="search" placeholder="What are you looking for?">
							<input id="search_submit" value="Search" type="submit">
						</form>
					</div>
				</div>
			</div>
		</div>

		
		<section id="nav-cook" class="hidden-xs hidden-sm">
			<div class="container-fluid ">
				<div class="row ">
					<div class="col-md-12 back-book">
						<div class="col-md-4 col-md-offset-1 text-center t-cook-nav p0 hidden-sm hidden-xs">
							<h2>
								<a href="../contents.html">
									<span class="glyph_range icon-submenu icon-submenu-cook">B</span>
									CakePHP 2.x <strong>Cookbook</strong>
								</a>
							</h2>
						</div>

						<div class="col-md-4 hidden-sm">
							<form class="search" action="../search.html" method="get">
								<input type="hidden" name="check_keywords" value="yes" />
								<input type="hidden" name="area" value="default" />

								<div class="col-md-10 p0">
									<input class="form-control form-cook" autocomplete="off" type="search" name="q" size="18" placeholder='Cookbook Search' />
								</div>
								<div class="col-md-2 p0 search-cook">
									<button type="submit">
										<span class="glyph_range icon-submenu icon-submenu-cook">A</span>
									</button>
								</div>
							</form>
						</div>

						
						<div class="col-md-3">
							<div class="col-md-6 p0">
								<div class="col-md-7 t-language p0">
									<h6>Language:</h6>
								</div>
								<div class="col-md-5 p0">
									<ul class="nav navbar-nav">
										<li class="dropdown">
											<a class="dropdown-toggle" data-hover="dropdown" data-toggle="dropdown"
													role="button" aria-haspopup="true" aria-expanded="false" href="#">
														en
														<i class="fa fa-menu-en fa-chevron-down"></i>
													</a>
											<ul class="dropdown-menu">
											
												<li></li>
											
												<li><a href="../../pt/development/testing.html">pt</a></li>
											
												<li><a href="../../es/development/testing.html">es</a></li>
											
												<li><a href="../../ja/development/testing.html">ja</a></li>
											
												<li><a href="../../fr/development/testing.html">fr</a></li>
											
												<li><a href="../../zh/development/testing.html">zh</a></li>
											
											</ul>
										</li>
									</ul>
								</div>
							</div>

							<div class="col-md-6 p0">
								<div class="col-md-7 t-language p0">
									<h6>Version:</h6>
								</div>
								<div class="col-md-5 p0">
									<ul class="nav navbar-nav">
										<li class="dropdown">
											<a href="#" class="dropdown-toggle" data-hover="dropdown" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">2.x <i class="fa fa-menu-en fa-chevron-down"></i></a>
											<ul class="dropdown-menu">
												<li><a href="http://book.cakephp.org/3.0/en">3.x Book</a></li>
												<li><a href="http://book.cakephp.org/2.0/en">2.x Book</a></li>
												<li><a href="http://book.cakephp.org/1.3/en/">1.3 Book</a></li>
												<li><a href="http://book.cakephp.org/1.2/en/">1.2 Book</a></li>
												<li><a href="http://book.cakephp.org/1.1/en">1.1 Book</a></li>
											</ul>
										</li>
									</ul>
								</div>
							</div>
						</div>

					</div>
				</div>
			</div>
		</section>
	</header>

	
	<section class="nav-btn visible-sm visible-xs">
		<div class="container">
			<div class="row">
				<div class="col-sm-6 col-xs-6 text-center">
					<button id="btn-nav" class="btn btn-b btn-nav" data-toggle="modal" data-target="#modal"><strong>Nav</strong></button>
				</div>

				<div class="col-sm-6 col-xs-6 text-center">
					<button id="btn-toc" class="btn btn-b btn-nav" data-toggle="modal" data-target="#modal"><strong>Table of Contents</strong></button>
				</div>
			</div>
		</div>
	</section>

	
	<div id="modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modal-header">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
					<h4 class="modal-title-cookbook" id="modal-header"></h4>
				</div>
				<div class="modal-body"></div>
			</div>
		</div>
	</div>

<div class="container page-container"><div id="improve-slideout">
		<i class="fa fa-pencil icon-improve"></i>
		<a href="https://github.com/cakephp/docs/edit/master/en/development/testing.rst" target="_blank">
			<div id="improve-slideout-inner"><h6>Improve This Doc <i class="fa fa-github git-improve"></i></h6></div>
		</a>
	</div><a id="back-to-contents" href="#page-contents"><i class="fa fa-arrow-circle-up icon-improve" title="Back to Contents"></i></a>

	
	<div class="row">
		<div class="col-sm-12 col-md-9 col-md-push-3 space-left push-off"><div class="page-contents col-sm-5">
				<h3>Page Contents</h3>
				<ul>
<li><a class="reference internal" href="#">Testing</a><ul>
<li><a class="reference internal" href="#installing-phpunit">Installing PHPUnit</a><ul>
<li><a class="reference internal" href="#install-via-composer">Install via Composer</a></li>
<li><a class="reference internal" href="#install-via-phar-package">Install via .phar Package</a></li>
</ul>
</li>
<li><a class="reference internal" href="#test-database-setup">Test Database Setup</a></li>
<li><a class="reference internal" href="#checking-the-test-setup">Checking the Test Setup</a></li>
<li><a class="reference internal" href="#test-case-conventions">Test Case Conventions</a></li>
<li><a class="reference internal" href="#creating-your-first-test-case">Creating Your First Test Case</a></li>
<li><a class="reference internal" href="#running-tests">Running Tests</a><ul>
<li><a class="reference internal" href="#running-tests-from-a-browser">Running tests from a browser</a><ul>
<li><a class="reference internal" href="#viewing-code-coverage">Viewing code coverage</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-tests-from-command-line">Running tests from command line</a><ul>
<li><a class="reference internal" href="#filtering-test-cases">Filtering test cases</a></li>
<li><a class="reference internal" href="#generating-code-coverage">Generating code coverage</a></li>
<li><a class="reference internal" href="#running-tests-that-use-sessions">Running tests that use sessions</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#test-case-lifecycle-callbacks">Test Case Lifecycle Callbacks</a></li>
<li><a class="reference internal" href="#fixtures">Fixtures</a><ul>
<li><a class="reference internal" href="#creating-fixtures">Creating fixtures</a></li>
<li><a class="reference internal" href="#dynamic-data-and-fixtures">Dynamic data and fixtures</a></li>
<li><a class="reference internal" href="#importing-table-information-and-records">Importing table information and records</a></li>
<li><a class="reference internal" href="#loading-fixtures-in-your-test-cases">Loading fixtures in your test cases</a></li>
</ul>
</li>
<li><a class="reference internal" href="#testing-models">Testing Models</a><ul>
<li><a class="reference internal" href="#creating-a-test-method">Creating a test method</a></li>
<li><a class="reference internal" href="#mocking-model-methods">Mocking model methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#testing-controllers">Testing Controllers</a><ul>
<li><a class="reference internal" href="#simulating-get-requests">Simulating GET requests</a></li>
<li><a class="reference internal" href="#choosing-the-return-type">Choosing the return type</a></li>
<li><a class="reference internal" href="#using-mocks-with-testaction">Using mocks with testAction</a></li>
<li><a class="reference internal" href="#a-more-complex-example">A more complex example</a></li>
<li><a class="reference internal" href="#testing-a-json-responding-controller">Testing a JSON Responding Controller</a></li>
</ul>
</li>
<li><a class="reference internal" href="#testing-views">Testing Views</a></li>
<li><a class="reference internal" href="#testing-components">Testing Components</a></li>
<li><a class="reference internal" href="#testing-helpers">Testing Helpers</a></li>
<li><a class="reference internal" href="#creating-test-suites">Creating Test Suites</a></li>
<li><a class="reference internal" href="#creating-tests-for-plugins">Creating Tests for Plugins</a></li>
<li><a class="reference internal" href="#integration-with-jenkins">Integration with Jenkins</a><ul>
<li><a class="reference internal" href="#create-a-job">Create a job</a></li>
<li><a class="reference internal" href="#add-test-database-config">Add test database config</a></li>
<li><a class="reference internal" href="#add-your-tests">Add your tests</a></li>
<li><a class="reference internal" href="#run-a-build">Run a build</a></li>
</ul>
</li>
</ul>
</li>
</ul>

			</div><div class="document-body">
			
  <div class="section" id="testing">
<h1>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h1>
<p>CakePHP comes with comprehensive testing support built-in. CakePHP comes with
integration for <a class="reference external" href="http://phpunit.de">PHPUnit</a>. In addition to the features
offered by PHPUnit, CakePHP offers some additional features to make testing
easier. This section will cover installing PHPUnit, and getting started with
Unit Testing, and how you can use the extensions that CakePHP offers.</p>
<div class="section" id="installing-phpunit">
<h2>Installing PHPUnit<a class="headerlink" href="#installing-phpunit" title="Permalink to this headline">¶</a></h2>
<p>CakePHP uses PHPUnit as its underlying test framework. PHPUnit is the de-facto
standard for unit testing in PHP. It offers a deep and powerful set of features
for making sure your code does what you think it does.</p>
<div class="section" id="install-via-composer">
<h3>Install via Composer<a class="headerlink" href="#install-via-composer" title="Permalink to this headline">¶</a></h3>
<p>The newer versions of PHPUnit do not currently work with cake:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="s2">&quot;phpunit/phpunit&quot;</span><span class="o">:</span> <span class="s2">&quot;3.7.38&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="install-via-phar-package">
<h3>Install via .phar Package<a class="headerlink" href="#install-via-phar-package" title="Permalink to this headline">¶</a></h3>
<p>You can also download the file directly. Just make sure you get the correct version from <a class="reference external" href="https://phar.phpunit.de/">https://phar.phpunit.de/</a>.
Make sure /usr/local/bin is in your php.ini file&#8217;s include_path:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">wget</span> <span class="nx">https</span><span class="o">://</span><span class="nx">phar</span><span class="o">.</span><span class="nx">phpunit</span><span class="o">.</span><span class="nx">de</span><span class="o">/</span><span class="nx">phpunit</span><span class="o">-</span><span class="mf">3.7</span><span class="o">.</span><span class="mf">38.</span><span class="nx">phar</span> <span class="o">-</span><span class="nx">O</span> <span class="nx">phpunit</span><span class="o">.</span><span class="nx">phar</span>
<span class="nb">chmod</span> <span class="o">+</span><span class="nx">x</span> <span class="nx">phpunit</span><span class="o">.</span><span class="nx">phar</span>
<span class="nx">mv</span> <span class="nx">phpunit</span><span class="o">.</span><span class="nx">phar</span> <span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">local</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">phpunit</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>PHPUnit 4 is not compatible with CakePHP&#8217;s Unit Testing.</p>
<p class="last">Depending on your system&#8217;s configuration, you may need to run the previous
commands with <code class="docutils literal"><span class="pre">sudo</span></code></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In CakePHP 2.5.7 and later you can place the phar directly in your vendors or App/Vendor directory.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">All output is swallowed when using PHPUnit 3.6+. Add the <code class="docutils literal"><span class="pre">--debug</span></code>
modifier if using the CLI or add <code class="docutils literal"><span class="pre">&amp;debug=1</span></code> to the URL if using the web
runner to display output.</p>
</div>
</div>
</div>
<div class="section" id="test-database-setup">
<h2>Test Database Setup<a class="headerlink" href="#test-database-setup" title="Permalink to this headline">¶</a></h2>
<p>Remember to have a debug level of at least 1 in your <code class="docutils literal"><span class="pre">app/Config/core.php</span></code>
file before running any tests. Tests are not accessible via the web runner when
debug is equal to 0. Before running any tests you should be sure to add a
<code class="docutils literal"><span class="pre">$test</span></code> database configuration. This configuration is used by CakePHP for
fixture tables and data:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="nv">$test</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;datasource&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Database/Mysql&#39;</span><span class="p">,</span>
    <span class="s1">&#39;persistent&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
    <span class="s1">&#39;host&#39;</span>       <span class="o">=&gt;</span> <span class="s1">&#39;dbhost&#39;</span><span class="p">,</span>
    <span class="s1">&#39;login&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;dblogin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;password&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;dbpassword&#39;</span><span class="p">,</span>
    <span class="s1">&#39;database&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;test_database&#39;</span>
<span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It&#8217;s a good idea to make the test database and your actual database
different databases. This will prevent any embarrassing mistakes later.</p>
</div>
</div>
<div class="section" id="checking-the-test-setup">
<h2>Checking the Test Setup<a class="headerlink" href="#checking-the-test-setup" title="Permalink to this headline">¶</a></h2>
<p>After installing PHPUnit and setting up your <code class="docutils literal"><span class="pre">$test</span></code> database configuration
you can make sure you&#8217;re ready to write and run your own tests by running one of
the core tests. There are two built-in runners for testing, we&#8217;ll start off by
using the web runner. The tests can then be accessed by browsing to
<a class="reference external" href="http://localhost/your_app/test.php">http://localhost/your_app/test.php</a>. You should see a list of the core test
cases. Click on the &#8216;AllConfigure&#8217; test. You should see a green bar with some
additional information about the tests run, and number passed.</p>
<p>Congratulations, you are now ready to start writing tests!</p>
</div>
<div class="section" id="test-case-conventions">
<h2>Test Case Conventions<a class="headerlink" href="#test-case-conventions" title="Permalink to this headline">¶</a></h2>
<p>Like most things in CakePHP, test cases have some conventions. Concerning
tests:</p>
<ol class="arabic simple">
<li>PHP files containing tests should be in your
<code class="docutils literal"><span class="pre">app/Test/Case/[Type]</span></code> directories.</li>
<li>The filenames of these files should end in <code class="docutils literal"><span class="pre">Test.php</span></code> instead
of just .php.</li>
<li>The classes containing tests should extend <code class="docutils literal"><span class="pre">CakeTestCase</span></code>,
<code class="docutils literal"><span class="pre">ControllerTestCase</span></code> or <code class="docutils literal"><span class="pre">PHPUnit_Framework_TestCase</span></code>.</li>
<li>Like other class names, the test case class names should match the filename.
<code class="docutils literal"><span class="pre">RouterTest.php</span></code> should contain <code class="docutils literal"><span class="pre">class</span> <span class="pre">RouterTest</span> <span class="pre">extends</span> <span class="pre">CakeTestCase</span></code>.</li>
<li>The name of any method containing a test (i.e. containing an
assertion) should begin with <code class="docutils literal"><span class="pre">test</span></code>, as in <code class="docutils literal"><span class="pre">testPublished()</span></code>.
You can also use the <code class="docutils literal"><span class="pre">&#64;test</span></code> annotation to mark methods as test methods.</li>
</ol>
<p>When you have created a test case, you can execute it by browsing
to <code class="docutils literal"><span class="pre">http://localhost/your_app/test.php</span></code> (depending on
how your specific setup looks). Click App test cases, and
then click the link to your specific file. You can run tests from the command
line using the test shell:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="o">./</span><span class="nx">Console</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">test</span> <span class="nx">app</span> <span class="nx">Model</span><span class="o">/</span><span class="nx">Post</span>
</pre></div>
</div>
<p>For example, would run the tests for your Post model.</p>
</div>
<div class="section" id="creating-your-first-test-case">
<h2>Creating Your First Test Case<a class="headerlink" href="#creating-your-first-test-case" title="Permalink to this headline">¶</a></h2>
<p>In the following example, we&#8217;ll create a test case for a very simple helper
method. The helper we&#8217;re going to test will be formatting progress bar HTML.
Our helper looks like:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ProgressHelper</span> <span class="k">extends</span> <span class="nx">AppHelper</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">bar</span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$width</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nv">$value</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">;</span>
        <span class="k">return</span> <span class="nb">sprintf</span><span class="p">(</span>
            <span class="s1">&#39;&lt;div class=&quot;progress-container&quot;&gt;</span>
<span class="s1">                &lt;div class=&quot;progress-bar&quot; style=&quot;width: %s%%&quot;&gt;&lt;/div&gt;</span>
<span class="s1">            &lt;/div&gt;&#39;</span><span class="p">,</span> <span class="nv">$width</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is a very simple example, but it will be useful to show how you can create
a simple test case. After creating and saving our helper, we&#8217;ll create the test
case file in <code class="docutils literal"><span class="pre">app/Test/Case/View/Helper/ProgressHelperTest.php</span></code>. In that file
we&#8217;ll start with the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;Controller&#39;</span><span class="p">,</span> <span class="s1">&#39;Controller&#39;</span><span class="p">);</span>
<span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;View&#39;</span><span class="p">,</span> <span class="s1">&#39;View&#39;</span><span class="p">);</span>
<span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;ProgressHelper&#39;</span><span class="p">,</span> <span class="s1">&#39;View/Helper&#39;</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">ProgressHelperTest</span> <span class="k">extends</span> <span class="nx">CakeTestCase</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setUp</span><span class="p">()</span> <span class="p">{</span>

    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">testBar</span><span class="p">()</span> <span class="p">{</span>

    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We&#8217;ll flesh out this skeleton in a minute. We&#8217;ve added two methods to start
with. First is <code class="docutils literal"><span class="pre">setUp()</span></code>. This method is called before every <em>test</em> method
in a test case class. Setup methods should initialize the objects needed for the
test, and do any configuration needed. In our setup method we&#8217;ll add the
following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">setUp</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">parent</span><span class="o">::</span><span class="na">setUp</span><span class="p">();</span>
    <span class="nv">$Controller</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Controller</span><span class="p">();</span>
    <span class="nv">$View</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">View</span><span class="p">(</span><span class="nv">$Controller</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Progress</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ProgressHelper</span><span class="p">(</span><span class="nv">$View</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Calling the parent method is important in test cases, as CakeTestCase::setUp()
does a number of things like backing up the values in <a class="reference internal" href="configuration.html#Configure" title="Configure"><code class="xref php php-class docutils literal"><span class="pre">Configure</span></code></a> and,
storing the paths in <a class="reference internal" href="../core-utility-libraries/app.html#App" title="App"><code class="xref php php-class docutils literal"><span class="pre">App</span></code></a>.</p>
<p>Next, we&#8217;ll fill out the test method. We&#8217;ll use some assertions to ensure that
our code creates the output we expect:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">testBar</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Progress</span><span class="o">-&gt;</span><span class="na">bar</span><span class="p">(</span><span class="mi">90</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertContains</span><span class="p">(</span><span class="s1">&#39;width: 90%&#39;</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertContains</span><span class="p">(</span><span class="s1">&#39;progress-bar&#39;</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>

    <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Progress</span><span class="o">-&gt;</span><span class="na">bar</span><span class="p">(</span><span class="mf">33.3333333</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertContains</span><span class="p">(</span><span class="s1">&#39;width: 33%&#39;</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above test is a simple one but shows the potential benefit of using test
cases. We use <code class="docutils literal"><span class="pre">assertContains()</span></code> to ensure that our helper is returning a
string that contains the content we expect. If the result did not contain the
expected content the test would fail, and we would know that our code is
incorrect.</p>
<p>By using test cases you can easily describe the relationship between a set of
known inputs and their expected output. This helps you be more confident of the
code you&#8217;re writing as you can easily check that the code you wrote fulfills the
expectations and assertions your tests make. Additionally because tests are
code, they are easy to re-run whenever you make a change. This helps prevent
the creation of new bugs.</p>
</div>
<div class="section" id="running-tests">
<span id="id1"></span><h2>Running Tests<a class="headerlink" href="#running-tests" title="Permalink to this headline">¶</a></h2>
<p>Once you have PHPUnit installed and some test cases written, you&#8217;ll want to run
the test cases very frequently. It&#8217;s a good idea to run tests before committing
any changes to help ensure you haven&#8217;t broken anything.</p>
<div class="section" id="running-tests-from-a-browser">
<h3>Running tests from a browser<a class="headerlink" href="#running-tests-from-a-browser" title="Permalink to this headline">¶</a></h3>
<p>CakePHP provides a web interface for running tests, so you can execute your
tests through a browser if you&#8217;re more comfortable in that environment. You can
access the web runner by going to <code class="docutils literal"><span class="pre">http://localhost/your_app/test.php</span></code>. The
exact location of test.php will change depending on your setup. But the file is
at the same level as <code class="docutils literal"><span class="pre">index.php</span></code>.</p>
<p>Once you&#8217;ve loaded up the test runner, you can navigate App, Core and Plugin
test suites. Clicking an individual test case will run that test and display the
results.</p>
<div class="section" id="viewing-code-coverage">
<h4>Viewing code coverage<a class="headerlink" href="#viewing-code-coverage" title="Permalink to this headline">¶</a></h4>
<p>If you have <a class="reference external" href="http://xdebug.org">Xdebug</a> installed, you can view code coverage
results. Code coverage is useful for telling you what parts of your code your
tests do not reach. Coverage is useful for determining where you should add
tests in the future, and gives you one measurement to track your testing
progress with.</p>
<p><img alt="Code Coverage" src="../_images/code-coverage.png" /></p>
<p>The inline code coverage uses green lines to indicate lines that have been run.
If you hover over a green line a tooltip will indicate which tests covered the
line. Lines in red did not run, and have not been exercised by your tests. Grey
lines are considered unexecutable code by Xdebug.</p>
</div>
</div>
<div class="section" id="running-tests-from-command-line">
<span id="run-tests-from-command-line"></span><h3>Running tests from command line<a class="headerlink" href="#running-tests-from-command-line" title="Permalink to this headline">¶</a></h3>
<p>CakePHP provides a <code class="docutils literal"><span class="pre">test</span></code> shell for running tests. You can run app, core and
plugin tests easily using the test shell. It accepts all the arguments you would
expect to find on the normal PHPUnit command line tool as well. From your app
directory you can do the following to run tests:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1"># Run a model tests in the app</span>
<span class="o">./</span><span class="nx">Console</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">test</span> <span class="nx">app</span> <span class="nx">Model</span><span class="o">/</span><span class="nx">Article</span>

<span class="c1"># Run a component test in a plugin</span>
<span class="o">./</span><span class="nx">Console</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">test</span> <span class="nx">DebugKit</span> <span class="nx">Controller</span><span class="o">/</span><span class="nx">Component</span><span class="o">/</span><span class="nx">ToolbarComponent</span>

<span class="c1"># Run the configure class test in CakePHP</span>
<span class="o">./</span><span class="nx">Console</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">test</span> <span class="nx">core</span> <span class="nx">Core</span><span class="o">/</span><span class="nx">Configure</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you are running tests that interact with the session it&#8217;s generally a
good idea to use the <code class="docutils literal"><span class="pre">--stderr</span></code> option. This will fix issues with tests
failing because of headers_sent warnings.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 2.1: </span>The <code class="docutils literal"><span class="pre">test</span></code> shell was added in 2.1. The 2.0 <code class="docutils literal"><span class="pre">testsuite</span></code> shell is still
available but the new syntax is preferred.</p>
</div>
<p>You can also run <code class="docutils literal"><span class="pre">test</span></code> shell in the project root directory. This shows you a
full list of all the tests that you currently have. You can then freely choose
what test(s) to run:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1"># Run test in project root directory for application folder called app</span>
<span class="nx">lib</span><span class="o">/</span><span class="nx">Cake</span><span class="o">/</span><span class="nx">Console</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">test</span> <span class="nx">app</span>

<span class="c1"># Run test in project root directory for an application in ./myapp</span>
<span class="nx">lib</span><span class="o">/</span><span class="nx">Cake</span><span class="o">/</span><span class="nx">Console</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">test</span> <span class="o">--</span><span class="nx">app</span> <span class="nx">myapp</span> <span class="nx">app</span>
</pre></div>
</div>
<div class="section" id="filtering-test-cases">
<h4>Filtering test cases<a class="headerlink" href="#filtering-test-cases" title="Permalink to this headline">¶</a></h4>
<p>When you have larger test cases, you will often want to run a subset of the test
methods when you are trying to work on a single failing case. With the CLI
runner you can use an option to filter test methods:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="o">./</span><span class="nx">Console</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">test</span> <span class="nx">core</span> <span class="nx">Console</span><span class="o">/</span><span class="nx">ConsoleOutput</span> <span class="o">--</span><span class="nx">filter</span> <span class="nx">testWriteArray</span>
</pre></div>
</div>
<p>The filter parameter is used as a case-sensitive regular expression for filtering
which test methods to run.</p>
</div>
<div class="section" id="generating-code-coverage">
<h4>Generating code coverage<a class="headerlink" href="#generating-code-coverage" title="Permalink to this headline">¶</a></h4>
<p>You can generate code coverage reports from the command line using PHPUnit&#8217;s
built-in code coverage tools. PHPUnit will generate a set of static HTML files
containing the coverage results. You can generate coverage for a test case by
doing the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="o">./</span><span class="nx">Console</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">test</span> <span class="nx">app</span> <span class="nx">Model</span><span class="o">/</span><span class="nx">Article</span> <span class="o">--</span><span class="nx">coverage</span><span class="o">-</span><span class="nx">html</span> <span class="nx">webroot</span><span class="o">/</span><span class="nx">coverage</span>
</pre></div>
</div>
<p>This will put the coverage results in your application&#8217;s webroot directory. You
should be able to view the results by going to
<code class="docutils literal"><span class="pre">http://localhost/your_app/coverage</span></code>.</p>
</div>
<div class="section" id="running-tests-that-use-sessions">
<h4>Running tests that use sessions<a class="headerlink" href="#running-tests-that-use-sessions" title="Permalink to this headline">¶</a></h4>
<p>When running tests on the command line that use sessions you&#8217;ll need to include
the <code class="docutils literal"><span class="pre">--stderr</span></code> flag. Failing to do so will cause sessions to not work.
PHPUnit outputs test progress to stdout by default, this causes PHP to assume
that headers have been sent which prevents sessions from starting. By switching
PHPUnit to output on stderr, this issue is avoided.</p>
</div>
</div>
</div>
<div class="section" id="test-case-lifecycle-callbacks">
<h2>Test Case Lifecycle Callbacks<a class="headerlink" href="#test-case-lifecycle-callbacks" title="Permalink to this headline">¶</a></h2>
<p>Test cases have a number of lifecycle callbacks you can use when doing testing:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">setUp</span></code> is called before every test method. Should be used to create the
objects that are going to be tested, and initialize any data for the test.
Always remember to call <code class="docutils literal"><span class="pre">parent::setUp()</span></code></li>
<li><code class="docutils literal"><span class="pre">tearDown</span></code> is called after every test method. Should be used to cleanup after
the test is complete. Always remember to call <code class="docutils literal"><span class="pre">parent::tearDown()</span></code>.</li>
<li><code class="docutils literal"><span class="pre">setupBeforeClass</span></code> is called once before test methods in a case are started.
This method must be <em>static</em>.</li>
<li><code class="docutils literal"><span class="pre">tearDownAfterClass</span></code> is called once after test methods in a case are started.
This method must be <em>static</em>.</li>
</ul>
</div>
<div class="section" id="fixtures">
<h2>Fixtures<a class="headerlink" href="#fixtures" title="Permalink to this headline">¶</a></h2>
<p>When testing code that depends on models and the database, one can use
<strong>fixtures</strong> as a way to generate temporary data tables loaded with sample data
that can be used by the test. The benefit of using fixtures is that your test
has no chance of disrupting live application data. In addition, you can begin
testing your code prior to actually developing live content for an application.</p>
<p>CakePHP uses the connection named <code class="docutils literal"><span class="pre">$test</span></code> in your <code class="docutils literal"><span class="pre">app/Config/database.php</span></code>
configuration file. If this connection is not usable, an exception will be
raised and you will not be able to use database fixtures.</p>
<p>CakePHP performs the following during the course of a fixture based test case:</p>
<ol class="arabic simple">
<li>Creates tables for each of the fixtures needed.</li>
<li>Populates tables with data, if data is provided in fixture.</li>
<li>Runs test methods.</li>
<li>Empties the fixture tables.</li>
<li>Removes fixture tables from database.</li>
</ol>
<div class="section" id="creating-fixtures">
<h3>Creating fixtures<a class="headerlink" href="#creating-fixtures" title="Permalink to this headline">¶</a></h3>
<p>When creating a fixture you will mainly define two things: how the table is
created (which fields are part of the table), and which records will be
initially populated to the table. Let&#8217;s create our first fixture, that will be
used to test our own Article model. Create a file named <code class="docutils literal"><span class="pre">ArticleFixture.php</span></code>
in your <code class="docutils literal"><span class="pre">app/Test/Fixture</span></code> directory, with the following content:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ArticleFixture</span> <span class="k">extends</span> <span class="nx">CakeTestFixture</span> <span class="p">{</span>

      <span class="c1">// Optional.</span>
      <span class="c1">// Set this property to load fixtures to a different test datasource</span>
      <span class="k">public</span> <span class="nv">$useDbConfig</span> <span class="o">=</span> <span class="s1">&#39;test&#39;</span><span class="p">;</span>
      <span class="k">public</span> <span class="nv">$fields</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
          <span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;primary&#39;</span><span class="p">),</span>
          <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
            <span class="s1">&#39;length&#39;</span> <span class="o">=&gt;</span> <span class="mi">255</span><span class="p">,</span>
            <span class="s1">&#39;null&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span>
          <span class="p">),</span>
          <span class="s1">&#39;body&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span>
          <span class="s1">&#39;published&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
            <span class="s1">&#39;default&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
            <span class="s1">&#39;null&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span>
          <span class="p">),</span>
          <span class="s1">&#39;created&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;datetime&#39;</span><span class="p">,</span>
          <span class="s1">&#39;updated&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;datetime&#39;</span>
      <span class="p">);</span>
      <span class="k">public</span> <span class="nv">$records</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
          <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;First Article&#39;</span><span class="p">,</span>
            <span class="s1">&#39;body&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;First Article Body&#39;</span><span class="p">,</span>
            <span class="s1">&#39;published&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;created&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;2007-03-18 10:39:23&#39;</span><span class="p">,</span>
            <span class="s1">&#39;updated&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;2007-03-18 10:41:31&#39;</span>
          <span class="p">),</span>
          <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Second Article&#39;</span><span class="p">,</span>
            <span class="s1">&#39;body&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Second Article Body&#39;</span><span class="p">,</span>
            <span class="s1">&#39;published&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;created&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;2007-03-18 10:41:23&#39;</span><span class="p">,</span>
            <span class="s1">&#39;updated&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;2007-03-18 10:43:31&#39;</span>
          <span class="p">),</span>
          <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Third Article&#39;</span><span class="p">,</span>
            <span class="s1">&#39;body&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Third Article Body&#39;</span><span class="p">,</span>
            <span class="s1">&#39;published&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;created&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;2007-03-18 10:43:23&#39;</span><span class="p">,</span>
            <span class="s1">&#39;updated&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;2007-03-18 10:45:31&#39;</span>
          <span class="p">)</span>
      <span class="p">);</span>
 <span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">$useDbConfig</span></code> property defines the datasource of which the fixture will
use. If your application uses multiple datasources, you should make the
fixtures match the model&#8217;s datasources but prefixed with <code class="docutils literal"><span class="pre">test_</span></code>.
For example if your model uses the <code class="docutils literal"><span class="pre">mydb</span></code> datasource, your fixture should use
the <code class="docutils literal"><span class="pre">test_mydb</span></code> datasource. If the <code class="docutils literal"><span class="pre">test_mydb</span></code> connection doesn&#8217;t exist,
your models will use the default <code class="docutils literal"><span class="pre">test</span></code> datasource. Fixture datasources must
be prefixed with <code class="docutils literal"><span class="pre">test</span></code> to reduce the possibility of accidentally truncating
all your application&#8217;s data when running tests.</p>
<p>We use <code class="docutils literal"><span class="pre">$fields</span></code> to specify which fields will be part of this table, and how
they are defined. The format used to define these fields is the same used with
<code class="xref php php-class docutils literal"><span class="pre">CakeSchema</span></code>. The keys available for table definition are:</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">type</span></code></dt>
<dd><dl class="first last docutils">
<dt>CakePHP internal data type. Currently supported:</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal"><span class="pre">string</span></code>: maps to <code class="docutils literal"><span class="pre">VARCHAR</span></code></li>
<li><code class="docutils literal"><span class="pre">text</span></code>: maps to <code class="docutils literal"><span class="pre">TEXT</span></code></li>
<li><code class="docutils literal"><span class="pre">biginteger</span></code>: maps to <code class="docutils literal"><span class="pre">BIGINT</span></code></li>
<li><code class="docutils literal"><span class="pre">integer</span></code>: maps to <code class="docutils literal"><span class="pre">INT</span></code></li>
<li><code class="docutils literal"><span class="pre">float</span></code>: maps to <code class="docutils literal"><span class="pre">FLOAT</span></code></li>
<li><code class="docutils literal"><span class="pre">decimal</span></code>: maps to <code class="docutils literal"><span class="pre">DECIMAL</span></code></li>
<li><code class="docutils literal"><span class="pre">datetime</span></code>: maps to <code class="docutils literal"><span class="pre">DATETIME</span></code></li>
<li><code class="docutils literal"><span class="pre">timestamp</span></code>: maps to <code class="docutils literal"><span class="pre">TIMESTAMP</span></code></li>
<li><code class="docutils literal"><span class="pre">time</span></code>: maps to <code class="docutils literal"><span class="pre">TIME</span></code></li>
<li><code class="docutils literal"><span class="pre">date</span></code>: maps to <code class="docutils literal"><span class="pre">DATE</span></code></li>
<li><code class="docutils literal"><span class="pre">binary</span></code>: maps to <code class="docutils literal"><span class="pre">BLOB</span></code></li>
<li><code class="docutils literal"><span class="pre">boolean</span></code>: maps to <code class="docutils literal"><span class="pre">TINYINT</span></code></li>
</ul>
</dd>
</dl>
</dd>
<dt><code class="docutils literal"><span class="pre">key</span></code></dt>
<dd>Set to <code class="docutils literal"><span class="pre">primary</span></code> to make the field AUTO_INCREMENT, and a PRIMARY KEY
for the table.</dd>
<dt><code class="docutils literal"><span class="pre">length</span></code></dt>
<dd>Set to the specific length the field should take.</dd>
<dt><code class="docutils literal"><span class="pre">null</span></code></dt>
<dd>Set to either <code class="docutils literal"><span class="pre">true</span></code> (to allow NULLs) or <code class="docutils literal"><span class="pre">false</span></code> (to disallow NULLs).</dd>
<dt><code class="docutils literal"><span class="pre">default</span></code></dt>
<dd>Default value the field takes.</dd>
</dl>
<p>We can define a set of records that will be populated after the fixture table is
created. The format is fairly straight forward, <code class="docutils literal"><span class="pre">$records</span></code> is an array of
records. Each item in <code class="docutils literal"><span class="pre">$records</span></code> should be a single row. Inside each row,
should be an associative array of the columns and values for the row. Just keep
in mind that each record in the $records array must have a key for <strong>every</strong>
field specified in the <code class="docutils literal"><span class="pre">$fields</span></code> array. If a field for a particular record
needs to have a <code class="docutils literal"><span class="pre">null</span></code> value, just specify the value of that key as <code class="docutils literal"><span class="pre">null</span></code>.</p>
</div>
<div class="section" id="dynamic-data-and-fixtures">
<h3>Dynamic data and fixtures<a class="headerlink" href="#dynamic-data-and-fixtures" title="Permalink to this headline">¶</a></h3>
<p>Since records for a fixture are declared as a class property, you cannot easily
use functions or other dynamic data to define fixtures. To solve this problem,
you can define <code class="docutils literal"><span class="pre">$records</span></code> in the init() function of your fixture. For example
if you wanted all the created and updated timestamps to reflect today&#8217;s date you
could do the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ArticleFixture</span> <span class="k">extends</span> <span class="nx">CakeTestFixture</span> <span class="p">{</span>

    <span class="k">public</span> <span class="nv">$fields</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;primary&#39;</span><span class="p">),</span>
        <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span> <span class="o">=&gt;</span> <span class="mi">255</span><span class="p">,</span> <span class="s1">&#39;null&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">),</span>
        <span class="s1">&#39;body&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span>
        <span class="s1">&#39;published&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;null&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">),</span>
        <span class="s1">&#39;created&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;datetime&#39;</span><span class="p">,</span>
        <span class="s1">&#39;updated&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;datetime&#39;</span>
    <span class="p">);</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">records</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
            <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;First Article&#39;</span><span class="p">,</span>
                <span class="s1">&#39;body&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;First Article Body&#39;</span><span class="p">,</span>
                <span class="s1">&#39;published&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
                <span class="s1">&#39;created&#39;</span> <span class="o">=&gt;</span> <span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">),</span>
                <span class="s1">&#39;updated&#39;</span> <span class="o">=&gt;</span> <span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span><span class="p">),</span>
            <span class="p">),</span>
        <span class="p">);</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">init</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>When overriding <code class="docutils literal"><span class="pre">init()</span></code> just remember to always call <code class="docutils literal"><span class="pre">parent::init()</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please note that fixtures in 2.x do not handle foreign key constraints.</p>
</div>
</div>
<div class="section" id="importing-table-information-and-records">
<h3>Importing table information and records<a class="headerlink" href="#importing-table-information-and-records" title="Permalink to this headline">¶</a></h3>
<p>Your application may have already working models with real data associated to
them, and you might decide to test your application with that data. It would be
then a duplicate effort to have to define the table definition and/or records on
your fixtures. Fortunately, there&#8217;s a way for you to define that table
definition and/or records for a particular fixture come from an existing model
or an existing table.</p>
<p>Let&#8217;s start with an example. Assuming you have a model named Article available
in your application (that maps to a table named articles), change the example
fixture given in the previous section (<code class="docutils literal"><span class="pre">app/Test/Fixture/ArticleFixture.php</span></code>)
to:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ArticleFixture</span> <span class="k">extends</span> <span class="nx">CakeTestFixture</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$import</span> <span class="o">=</span> <span class="s1">&#39;Article&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This statement tells the test suite to import your table definition from the
table linked to the model called Article. You can use any model available in
your application. The statement will only import the Article schema, and  does
not import records. To import records you can do the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ArticleFixture</span> <span class="k">extends</span> <span class="nx">CakeTestFixture</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$import</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;model&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Article&#39;</span><span class="p">,</span> <span class="s1">&#39;records&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If on the other hand you have a table created but no model available for it, you
can specify that your import will take place by reading that table information
instead. For example:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ArticleFixture</span> <span class="k">extends</span> <span class="nx">CakeTestFixture</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$import</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;table&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;articles&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Will import table definition from a table called &#8216;articles&#8217; using your CakePHP
database connection named &#8216;default&#8217;. If you want to use a different connection
use:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ArticleFixture</span> <span class="k">extends</span> <span class="nx">CakeTestFixture</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$import</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;table&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;articles&#39;</span><span class="p">,</span> <span class="s1">&#39;connection&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;other&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Since it uses your CakePHP database connection, if there&#8217;s any table prefix
declared it will be automatically used when fetching table information. The two
snippets above do not import records from the table. To force the fixture to
also import its records, change the import to:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ArticleFixture</span> <span class="k">extends</span> <span class="nx">CakeTestFixture</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$import</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;table&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;articles&#39;</span><span class="p">,</span> <span class="s1">&#39;records&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can naturally import your table definition from an existing model/table, but
have your records defined directly on the fixture as it was shown on previous
section. For example:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ArticleFixture</span> <span class="k">extends</span> <span class="nx">CakeTestFixture</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$import</span> <span class="o">=</span> <span class="s1">&#39;Article&#39;</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$records</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="k">array</span><span class="p">(</span>
          <span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
          <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;First Article&#39;</span><span class="p">,</span>
          <span class="s1">&#39;body&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;First Article Body&#39;</span><span class="p">,</span>
          <span class="s1">&#39;published&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
          <span class="s1">&#39;created&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;2007-03-18 10:39:23&#39;</span><span class="p">,</span>
          <span class="s1">&#39;updated&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;2007-03-18 10:41:31&#39;</span>
        <span class="p">),</span>
        <span class="k">array</span><span class="p">(</span>
          <span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span>
          <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Second Article&#39;</span><span class="p">,</span>
          <span class="s1">&#39;body&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Second Article Body&#39;</span><span class="p">,</span>
          <span class="s1">&#39;published&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
          <span class="s1">&#39;created&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;2007-03-18 10:41:23&#39;</span><span class="p">,</span>
          <span class="s1">&#39;updated&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;2007-03-18 10:43:31&#39;</span>
        <span class="p">),</span>
        <span class="k">array</span><span class="p">(</span>
          <span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="mi">3</span><span class="p">,</span>
          <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Third Article&#39;</span><span class="p">,</span>
          <span class="s1">&#39;body&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Third Article Body&#39;</span><span class="p">,</span>
          <span class="s1">&#39;published&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
          <span class="s1">&#39;created&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;2007-03-18 10:43:23&#39;</span><span class="p">,</span>
          <span class="s1">&#39;updated&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;2007-03-18 10:45:31&#39;</span>
        <span class="p">)</span>
    <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="loading-fixtures-in-your-test-cases">
<h3>Loading fixtures in your test cases<a class="headerlink" href="#loading-fixtures-in-your-test-cases" title="Permalink to this headline">¶</a></h3>
<p>After you&#8217;ve created your fixtures, you&#8217;ll want to use them in your test cases.
In each test case you should load the fixtures you will need. You should load a
fixture for every model that will have a query run against it. To load fixtures
you define the <code class="docutils literal"><span class="pre">$fixtures</span></code> property in your model:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ArticleTest</span> <span class="k">extends</span> <span class="nx">CakeTestCase</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$fixtures</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;app.article&#39;</span><span class="p">,</span> <span class="s1">&#39;app.comment&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above will load the Article and Comment fixtures from the application&#8217;s
Fixture directory. You can also load fixtures from CakePHP core, or plugins:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ArticleTest</span> <span class="k">extends</span> <span class="nx">CakeTestCase</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$fixtures</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;plugin.debug_kit.article&#39;</span><span class="p">,</span> <span class="s1">&#39;core.comment&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Using the <code class="docutils literal"><span class="pre">core</span></code> prefix will load fixtures from CakePHP, and using a plugin
name as the prefix, will load the fixture from the named plugin.</p>
<p>You can control when your fixtures are loaded by setting
<code class="xref php php-attr docutils literal"><span class="pre">CakeTestCase::$autoFixtures</span></code> to <code class="docutils literal"><span class="pre">false</span></code> and later load them using
<code class="xref php php-meth docutils literal"><span class="pre">CakeTestCase::loadFixtures()</span></code>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ArticleTest</span> <span class="k">extends</span> <span class="nx">CakeTestCase</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$fixtures</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;app.article&#39;</span><span class="p">,</span> <span class="s1">&#39;app.comment&#39;</span><span class="p">);</span>
    <span class="k">public</span> <span class="nv">$autoFixtures</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">testMyFunction</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">loadFixtures</span><span class="p">(</span><span class="s1">&#39;Article&#39;</span><span class="p">,</span> <span class="s1">&#39;Comment&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As of 2.5.0, you can load fixtures in subdirectories. Using multiple directories
can make it easier to organize your fixtures if you have a larger application.
To load fixtures in subdirectories, simply include the subdirectory name in the
fixture name:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ArticleTest</span> <span class="k">extends</span> <span class="nx">CakeTestCase</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$fixtures</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;app.blog/article&#39;</span><span class="p">,</span> <span class="s1">&#39;app.blog/comment&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the above example, both fixtures would be loaded from
<code class="docutils literal"><span class="pre">App/Test/Fixture/blog/</span></code>.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 2.5: </span>As of 2.5.0 you can load fixtures in subdirectories.</p>
</div>
</div>
</div>
<div class="section" id="testing-models">
<h2>Testing Models<a class="headerlink" href="#testing-models" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s say we already have our Article model defined on
<code class="docutils literal"><span class="pre">app/Model/Article.php</span></code>, which looks like this:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Article</span> <span class="k">extends</span> <span class="nx">AppModel</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">published</span><span class="p">(</span><span class="nv">$fields</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$params</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;conditions&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">name</span> <span class="o">.</span> <span class="s1">&#39;.published&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span>
            <span class="p">),</span>
            <span class="s1">&#39;fields&#39;</span> <span class="o">=&gt;</span> <span class="nv">$fields</span>
        <span class="p">);</span>

        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="nv">$params</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We now want to set up a test that will use this model definition, but through
fixtures, to test some functionality in the model. CakePHP test suite loads a
very minimum set of files (to keep tests isolated), so we have to start by
loading our model - in this case the Article model which we already defined.</p>
<p>Let&#8217;s now create a file named <code class="docutils literal"><span class="pre">ArticleTest.php</span></code> in your
<code class="docutils literal"><span class="pre">app/Test/Case/Model</span></code> directory, with the following contents:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;Article&#39;</span><span class="p">,</span> <span class="s1">&#39;Model&#39;</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">ArticleTest</span> <span class="k">extends</span> <span class="nx">CakeTestCase</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$fixtures</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;app.article&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In our test cases&#8217; variable <code class="docutils literal"><span class="pre">$fixtures</span></code> we define the set of fixtures that
we&#8217;ll use. You should remember to include all the fixtures that will have
queries run against them.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can override the test model database by specifying the <code class="docutils literal"><span class="pre">$useDbConfig</span></code>
property. Ensure that the relevant fixture uses the same value so that the
table is created in the correct database.</p>
</div>
<div class="section" id="creating-a-test-method">
<h3>Creating a test method<a class="headerlink" href="#creating-a-test-method" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s now add a method to test the function published() in the
Article model. Edit the file
<code class="docutils literal"><span class="pre">app/Test/Case/Model/ArticleTest.php</span></code> so it now looks like
this:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;Article&#39;</span><span class="p">,</span> <span class="s1">&#39;Model&#39;</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">ArticleTest</span> <span class="k">extends</span> <span class="nx">CakeTestCase</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$fixtures</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;app.article&#39;</span><span class="p">);</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">setUp</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setUp</span><span class="p">();</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Article</span> <span class="o">=</span> <span class="nx">ClassRegistry</span><span class="o">::</span><span class="na">init</span><span class="p">(</span><span class="s1">&#39;Article&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">testPublished</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Article</span><span class="o">-&gt;</span><span class="na">published</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">));</span>
        <span class="nv">$expected</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
            <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Article&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;First Article&#39;</span><span class="p">)),</span>
            <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Article&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Second Article&#39;</span><span class="p">)),</span>
            <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Article&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Third Article&#39;</span><span class="p">))</span>
        <span class="p">);</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertEquals</span><span class="p">(</span><span class="nv">$expected</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can see we have added a method called <code class="docutils literal"><span class="pre">testPublished()</span></code>. We start by
creating an instance of our <code class="docutils literal"><span class="pre">Article</span></code> model, and then run our <code class="docutils literal"><span class="pre">published()</span></code>
method. In <code class="docutils literal"><span class="pre">$expected</span></code> we set what we expect should be the proper result (that
we know since we have defined which records are initially populated to the
article table.) We test that the result equals our expectation by using the
<code class="docutils literal"><span class="pre">assertEquals</span></code> method. See the <a class="reference internal" href="#running-tests"><span class="std std-ref">Running Tests</span></a> section for more
information on how to run your test case.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When setting up your Model for testing be sure to use
<code class="docutils literal"><span class="pre">ClassRegistry::init('YourModelName');</span></code> as it knows to use your test
database connection.</p>
</div>
</div>
<div class="section" id="mocking-model-methods">
<h3>Mocking model methods<a class="headerlink" href="#mocking-model-methods" title="Permalink to this headline">¶</a></h3>
<p>There will be times you&#8217;ll want to mock methods on models when testing them. You should
use <code class="docutils literal"><span class="pre">getMockForModel</span></code> to create testing mocks of models. It avoids issues
with reflected properties that normal mocks have:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">testSendingEmails</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$model</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getMockForModel</span><span class="p">(</span><span class="s1">&#39;EmailVerification&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;send&#39;</span><span class="p">));</span>
    <span class="nv">$model</span><span class="o">-&gt;</span><span class="na">expects</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">once</span><span class="p">())</span>
        <span class="o">-&gt;</span><span class="na">method</span><span class="p">(</span><span class="s1">&#39;send&#39;</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">will</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">returnValue</span><span class="p">(</span><span class="k">true</span><span class="p">));</span>

    <span class="nv">$model</span><span class="o">-&gt;</span><span class="na">verifyEmail</span><span class="p">(</span><span class="s1">&#39;test@example.com&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3: </span>CakeTestCase::getMockForModel() was added in 2.3.</p>
</div>
</div>
</div>
<div class="section" id="testing-controllers">
<h2>Testing Controllers<a class="headerlink" href="#testing-controllers" title="Permalink to this headline">¶</a></h2>
<p>While you can test controller classes in a similar fashion to Helpers, Models,
and Components, CakePHP offers a specialized <code class="docutils literal"><span class="pre">ControllerTestCase</span></code> class.
Using this class as the base class for your controller test cases allows you to
use <code class="docutils literal"><span class="pre">testAction()</span></code> for simpler test cases. <code class="docutils literal"><span class="pre">ControllerTestCase</span></code> allows you
to easily mock out components and models, as well as potentially difficult to
test methods like <a class="reference internal" href="../controllers.html#Controller::redirect" title="Controller::redirect"><code class="xref php php-meth docutils literal"><span class="pre">redirect()</span></code></a>.</p>
<p>Say you have a typical Articles controller, and its corresponding
model. The controller code looks like:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;AppController&#39;</span><span class="p">,</span> <span class="s1">&#39;Controller&#39;</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">ArticlesController</span> <span class="k">extends</span> <span class="nx">AppController</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$helpers</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Form&#39;</span><span class="p">,</span> <span class="s1">&#39;Html&#39;</span><span class="p">);</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">(</span><span class="nv">$short</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Article</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$short</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Article</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">));</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Article</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">params</span><span class="p">[</span><span class="s1">&#39;requested&#39;</span><span class="p">]))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;Articles&#39;</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;articles&#39;</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Create a file named <code class="docutils literal"><span class="pre">ArticlesControllerTest.php</span></code> in your
<code class="docutils literal"><span class="pre">app/Test/Case/Controller</span></code> directory and put the following inside:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ArticlesControllerTest</span> <span class="k">extends</span> <span class="nx">ControllerTestCase</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$fixtures</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;app.article&#39;</span><span class="p">);</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">testIndex</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">testAction</span><span class="p">(</span><span class="s1">&#39;/articles/index&#39;</span><span class="p">);</span>
        <span class="nx">debug</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">testIndexShort</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">testAction</span><span class="p">(</span><span class="s1">&#39;/articles/index/short&#39;</span><span class="p">);</span>
        <span class="nx">debug</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">testIndexShortGetRenderedHtml</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">testAction</span><span class="p">(</span>
           <span class="s1">&#39;/articles/index/short&#39;</span><span class="p">,</span>
            <span class="k">array</span><span class="p">(</span><span class="s1">&#39;return&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;contents&#39;</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="nx">debug</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">testIndexShortGetViewVars</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">testAction</span><span class="p">(</span>
            <span class="s1">&#39;/articles/index/short&#39;</span><span class="p">,</span>
            <span class="k">array</span><span class="p">(</span><span class="s1">&#39;return&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;vars&#39;</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="nx">debug</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">testIndexPostData</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;Article&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;user_id&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;published&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;slug&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;new-article&#39;</span><span class="p">,</span>
                <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;New Article&#39;</span><span class="p">,</span>
                <span class="s1">&#39;body&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;New Body&#39;</span>
            <span class="p">)</span>
        <span class="p">);</span>
        <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">testAction</span><span class="p">(</span>
            <span class="s1">&#39;/articles/index&#39;</span><span class="p">,</span>
            <span class="k">array</span><span class="p">(</span><span class="s1">&#39;data&#39;</span> <span class="o">=&gt;</span> <span class="nv">$data</span><span class="p">,</span> <span class="s1">&#39;method&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;post&#39;</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="nx">debug</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This example shows a few of the ways you can use testAction to test your
controllers. The first parameter of <code class="docutils literal"><span class="pre">testAction</span></code> should always be the URL you
want to test. CakePHP will create a request and dispatch the controller and
action.</p>
<p>When testing actions that contain <code class="docutils literal"><span class="pre">redirect()</span></code> and other code following the
redirect it is generally a good idea to return when redirecting. The reason for
this, is that <code class="docutils literal"><span class="pre">redirect()</span></code> is mocked in testing, and does not exit like
normal. And instead of your code exiting, it will continue to run code following
the redirect. For example:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;AppController&#39;</span><span class="p">,</span> <span class="s1">&#39;Controller&#39;</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">ArticlesController</span> <span class="k">extends</span> <span class="nx">AppController</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">add</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Article</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">))</span> <span class="p">{</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;index&#39;</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="c1">// more code</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>When testing the above code, you will still run <code class="docutils literal"><span class="pre">//</span> <span class="pre">more</span> <span class="pre">code</span></code> even when the
redirect is reached. Instead, you should write the code like:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;AppController&#39;</span><span class="p">,</span> <span class="s1">&#39;Controller&#39;</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">ArticlesController</span> <span class="k">extends</span> <span class="nx">AppController</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">add</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Article</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;index&#39;</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="c1">// more code</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this case <code class="docutils literal"><span class="pre">//</span> <span class="pre">more</span> <span class="pre">code</span></code> will not be executed as the method will return
once the redirect is reached.</p>
<div class="section" id="simulating-get-requests">
<h3>Simulating GET requests<a class="headerlink" href="#simulating-get-requests" title="Permalink to this headline">¶</a></h3>
<p>As seen in the <code class="docutils literal"><span class="pre">testIndexPostData()</span></code> example above, you can use
<code class="docutils literal"><span class="pre">testAction()</span></code> to test POST actions as well as GET actions. By supplying the
<code class="docutils literal"><span class="pre">data</span></code> key, the request made to the controller will be POST. By default all
requests will be POST requests. You can simulate a GET request by setting the
method key:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">testAdding</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;Post&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;New post&#39;</span><span class="p">,</span>
            <span class="s1">&#39;body&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Secret sauce&#39;</span>
        <span class="p">)</span>
    <span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">testAction</span><span class="p">(</span><span class="s1">&#39;/posts/add&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;data&#39;</span> <span class="o">=&gt;</span> <span class="nv">$data</span><span class="p">,</span> <span class="s1">&#39;method&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;get&#39;</span><span class="p">));</span>
    <span class="c1">// some assertions.</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The data key will be used as query string parameters when simulating a GET
request.</p>
</div>
<div class="section" id="choosing-the-return-type">
<h3>Choosing the return type<a class="headerlink" href="#choosing-the-return-type" title="Permalink to this headline">¶</a></h3>
<p>You can choose from a number of ways to inspect the success of your controller
action. Each offers a different way to ensure your code is doing what you
expect:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">vars</span></code> Get the set view variables.</li>
<li><code class="docutils literal"><span class="pre">view</span></code> Get the rendered view, without a layout.</li>
<li><code class="docutils literal"><span class="pre">contents</span></code> Get the rendered view including the layout.</li>
<li><code class="docutils literal"><span class="pre">result</span></code> Get the return value of the controller action. Useful
for testing requestAction methods.</li>
</ul>
<p>The default value is <code class="docutils literal"><span class="pre">result</span></code>. As long as your return type is not <code class="docutils literal"><span class="pre">result</span></code>
you can also access the various other return types as properties in the test
case:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">testIndex</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">testAction</span><span class="p">(</span><span class="s1">&#39;/posts/index&#39;</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertInternalType</span><span class="p">(</span><span class="s1">&#39;array&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">vars</span><span class="p">[</span><span class="s1">&#39;posts&#39;</span><span class="p">]);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="using-mocks-with-testaction">
<h3>Using mocks with testAction<a class="headerlink" href="#using-mocks-with-testaction" title="Permalink to this headline">¶</a></h3>
<p>There will be times when you want to replace components or models with either
partially mocked objects or completely mocked objects. You can do this by using
<code class="xref php php-meth docutils literal"><span class="pre">ControllerTestCase::generate()</span></code>. <code class="docutils literal"><span class="pre">generate()</span></code> takes the hard work
out of generating mocks on your controller. If you decide to generate a
controller to be used in testing, you can generate mocked versions of its models
and components along with it:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$Posts</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">generate</span><span class="p">(</span><span class="s1">&#39;Posts&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;methods&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;isAuthorized&#39;</span>
    <span class="p">),</span>
    <span class="s1">&#39;models&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;Post&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;save&#39;</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="s1">&#39;components&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;RequestHandler&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;isPut&#39;</span><span class="p">),</span>
        <span class="s1">&#39;Email&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;send&#39;</span><span class="p">),</span>
        <span class="s1">&#39;Session&#39;</span>
    <span class="p">)</span>
<span class="p">));</span>
</pre></div>
</div>
<p>The above would create a mocked <code class="docutils literal"><span class="pre">PostsController</span></code>, stubbing out the <code class="docutils literal"><span class="pre">isAuthorized</span></code>
method. The attached Post model will have <code class="docutils literal"><span class="pre">save()</span></code> stubbed, and the attached
components would have their respective methods stubbed. You can choose to stub
an entire class by not passing methods to it, like Session in the example above.</p>
<p>Generated controllers are automatically used as the testing controller to test.
To enable automatic generation, set the <code class="docutils literal"><span class="pre">autoMock</span></code> variable on the test case to
true. If <code class="docutils literal"><span class="pre">autoMock</span></code> is false, your original controller will be used in the test.</p>
<p>The response object in the generated controller is always replaced with a mock
that does not send headers. After using <code class="docutils literal"><span class="pre">generate()</span></code> or <code class="docutils literal"><span class="pre">testAction()</span></code> you
can access the controller object at <code class="docutils literal"><span class="pre">$this-&gt;controller</span></code>.</p>
</div>
<div class="section" id="a-more-complex-example">
<h3>A more complex example<a class="headerlink" href="#a-more-complex-example" title="Permalink to this headline">¶</a></h3>
<p>In its simplest form, <code class="docutils literal"><span class="pre">testAction()</span></code> will run <code class="docutils literal"><span class="pre">PostsController::index()</span></code> on
your testing controller (or an automatically generated one), including all of the
mocked models and components. The results of the test are stored in the <code class="docutils literal"><span class="pre">vars</span></code>,
<code class="docutils literal"><span class="pre">contents</span></code>, <code class="docutils literal"><span class="pre">view</span></code>, and <code class="docutils literal"><span class="pre">return</span></code> properties. Also available is a headers
property which gives you access to the <code class="docutils literal"><span class="pre">headers</span></code> that would have been sent,
allowing you to check for redirects:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">testAdd</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$Posts</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">generate</span><span class="p">(</span><span class="s1">&#39;Posts&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;components&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;Session&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Email&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;send&#39;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">));</span>
    <span class="nv">$Posts</span><span class="o">-&gt;</span><span class="na">Session</span>
        <span class="o">-&gt;</span><span class="na">expects</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">once</span><span class="p">())</span>
        <span class="o">-&gt;</span><span class="na">method</span><span class="p">(</span><span class="s1">&#39;setFlash&#39;</span><span class="p">);</span>
    <span class="nv">$Posts</span><span class="o">-&gt;</span><span class="na">Email</span>
        <span class="o">-&gt;</span><span class="na">expects</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">once</span><span class="p">())</span>
        <span class="o">-&gt;</span><span class="na">method</span><span class="p">(</span><span class="s1">&#39;send&#39;</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">will</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">returnValue</span><span class="p">(</span><span class="k">true</span><span class="p">));</span>

    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">testAction</span><span class="p">(</span><span class="s1">&#39;/posts/add&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;data&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;Post&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;New Post&#39;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">));</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertContains</span><span class="p">(</span><span class="s1">&#39;/posts&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">headers</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">]);</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">testAddGet</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">testAction</span><span class="p">(</span><span class="s1">&#39;/posts/add&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;method&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;GET&#39;</span><span class="p">,</span>
        <span class="s1">&#39;return&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;contents&#39;</span>
    <span class="p">));</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertRegExp</span><span class="p">(</span><span class="s1">&#39;/&lt;html/&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">contents</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertRegExp</span><span class="p">(</span><span class="s1">&#39;/&lt;form/&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">view</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This example shows a slightly more complex use of the <code class="docutils literal"><span class="pre">testAction()</span></code> and
<code class="docutils literal"><span class="pre">generate()</span></code> methods. First, we generate a testing controller and mock the
<a class="reference internal" href="../core-libraries/components/sessions.html#SessionComponent" title="SessionComponent"><code class="xref php php-class docutils literal"><span class="pre">SessionComponent</span></code></a>. Now that the SessionComponent is mocked, we have
the ability to run testing methods on it. Assuming <code class="docutils literal"><span class="pre">PostsController::add()</span></code>
redirects us to index, sends an email and sets a flash message, the test will
pass. A second test was added to do basic sanity testing when fetching the add
form. We check to see if the layout was loaded by checking the entire rendered
contents, and checks the view for a form tag. As you can see, your freedom to
test controllers and easily mock its classes is greatly expanded with these
changes.</p>
<p>When doing controller tests using mocks that use static methods you&#8217;ll have to
use a different method to register your mock expectations. For example if you
wanted to mock out <a class="reference internal" href="../core-libraries/components/authentication.html#AuthComponent::user" title="AuthComponent::user"><code class="xref php php-meth docutils literal"><span class="pre">AuthComponent::user()</span></code></a> you&#8217;d have to do the
following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">function</span> <span class="nf">testAdd</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$Posts</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">generate</span><span class="p">(</span><span class="s1">&#39;Posts&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;components&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;Session&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Auth&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">));</span>
    <span class="nv">$Posts</span><span class="o">-&gt;</span><span class="na">Auth</span><span class="o">-&gt;</span><span class="na">staticExpects</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">any</span><span class="p">())</span>
        <span class="o">-&gt;</span><span class="na">method</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">with</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">will</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">returnValue</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p>By using <code class="docutils literal"><span class="pre">staticExpects</span></code> you will be able to mock and manipulate static
methods on components and models.</p>
</div>
<div class="section" id="testing-a-json-responding-controller">
<h3>Testing a JSON Responding Controller<a class="headerlink" href="#testing-a-json-responding-controller" title="Permalink to this headline">¶</a></h3>
<p>JSON is a very friendly and common format to use when building a web service.
Testing the endpoints of your web service is very simple with CakePHP. Let us
begin with a simple example controller that responds in JSON:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MarkersController</span> <span class="k">extends</span> <span class="nx">AppController</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$autoRender</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$data</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Marker</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;first&#39;</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">body</span><span class="p">(</span><span class="nb">json_encode</span><span class="p">(</span><span class="nv">$data</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now we create the file <code class="docutils literal"><span class="pre">app/Test/Case/Controller/MarkersControllerTest.php</span></code>
and make sure our web service is returning the proper response:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MarkersControllerTest</span> <span class="k">extends</span> <span class="nx">ControllerTestCase</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">testIndex</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">testAction</span><span class="p">(</span><span class="s1">&#39;/markers/index.json&#39;</span><span class="p">);</span>
        <span class="nv">$result</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
        <span class="nv">$expected</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;Marker&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;lng&#39;</span> <span class="o">=&gt;</span> <span class="mi">66</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span> <span class="o">=&gt;</span> <span class="mi">45</span><span class="p">),</span>
        <span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertEquals</span><span class="p">(</span><span class="nv">$expected</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="testing-views">
<h2>Testing Views<a class="headerlink" href="#testing-views" title="Permalink to this headline">¶</a></h2>
<p>Generally most applications will not directly test their HTML code. Doing so is
often results in fragile, difficult to maintain test suites that are prone to
breaking. When writing functional tests using <code class="xref php php-class docutils literal"><span class="pre">ControllerTestCase</span></code>
you can inspect the rendered view content by setting the <code class="docutils literal"><span class="pre">return</span></code> option to
&#8216;view&#8217;. While it is possible to test view content using ControllerTestCase,
more robust and maintainable integration/view testing can be accomplished using
tools like <a class="reference external" href="http://seleniumhq.org">Selenium webdriver</a>.</p>
</div>
<div class="section" id="testing-components">
<h2>Testing Components<a class="headerlink" href="#testing-components" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s pretend we have a component called PagematronComponent in our application.
This component helps us set the pagination limit value across all the
controllers that use it. Here is our example component located in
<code class="docutils literal"><span class="pre">app/Controller/Component/PagematronComponent.php</span></code>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PagematronComponent</span> <span class="k">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$Controller</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">startup</span><span class="p">(</span><span class="nx">Controller</span> <span class="nv">$controller</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">startup</span><span class="p">(</span><span class="nv">$controller</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Controller</span> <span class="o">=</span> <span class="nv">$controller</span><span class="p">;</span>
        <span class="c1">// Make sure the controller is using pagination</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Controller</span><span class="o">-&gt;</span><span class="na">paginate</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Controller</span><span class="o">-&gt;</span><span class="na">paginate</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">adjust</span><span class="p">(</span><span class="nv">$length</span> <span class="o">=</span> <span class="s1">&#39;short&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="p">(</span><span class="nv">$length</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">case</span> <span class="s1">&#39;long&#39;</span><span class="o">:</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Controller</span><span class="o">-&gt;</span><span class="na">paginate</span><span class="p">[</span><span class="s1">&#39;limit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s1">&#39;medium&#39;</span><span class="o">:</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Controller</span><span class="o">-&gt;</span><span class="na">paginate</span><span class="p">[</span><span class="s1">&#39;limit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
            <span class="k">default</span><span class="o">:</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Controller</span><span class="o">-&gt;</span><span class="na">paginate</span><span class="p">[</span><span class="s1">&#39;limit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now we can write tests to ensure our paginate <code class="docutils literal"><span class="pre">limit</span></code> parameter is being
set correctly by the <code class="docutils literal"><span class="pre">adjust</span></code> method in our component. We create the file
<code class="docutils literal"><span class="pre">app/Test/Case/Controller/Component/PagematronComponentTest.php</span></code>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;Controller&#39;</span><span class="p">,</span> <span class="s1">&#39;Controller&#39;</span><span class="p">);</span>
<span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;CakeRequest&#39;</span><span class="p">,</span> <span class="s1">&#39;Network&#39;</span><span class="p">);</span>
<span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;CakeResponse&#39;</span><span class="p">,</span> <span class="s1">&#39;Network&#39;</span><span class="p">);</span>
<span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;ComponentCollection&#39;</span><span class="p">,</span> <span class="s1">&#39;Controller&#39;</span><span class="p">);</span>
<span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;PagematronComponent&#39;</span><span class="p">,</span> <span class="s1">&#39;Controller/Component&#39;</span><span class="p">);</span>

<span class="c1">// A fake controller to test against</span>
<span class="k">class</span> <span class="nc">PagematronControllerTest</span> <span class="k">extends</span> <span class="nx">Controller</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$paginate</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">PagematronComponentTest</span> <span class="k">extends</span> <span class="nx">CakeTestCase</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$PagematronComponent</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$Controller</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">setUp</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setUp</span><span class="p">();</span>
        <span class="c1">// Setup our component and fake test controller</span>
        <span class="nv">$Collection</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ComponentCollection</span><span class="p">();</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">PagematronComponent</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PagematronComponent</span><span class="p">(</span><span class="nv">$Collection</span><span class="p">);</span>
        <span class="nv">$CakeRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CakeRequest</span><span class="p">();</span>
        <span class="nv">$CakeResponse</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CakeResponse</span><span class="p">();</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Controller</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PagematronControllerTest</span><span class="p">(</span><span class="nv">$CakeRequest</span><span class="p">,</span> <span class="nv">$CakeResponse</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">PagematronComponent</span><span class="o">-&gt;</span><span class="na">startup</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Controller</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">testAdjust</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// Test our adjust method with different parameter settings</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">PagematronComponent</span><span class="o">-&gt;</span><span class="na">adjust</span><span class="p">();</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertEquals</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Controller</span><span class="o">-&gt;</span><span class="na">paginate</span><span class="p">[</span><span class="s1">&#39;limit&#39;</span><span class="p">]);</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">PagematronComponent</span><span class="o">-&gt;</span><span class="na">adjust</span><span class="p">(</span><span class="s1">&#39;medium&#39;</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertEquals</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Controller</span><span class="o">-&gt;</span><span class="na">paginate</span><span class="p">[</span><span class="s1">&#39;limit&#39;</span><span class="p">]);</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">PagematronComponent</span><span class="o">-&gt;</span><span class="na">adjust</span><span class="p">(</span><span class="s1">&#39;long&#39;</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertEquals</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Controller</span><span class="o">-&gt;</span><span class="na">paginate</span><span class="p">[</span><span class="s1">&#39;limit&#39;</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">tearDown</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">tearDown</span><span class="p">();</span>
        <span class="c1">// Clean up after we&#39;re done</span>
        <span class="nb">unset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">PagematronComponent</span><span class="p">);</span>
        <span class="nb">unset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Controller</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="testing-helpers">
<h2>Testing Helpers<a class="headerlink" href="#testing-helpers" title="Permalink to this headline">¶</a></h2>
<p>Since a decent amount of logic resides in Helper classes, it&#8217;s
important to make sure those classes are covered by test cases.</p>
<p>First we create an example helper to test. The <code class="docutils literal"><span class="pre">CurrencyRendererHelper</span></code> will
help us display currencies in our views and for simplicity only has one method
<code class="docutils literal"><span class="pre">usd()</span></code>.</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// app/View/Helper/CurrencyRendererHelper.php</span>
<span class="k">class</span> <span class="nc">CurrencyRendererHelper</span> <span class="k">extends</span> <span class="nx">AppHelper</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">usd</span><span class="p">(</span><span class="nv">$amount</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s1">&#39;USD &#39;</span> <span class="o">.</span> <span class="nb">number_format</span><span class="p">(</span><span class="nv">$amount</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here we set the decimal places to 2, decimal separator to dot, thousands
separator to comma, and prefix the formatted number with &#8216;USD&#8217; string.</p>
<p>Now we create our tests:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="c1">// app/Test/Case/View/Helper/CurrencyRendererHelperTest.php</span>

<span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;Controller&#39;</span><span class="p">,</span> <span class="s1">&#39;Controller&#39;</span><span class="p">);</span>
<span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;View&#39;</span><span class="p">,</span> <span class="s1">&#39;View&#39;</span><span class="p">);</span>
<span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;CurrencyRendererHelper&#39;</span><span class="p">,</span> <span class="s1">&#39;View/Helper&#39;</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">CurrencyRendererHelperTest</span> <span class="k">extends</span> <span class="nx">CakeTestCase</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$CurrencyRenderer</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>

    <span class="c1">// Here we instantiate our helper</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setUp</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setUp</span><span class="p">();</span>
        <span class="nv">$Controller</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Controller</span><span class="p">();</span>
        <span class="nv">$View</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">View</span><span class="p">(</span><span class="nv">$Controller</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">CurrencyRenderer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CurrencyRendererHelper</span><span class="p">(</span><span class="nv">$View</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Testing the usd() function</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">testUsd</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertEquals</span><span class="p">(</span><span class="s1">&#39;USD 5.30&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">CurrencyRenderer</span><span class="o">-&gt;</span><span class="na">usd</span><span class="p">(</span><span class="mf">5.30</span><span class="p">));</span>

        <span class="c1">// We should always have 2 decimal digits</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertEquals</span><span class="p">(</span><span class="s1">&#39;USD 1.00&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">CurrencyRenderer</span><span class="o">-&gt;</span><span class="na">usd</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertEquals</span><span class="p">(</span><span class="s1">&#39;USD 2.05&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">CurrencyRenderer</span><span class="o">-&gt;</span><span class="na">usd</span><span class="p">(</span><span class="mf">2.05</span><span class="p">));</span>

        <span class="c1">// Testing the thousands separator</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertEquals</span><span class="p">(</span>
          <span class="s1">&#39;USD 12,000.70&#39;</span><span class="p">,</span>
          <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">CurrencyRenderer</span><span class="o">-&gt;</span><span class="na">usd</span><span class="p">(</span><span class="mf">12000.70</span><span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here, we call <code class="docutils literal"><span class="pre">usd()</span></code> with different parameters and tell the test suite to
check if the returned values are equal to what is expected.</p>
<p>Save this in and execute the test. You should see a green bar and messaging
indicating 1 pass and 4 assertions.</p>
</div>
<div class="section" id="creating-test-suites">
<h2>Creating Test Suites<a class="headerlink" href="#creating-test-suites" title="Permalink to this headline">¶</a></h2>
<p>If you want several of your tests to run at the same time, you can
create a test suite. A test suite is composed of several test cases.
<code class="docutils literal"><span class="pre">CakeTestSuite</span></code> offers a few methods for easily creating test suites based on
the file system. If we wanted to create a test suite for all our model tests we
would create <code class="docutils literal"><span class="pre">app/Test/Case/AllModelTest.php</span></code>. Put the following in it:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">AllModelTest</span> <span class="k">extends</span> <span class="nx">CakeTestSuite</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">suite</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$suite</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CakeTestSuite</span><span class="p">(</span><span class="s1">&#39;All model tests&#39;</span><span class="p">);</span>
        <span class="nv">$suite</span><span class="o">-&gt;</span><span class="na">addTestDirectory</span><span class="p">(</span><span class="nx">TESTS</span> <span class="o">.</span> <span class="s1">&#39;Case/Model&#39;</span><span class="p">);</span>
        <span class="k">return</span> <span class="nv">$suite</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The code above will group all test cases found in the
<code class="docutils literal"><span class="pre">/app/Test/Case/Model/</span></code> folder. To add an individual file, use
<code class="docutils literal"><span class="pre">$suite-&gt;addTestFile($filename);</span></code>. You can recursively add a directory
for all tests using:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nv">$suite</span><span class="o">-&gt;</span><span class="na">addTestDirectoryRecursive</span><span class="p">(</span><span class="nx">TESTS</span> <span class="o">.</span> <span class="s1">&#39;Case/Model&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Would recursively add all test cases in the <code class="docutils literal"><span class="pre">app/Test/Case/Model</span></code>
directory. You can use test suites to build a suite that runs all your
application&#8217;s tests:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">AllTestsTest</span> <span class="k">extends</span> <span class="nx">CakeTestSuite</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">suite</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$suite</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CakeTestSuite</span><span class="p">(</span><span class="s1">&#39;All tests&#39;</span><span class="p">);</span>
        <span class="nv">$suite</span><span class="o">-&gt;</span><span class="na">addTestDirectoryRecursive</span><span class="p">(</span><span class="nx">TESTS</span> <span class="o">.</span> <span class="s1">&#39;Case&#39;</span><span class="p">);</span>
        <span class="k">return</span> <span class="nv">$suite</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can then run this test on the command line using:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="err">$</span> <span class="nx">Console</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">test</span> <span class="nx">app</span> <span class="nx">AllTests</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-tests-for-plugins">
<h2>Creating Tests for Plugins<a class="headerlink" href="#creating-tests-for-plugins" title="Permalink to this headline">¶</a></h2>
<p>Tests for plugins are created in their own directory inside the
plugins folder.</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="o">/</span><span class="nx">app</span>
    <span class="o">/</span><span class="nx">Plugin</span>
        <span class="o">/</span><span class="nx">Blog</span>
            <span class="o">/</span><span class="nx">Test</span>
                <span class="o">/</span><span class="k">Case</span>
                <span class="o">/</span><span class="nx">Fixture</span>
</pre></div>
</div>
<p>They work just like normal tests but you have to remember to use
the naming conventions for plugins when importing classes. This is
an example of a testcase for the <code class="docutils literal"><span class="pre">BlogPost</span></code> model from the plugins
chapter of this manual. A difference from other tests is in the
first line where &#8216;Blog.BlogPost&#8217; is imported. You also need to
prefix your plugin fixtures with <code class="docutils literal"><span class="pre">plugin.blog.blog_post</span></code>:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">App</span><span class="o">::</span><span class="na">uses</span><span class="p">(</span><span class="s1">&#39;BlogPost&#39;</span><span class="p">,</span> <span class="s1">&#39;Blog.Model&#39;</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">BlogPostTest</span> <span class="k">extends</span> <span class="nx">CakeTestCase</span> <span class="p">{</span>

    <span class="c1">// Plugin fixtures located in /app/Plugin/Blog/Test/Fixture/</span>
    <span class="k">public</span> <span class="nv">$fixtures</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;plugin.blog.blog_post&#39;</span><span class="p">);</span>
    <span class="k">public</span> <span class="nv">$BlogPost</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">testSomething</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// ClassRegistry makes the model use the test database connection</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">BlogPost</span> <span class="o">=</span> <span class="nx">ClassRegistry</span><span class="o">::</span><span class="na">init</span><span class="p">(</span><span class="s1">&#39;Blog.BlogPost&#39;</span><span class="p">);</span>

        <span class="c1">// do some useful test here</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertTrue</span><span class="p">(</span><span class="nb">is_object</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">BlogPost</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If you want to use plugin fixtures in the app tests you can
reference them using <code class="docutils literal"><span class="pre">plugin.pluginName.fixtureName</span></code> syntax in the
<code class="docutils literal"><span class="pre">$fixtures</span></code> array.</p>
</div>
<div class="section" id="integration-with-jenkins">
<h2>Integration with Jenkins<a class="headerlink" href="#integration-with-jenkins" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://jenkins-ci.org">Jenkins</a> is a continuous integration server, that can
help you automate the running of your test cases. This helps ensure that all
your tests stay passing and your application is always ready.</p>
<p>Integrating a CakePHP application with Jenkins is fairly straightforward. The
following assumes you&#8217;ve already installed Jenkins on *nix system, and are able
to administer it. You also know how to create jobs, and run builds. If you are
unsure of any of these, refer to the <a class="reference external" href="http://jenkins-ci.org/">Jenkins documentation</a> .</p>
<div class="section" id="create-a-job">
<h3>Create a job<a class="headerlink" href="#create-a-job" title="Permalink to this headline">¶</a></h3>
<p>Start off by creating a job for your application, and connect your repository
so that jenkins can access your code.</p>
</div>
<div class="section" id="add-test-database-config">
<h3>Add test database config<a class="headerlink" href="#add-test-database-config" title="Permalink to this headline">¶</a></h3>
<p>Using a separate database just for Jenkins is generally a good idea, as it stops
bleed through and avoids a number of basic problems. Once you&#8217;ve created a new
database in a database server that jenkins can access (usually localhost). Add
a <em>shell script step</em> to the build that contains the following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">cat</span> <span class="o">&gt;</span> <span class="nx">app</span><span class="o">/</span><span class="nx">Config</span><span class="o">/</span><span class="nx">database</span><span class="o">.</span><span class="nx">php</span> <span class="o">&lt;&lt;</span><span class="s1">&#39;DATABASE_PHP&#39;</span>
<span class="o">&lt;?</span><span class="nx">php</span>
<span class="k">class</span> <span class="nc">DATABASE_CONFIG</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$test</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;datasource&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Database/Mysql&#39;</span><span class="p">,</span>
        <span class="s1">&#39;host&#39;</span>       <span class="o">=&gt;</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
        <span class="s1">&#39;database&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;jenkins_test&#39;</span><span class="p">,</span>
        <span class="s1">&#39;login&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;jenkins&#39;</span><span class="p">,</span>
        <span class="s1">&#39;password&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;cakephp_jenkins&#39;</span><span class="p">,</span>
        <span class="s1">&#39;encoding&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;utf8&#39;</span>
    <span class="p">);</span>
<span class="p">}</span>
<span class="nx">DATABASE_PHP</span>
</pre></div>
</div>
<p>This ensures that you&#8217;ll always have the correct database configuration that
Jenkins requires. Do the same for any other configuration files you need to.
It&#8217;s often a good idea to drop and re-create the database before each build as
well. This insulates you from chained failures, where one broken build causes
others to fail. Add another <em>shell script step</em> to the build that contains the
following:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">mysql</span> <span class="o">-</span><span class="nx">u</span> <span class="nx">jenkins</span> <span class="o">-</span><span class="nx">pcakephp_jenkins</span> <span class="o">-</span><span class="nx">e</span> <span class="s1">&#39;DROP DATABASE IF EXISTS jenkins_test; CREATE DATABASE jenkins_test&#39;</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="add-your-tests">
<h3>Add your tests<a class="headerlink" href="#add-your-tests" title="Permalink to this headline">¶</a></h3>
<p>Add another <em>shell script step</em> to your build. In this step run the tests for
your application. Creating a junit log file, or clover coverage is often a nice
bonus, as it gives you a nice graphical view of your testing results:</p>
<div class="highlight-phpinline"><div class="highlight"><pre><span></span><span class="nx">app</span><span class="o">/</span><span class="nx">Console</span><span class="o">/</span><span class="nx">cake</span> <span class="nx">test</span> <span class="nx">app</span> <span class="nx">AllTests</span> <span class="nx">\</span>
<span class="o">--</span><span class="nx">stderr</span> <span class="nx">\</span>
<span class="o">--</span><span class="nb">log</span><span class="o">-</span><span class="nx">junit</span> <span class="nx">junit</span><span class="o">.</span><span class="nx">xml</span> <span class="nx">\</span>
<span class="o">--</span><span class="nx">coverage</span><span class="o">-</span><span class="nx">clover</span> <span class="nx">clover</span><span class="o">.</span><span class="nx">xml</span>
</pre></div>
</div>
<p>If you use clover coverage, or the junit results, make sure to configure those
in Jenkins as well. Failing to configure those steps will mean you won&#8217;t see the
results.</p>
</div>
<div class="section" id="run-a-build">
<h3>Run a build<a class="headerlink" href="#run-a-build" title="Permalink to this headline">¶</a></h3>
<p>You should be able to run a build now. Check the console output and make any
necessary changes to get a passing build.</p>
</div>
</div>
</div>


			</div>
		</div>

		
		<div class="col-md-3 col-md-pull-9 pull-off hidden-xs hidden-sm" lang="en">
			<aside class="sidebar">
				<div class="mb30 row">
<div id="sidebar-navigation" class="hidden-xs">
	<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cakephp-overview.html">CakePHP Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers.html">Controllers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../views.html">Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-libraries.html">Core Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../console-and-shells.html">Shells, Tasks &amp; Console Tools</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../development.html">Development</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="routing.html">Routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="sessions.html">Sessions</a></li>
<li class="toctree-l2"><a class="reference internal" href="exceptions.html">Exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="errors.html">Error Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html">Debugging</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="rest.html">REST</a></li>
<li class="toctree-l2"><a class="reference internal" href="dispatch-filters.html">Dispatcher Filters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../deployment.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials-and-examples.html">Tutorials &amp; Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices.html">Appendices</a></li>
</ul>

</div>

				</div>
			</aside>
			<aside class="sidebar">
				<div class="mb30 row">
				</div>
			</aside>
		</div>
	</div>
</div>

<section id="socials" class="back-3">
	<div class="container-fluid">
		<div class="row">
			<div class="col-xs-12 col-sm-12 col-md-4  social text-center">
				<div class="col-sm-3 col-xs-3">
					<div id="fb-root"></div>
						<script>(function(d, s, id) {
						  var js, fjs = d.getElementsByTagName(s)[0];
						  if (d.getElementById(id)) return;
						  js = d.createElement(s); js.id = id;
						  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";
						  fjs.parentNode.insertBefore(js, fjs);
						}(document, 'script', 'facebook-jssdk'));
						</script>
						<div id="fb-root-face" class="fb-like" data-href="https://www.facebook.com/CakePHP/" data-layout="button_count" data-action="like" data-show-faces="true" data-share="false"></div>
				</div>

				<div class="col-sm-3 col-xs-3">
					<iframe src="https://ghbtns.com/github-btn.html?user=cakephp&amp;repo=cakephp&amp;type=star&amp;count=true&amp;size=small" frameborder="0" scrolling="0" width="120px" height="30px"></iframe>
				</div>

				<div class="col-sm-3 col-xs-3">
					<iframe src="https://ghbtns.com/github-btn.html?user=cakephp&amp;repo=cakephp&amp;type=fork&amp;count=true&amp;size=small" frameborder="0" scrolling="0" width="120px" height="30px"></iframe>
				</div>

				<div class="col-sm-3 col-xs-3">
					<a href="https://twitter.com/CakePHP" class="twitter-follow-button" data-show-count="false" data-show-screen-name="false">Follow @CakePHP</a>
					<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
				</div>
			</div>

			<div class="col-xs-12 col-sm-12 col-md-8 social-footer text-center ">
				<a href="#">发现翻译错误? 请在下面留言</a>
				<a href="https://github.com/blackpuppy/docs/wiki" target="_blank">我要加入翻译</a>
				<a href="https://twitter.com/cakephp" data-toggle="tooltip" title="Twitter"><i class="fa icon-social fa-twitter"></i>
				<a href="http://www.facebook.com/groups/cake.community" data-toggle="tooltip" title="Facebook"><i class="fa icon-social fa-facebook"></i></a>
				<a href="http://goo.gl/mSC0s" data-toggle="tooltip" title="Google Plus"><i class="fa icon-social  fa-google-plus"></i></a>
				<a href="http://www.youtube.com/user/CakePHP" data-toggle="tooltip" title="Youtube"><i class="fa icon-social fa-youtube-play"></i></a>
				<a href="https://github.com/cakephp" data-toggle="tooltip" title="Github"><i class="fa icon-social fa-git"></i></a>
				<a href="http://cakesf.herokuapp.com/" target="_blank" title="Slack" data-toggle="tooltip"><i class="fa fa-slack icon-social"></i></a>
				<a href="http://stackoverflow.com/tags/cakephp" data-toggle="tooltip" title="Stack Overflow"><i class="fa icon-social fa-stack-overflow"></i></a>
				<a href="http://webchat.freenode.net/?channels=cakephp" data-toggle="tooltip" title="IRC" class="icon-irc">#IRC</a>
			</div>
		</div>
	</div>
</section>

<footer id="footer" class="footer-wrapper">
	<div class="container">

		<div class="row col-p30">
			<div class="col-sm-12 col-md-3">
				<div class="footer-widget t-footer">
					<div class="col-md-12">
						<a href="https://www.openhub.net/p/cakephp">
							<img src="../_static/open-hub.png">
						</a>
						<div class="mt10">
							<a href="https://www.rackspace.com/">
								<img src="../_static/rackspace.png">
							</a>
						</div>
					</div>
				</div>
			</div>

			<div class="col-sm-12 col-md-9">
				<div class="col-md-3 col-sm-6 business-solution">
					<ul class="footer-menu">
						<li class="menu-title">
	<a href="http://cakephp.org/business-solutions"><i class="fa fa-menu-title fa-briefcase"></i>Business Solutions</a>
</li>
<li class="menu-title mt30">
	<a href="http://cakephp.org/showcase"><i class="fa fa-menu-title fa-desktop"></i>Showcase</a>
</li>
					</ul>
				</div>

				<div class="col-md-3 col-sm-6">
					<ul class="footer-menu">
						
<li class="menu-title">
	<i class="fa fa-menu-title fa-book"></i>Documentation
</li>

<li><a href="http://book.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>CookBook</a></li>
<li><a href="http://api.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>API</a></li>

<li><a href="http://cakephp.org/documentation/videos"><i class="fa fa-menu fa-chevron-right"></i>Videos</a></li>
<li><a href="http://cakephp.org/privacy"><i class="fa fa-menu fa-chevron-right"></i>Privacy Policy</a></li>
<li><a href="http://cakephp.org/pages/trademark"><i class="fa fa-menu fa-chevron-right"></i>Logos &amp; Trademarks</a></li>
					</ul>
				</div>

				<div class="col-md-3 col-sm-6">
					<ul class="footer-menu">
						
<li class="menu-title"><i class="fa fa-menu-title fa-users"></i>Community</li>

<li><a href="http://cakephp.org/team"><i class="fa fa-menu fa-chevron-right"></i>Team</a></li>
<li><a href="https://github.com/cakephp/cakephp/issues"><i class="fa fa-menu fa-chevron-right"></i>Issues (Github)</a></li>
<li><a href="http://www.youtube.com/user/CakePHP"><i class="fa fa-menu fa-chevron-right"></i>YouTube Channel</a></li>
<li><a href="http://cakephp.org/get-involved"><i class="fa fa-menu fa-chevron-right"></i>Get Involved</a></li>

<li><a href="http://bakery.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Bakery</a></li>
<li><a href="http://cakephp.org/newsletter/signup"><i class="fa fa-menu fa-chevron-right"></i>Newsletter</a></li>
<li><a href="http://certification.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Certification</a></li>
<li><a href="http://my.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>My CakePHP</a></li>
<li><a href="http://cakefest.org"><i class="fa fa-menu fa-chevron-right"></i>CakeFest</a></li>
<li><a href="http://www.facebook.com/groups/cake.community"><i class="fa fa-menu fa-chevron-right"></i>Facebook</a></li>
<li><a href="http://twitter.com/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Twitter</a></li>
					</ul>
				</div>

				<div class="col-md-3 col-sm-6">
					<ul class="footer-menu">
						
<li class="menu-title"><i class="fa fa-menu-title fa-comments-o"></i>Help &amp; Support</li>

<li><a href="http://discourse.cakephp.org"><i class="fa fa-menu fa-chevron-right"></i>Forum</a></li>
<li><a href="http://stackoverflow.com/tags/cakephp"><i class="fa fa-menu fa-chevron-right"></i>Stack Overflow</a></li>
<li><a href="http://webchat.freenode.net/?channels=cakephp"><i class="fa fa-menu fa-chevron-right"></i>IRC</a></li>
<li><a href="http://cakesf.herokuapp.com/"><i class="fa fa-menu fa-chevron-right"></i>Slack</a></li>
<li><a href="http://cakedc.com"><i class="fa fa-menu fa-chevron-right"></i>Paid Support</a></li>
					</ul>
				</div>
			</div>
		</div>

		<div class="row">
			<div class="col-md-12 text-center mt30">
				<p class="copyright">
							&copy; Copyright 2016, Cake Software Foundation, Inc.
						Last updated on Aug 09, 2016.
						Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.5.
				</p>
			</div>
		</div>
	</div>
</footer>

<div id="inline-search-results"></div>


</div>

<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-743287-3']);
	_gaq.push(['_trackPageview']);
	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>

<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F201cbc61deaf9f7ffb521fb23e83db40' type='text/javascript'%3E%3C/script%3E"));
</script>

<!-- Duoshuo Comment BEGIN -->
	<div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"cakephpchina"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0]
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- Duoshuo Comment END -->
  </body>
</html>